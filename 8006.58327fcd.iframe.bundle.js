"use strict";(self.webpackChunk_midspace_frontend=self.webpackChunk_midspace_frontend||[]).push([[8006],{"./src/aspects/Conference/Manage/Schedule/ManageSchedule.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>ManageSchedule});__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.slice.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.is-array.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.description.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.from.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.assign.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.map.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.date.to-iso-string.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.date.to-string.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.sort.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.function.name.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.filter.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.some.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.keys.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.date.now.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.find.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.includes.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.includes.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.values.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.find-index.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.flat-map.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.unscopables.flat-map.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.pad-start.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.regexp.to-string.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/web.url.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.iterator.js");var _templateObject,chakra_ui_icons_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+icons@1.1.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/icons/dist/chakra-ui-icons.esm.js"),chakra_ui_hooks_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+hooks@1.8.2_react@17.0.2/node_modules/@chakra-ui/hooks/dist/chakra-ui-hooks.esm.js"),chakra_ui_form_control_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+form-control@1.5.6_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/form-control/dist/chakra-ui-form-control.esm.js"),chakra_ui_button_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+button@1.5.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/button/dist/chakra-ui-button.esm.js"),chakra_ui_layout_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+layout@1.7.4_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/layout/dist/chakra-ui-layout.esm.js"),chakra_ui_tooltip_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+tooltip@1.4.6_3467197ee0b52af28e4f3b42a3c78b88/node_modules/@chakra-ui/tooltip/dist/chakra-ui-tooltip.esm.js"),chakra_ui_select_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+select@1.2.6_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/select/dist/chakra-ui-select.esm.js"),chakra_ui_input_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+input@1.4.1_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/input/dist/chakra-ui-input.esm.js"),chakra_ui_checkbox_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+checkbox@1.6.5_381b254eb05ba0b21fa13fc526cde82c/node_modules/@chakra-ui/checkbox/dist/chakra-ui-checkbox.esm.js"),chakra_ui_color_mode_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+color-mode@1.4.3_react@17.0.2/node_modules/@chakra-ui/color-mode/dist/chakra-ui-color-mode.esm.js"),chakra_ui_menu_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+menu@1.8.6_381b254eb05ba0b21fa13fc526cde82c/node_modules/@chakra-ui/menu/dist/chakra-ui-menu.esm.js"),chakra_ui_visually_hidden_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+visually-hidden@1.1.4_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/visually-hidden/dist/chakra-ui-visually-hidden.esm.js"),chakra_ui_alert_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+alert@1.3.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/alert/dist/chakra-ui-alert.esm.js"),chakra_ui_modal_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+modal@1.10.7_d24435ba52f1f88b08cc54a1f1d4e56f/node_modules/@chakra-ui/modal/dist/chakra-ui-modal.esm.js"),chakra_ui_accordion_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+accordion@1.4.6_381b254eb05ba0b21fa13fc526cde82c/node_modules/@chakra-ui/accordion/dist/chakra-ui-accordion.esm.js"),auth=__webpack_require__("../packages/shared/shared-types/build/esm/auth.js"),urql_core=__webpack_require__("../node_modules/.pnpm/@urql+core@2.4.1_graphql@15.7.2/node_modules/@urql/core/dist/urql-core.mjs"),luxon=__webpack_require__("../node_modules/.pnpm/luxon@2.3.0/node_modules/luxon/build/cjs-browser/luxon.js"),papaparse_min=__webpack_require__("../node_modules/.pnpm/papaparse@5.3.1/node_modules/papaparse/papaparse.min.js"),papaparse_min_default=__webpack_require__.n(papaparse_min),react=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),v4=__webpack_require__("../node_modules/.pnpm/uuid@8.3.2/node_modules/uuid/dist/esm-browser/v4.js"),graphql=__webpack_require__("./src/generated/graphql.tsx"),App=__webpack_require__("./src/aspects/App/index.ts"),DateTimePicker=__webpack_require__("./src/aspects/Chakra/DateTimePicker.tsx"),FAIcon=__webpack_require__("./src/aspects/Chakra/FAIcon.tsx"),LinkButton=__webpack_require__("./src/aspects/Chakra/LinkButton.tsx"),CRUDComponents=__webpack_require__("./src/aspects/CRUDTable2/CRUDComponents.tsx"),CRUDTable2=__webpack_require__("./src/aspects/CRUDTable2/CRUDTable2.tsx"),AuthParameters=__webpack_require__("./src/aspects/GQL/AuthParameters.tsx"),ExtractActualError=__webpack_require__("./src/aspects/GQL/ExtractActualError.ts"),make_context=__webpack_require__("./src/aspects/GQL/make-context.ts"),useRealTime=__webpack_require__("./src/aspects/Hooks/useRealTime.tsx"),useConference=__webpack_require__("./src/aspects/Conference/useConference.tsx"),DashboardPage=__webpack_require__("./src/aspects/Conference/Manage/DashboardPage.tsx"),chakra_ui_toast_esm=(__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.promise.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.map.js"),__webpack_require__("../node_modules/.pnpm/@chakra-ui+toast@1.5.4_3467197ee0b52af28e4f3b42a3c78b88/node_modules/@chakra-ui/toast/dist/chakra-ui-toast.esm.js")),esm=__webpack_require__("../packages/shared/assert/build/esm/index.js"),es=__webpack_require__("../node_modules/.pnpm/ramda@0.28.0/node_modules/ramda/es/index.js"),urql_es=__webpack_require__("../node_modules/.pnpm/urql@2.1.3_graphql@15.7.2+react@17.0.2/node_modules/urql/dist/urql.es.js"),maybeCompare=__webpack_require__("./src/aspects/Utils/maybeCompare.tsx"),RequireRole=__webpack_require__("./src/aspects/Conference/RequireRole.tsx"),jsx_runtime=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ItemProgramPersonRoleToEventProgramPersonRole(role){switch(role.toLowerCase()){case"chair":case"session chair":case"session organizer":case"organizer":return graphql.hQl.Chair;default:return graphql.hQl.Presenter}}function AddEventPeople_FromContentPanel(_ref){var events=_ref.events,onClose=_ref.onClose,subconferenceId=(0,AuthParameters.h)().subconferenceId,client=(0,urql_es.m8)(),insert=(0,graphql.aoC)(),toast=(0,chakra_ui_toast_esm.pm)(),_useState2=_slicedToArray((0,react.useState)(!1),2),copying=_useState2[0],setCopying=_useState2[1],_useState4=_slicedToArray((0,react.useState)(null),2),error=_useState4[0],setError=_useState4[1],copy=(0,react.useCallback)(function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee(includeContent,includeExhibitions){var _headers,eventsWithContent,itemIds,eventsWithExhibition,exhibitionIds,itemPeopleQ,itemPeople,itemExhibitions,itemPeopleByItem,exhibitionsMap,_iterator,_step,itemExhibition,existing,newEventPeople,_iterator2,_step2,event,existingEventPeople,itemPeopleItm,_loop,_iterator3,_step3,itemPerson,_iterator4,_step4,_event,_existingEventPeople,itemPeopleExh,_loop2,_iterator5,_step5,_itemPerson;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return setCopying(!0),setError(null),_context.prev=2,eventsWithContent=includeContent?events.filter((function(x){return!!x.itemId})):[],itemIds=eventsWithContent.map((function(x){return x.itemId})),eventsWithExhibition=includeExhibitions?events.filter((function(x){return!!x.exhibitionId})):[],exhibitionIds=eventsWithExhibition.map((function(x){return x.exhibitionId})),_context.next=9,client.query(graphql.Hl7,{itemIds,exhibitionIds},{fetchOptions:{headers:(_headers={},_headers[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers)}}).toPromise();case 9:if((itemPeopleQ=_context.sent).data){_context.next=12;break}throw new Error("No data available.");case 12:itemPeople=itemPeopleQ.data.content_ItemProgramPerson,itemExhibitions=itemPeopleQ.data.content_ItemExhibition,itemPeopleByItem=new Map(itemIds.map((function(itemId){return[itemId,itemPeople.filter((function(x){return x.itemId===itemId}))]}))),exhibitionsMap=new Map,_iterator=_createForOfIteratorHelper(itemExhibitions);try{for(_iterator.s();!(_step=_iterator.n()).done;)itemExhibition=_step.value,(existing=exhibitionsMap.get(itemExhibition.exhibitionId))?existing.push.apply(existing,_toConsumableArray(itemExhibition.item.itemPeople)):exhibitionsMap.set(itemExhibition.exhibitionId,_toConsumableArray(itemExhibition.item.itemPeople))}catch(err){_iterator.e(err)}finally{_iterator.f()}if(newEventPeople=[],includeContent){_iterator2=_createForOfIteratorHelper(eventsWithContent);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;)if(event=_step2.value,existingEventPeople=event.eventPeople,itemPeopleItm=itemPeopleByItem.get(event.itemId)){_loop=function _loop(itemPerson){var itemPersonEventRole=ItemProgramPersonRoleToEventProgramPersonRole(itemPerson.roleName);existingEventPeople.some((function(person){return person.personId===itemPerson.personId&&person.roleName===itemPersonEventRole}))||newEventPeople.push({eventId:event.id,personId:itemPerson.personId,roleName:itemPersonEventRole})},_iterator3=_createForOfIteratorHelper(itemPeopleItm);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;)itemPerson=_step3.value,_loop(itemPerson)}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}if(includeExhibitions){_iterator4=_createForOfIteratorHelper(eventsWithExhibition);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;)if(_event=_step4.value,_existingEventPeople=_event.eventPeople,itemPeopleExh=exhibitionsMap.get(_event.exhibitionId)){_loop2=function _loop2(_itemPerson){var itemPersonEventRole=ItemProgramPersonRoleToEventProgramPersonRole(_itemPerson.roleName);_existingEventPeople.some((function(person){return person.personId===_itemPerson.personId&&person.roleName===itemPersonEventRole}))||newEventPeople.push({eventId:_event.id,personId:_itemPerson.personId,roleName:itemPersonEventRole})},_iterator5=_createForOfIteratorHelper(itemPeopleExh);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;)_itemPerson=_step5.value,_loop2(_itemPerson)}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}if(!(newEventPeople.length>0)){_context.next=24;break}return _context.next=24,insertEventPeople(newEventPeople,insert,subconferenceId);case 24:setCopying(!1),onClose(),toast({title:newEventPeople.length+" new people copied",status:"success",duration:3e3,isClosable:!0,position:"bottom"}),_context.next=33;break;case 29:_context.prev=29,_context.t0=_context.catch(2),setError(_context.t0.message||_context.t0.toString()),setCopying(!1);case 33:case"end":return _context.stop()}}),_callee,null,[[2,29]])})));return function(_x,_x2){return _ref2.apply(this,arguments)}}(),[events,client,subconferenceId,onClose,toast,insert]);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)(chakra_ui_accordion_esm.KF,{children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{flex:"1",textAlign:"left",children:"Copy from associated content or exhibitions"}),(0,jsx_runtime.jsx)(chakra_ui_accordion_esm.XE,{})]}),(0,jsx_runtime.jsxs)(chakra_ui_accordion_esm.Hk,{children:[error?(0,jsx_runtime.jsxs)(chakra_ui_alert_esm.bZ,{status:"error",variant:"subtle",mb:4,justifyContent:"flex-start",alignItems:"flex-start",children:[(0,jsx_runtime.jsx)(chakra_ui_alert_esm.zM,{}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{justifyContent:"flex-start",alignItems:"flex-start",children:[(0,jsx_runtime.jsx)(chakra_ui_alert_esm.Cd,{children:"Error copying people to events"}),(0,jsx_runtime.jsx)(chakra_ui_alert_esm.X,{children:error})]})]}):void 0,(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"purple",onClick:function onClick(){return copy(!0,!1)},isLoading:copying,mb:2,children:"Copy from associated content only"}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"purple",onClick:function onClick(){return copy(!1,!0)},isLoading:copying,mb:2,children:"Copy from associated exhibitions only"}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"purple",onClick:function onClick(){return copy(!0,!0)},isLoading:copying,children:"Copy from associated content and exhibitions"})]})]})}function AddEventPeople_SingleProgramPersonPanel(_ref3){var _selectProgramPeopleQ,events=_ref3.events,isExpanded=_ref3.isExpanded,onClose=_ref3.onClose,conference=(0,useConference.fk)(),subconferenceId=(0,AuthParameters.h)().subconferenceId,_useState6=_slicedToArray((0,react.useState)(!1),2),hasBeenExpanded=_useState6[0],setHasBeenExpanded=_useState6[1];(0,react.useEffect)((function(){isExpanded&&setHasBeenExpanded(!0)}),[isExpanded]);var context=(0,react.useMemo)((function(){var _makeContext;return(0,make_context.f)(((_makeContext={})[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext))}),[subconferenceId]),selectProgramPeopleQuery=_slicedToArray((0,graphql.kK8)({pause:!hasBeenExpanded,variables:{conferenceId:conference.id,subconferenceCond:subconferenceId?{_eq:subconferenceId}:{_is_null:!0}},context}),1)[0],peopleOptions=(0,react.useMemo)((function(){return selectProgramPeopleQuery.data?_toConsumableArray(selectProgramPeopleQuery.data.collection_ProgramPerson).sort((function(x,y){return(0,maybeCompare.D)(x.name,y.name,(function(a,b){return a.localeCompare(b)}))})).map((function(x){return(0,jsx_runtime.jsxs)("option",{value:x.id,children:[x.name,x.affiliation?" ("+x.affiliation+")":"",x.email?" <"+x.email+">":""]},x.id)})):[]}),[selectProgramPeopleQuery.data]),roleOptions=(0,react.useMemo)((function(){return Object.keys(graphql.hQl).filter((function(x){return"Participant"!==x})).sort((function(x,y){return x.localeCompare(y)})).map((function(x){var v=graphql.hQl[x];return(0,jsx_runtime.jsx)("option",{value:v,children:(0,CRUDComponents.oL)(v)},v)}))}),[]),_useState8=_slicedToArray((0,react.useState)(""),2),selectedPersonId=_useState8[0],setSelectedPersonId=_useState8[1],_useState10=_slicedToArray((0,react.useState)(graphql.hQl.Presenter),2),selectedRole=_useState10[0],setSelectedRole=_useState10[1],insert=(0,graphql.aoC)(),toast=(0,chakra_ui_toast_esm.pm)(),_useState12=_slicedToArray((0,react.useState)(!1),2),adding=_useState12[0],setAdding=_useState12[1],_useState14=_slicedToArray((0,react.useState)(null),2),error=_useState14[0],setError=_useState14[1],add=(0,react.useCallback)(_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return setAdding(!0),setError(null),_context3.prev=2,_context3.delegateYield(regeneratorRuntime.mark((function _callee2(){var selectedPerson,newEventPeople,_iterator6,_step6,_event2;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:esm.h.truthy(selectProgramPeopleQuery.data),selectedPerson=selectProgramPeopleQuery.data.collection_ProgramPerson.find((function(x){return x.id===selectedPersonId})),esm.h.truthy(selectedPerson),newEventPeople=[],_iterator6=_createForOfIteratorHelper(events);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;)_event2=_step6.value,_event2.eventPeople.some((function(person){return person.personId===selectedPerson.id&&person.roleName===selectedRole}))||newEventPeople.push({eventId:_event2.id,personId:selectedPerson.id,roleName:selectedRole})}catch(err){_iterator6.e(err)}finally{_iterator6.f()}return _context2.next=8,insertEventPeople(newEventPeople,insert,subconferenceId);case 8:setAdding(!1),onClose(),toast({title:"Person added to "+newEventPeople.length+" event(s)",status:"success",duration:3e3,isClosable:!0,position:"bottom"});case 11:case"end":return _context2.stop()}}),_callee2)}))(),"t0",4);case 4:_context3.next=10;break;case 6:_context3.prev=6,_context3.t1=_context3.catch(2),setError(_context3.t1.message||_context3.t1.toString()),setAdding(!1);case 10:case"end":return _context3.stop()}}),_callee3,null,[[2,6]])}))),[events,insert,onClose,selectProgramPeopleQuery.data,selectedPersonId,selectedRole,subconferenceId,toast]);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)(chakra_ui_accordion_esm.KF,{children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{flex:"1",textAlign:"left",children:"Add a program person"}),(0,jsx_runtime.jsx)(chakra_ui_accordion_esm.XE,{})]}),(0,jsx_runtime.jsxs)(chakra_ui_accordion_esm.Hk,{children:[error||selectProgramPeopleQuery.error?(0,jsx_runtime.jsxs)(chakra_ui_alert_esm.bZ,{status:"error",variant:"subtle",mb:4,justifyContent:"flex-start",alignItems:"flex-start",children:[(0,jsx_runtime.jsx)(chakra_ui_alert_esm.zM,{}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{justifyContent:"flex-start",alignItems:"flex-start",children:[(0,jsx_runtime.jsx)(chakra_ui_alert_esm.Cd,{children:error?"Error adding person to events":"Error loading list of people"}),(0,jsx_runtime.jsx)(chakra_ui_alert_esm.X,{children:null!=error?error:null===(_selectProgramPeopleQ=selectProgramPeopleQuery.error)||void 0===_selectProgramPeopleQ?void 0:_selectProgramPeopleQ.message})]})]}):void 0,(0,jsx_runtime.jsxs)(chakra_ui_select_esm.Ph,{"aria-label":"Person to add",value:selectedPersonId,onChange:function onChange(ev){return setSelectedPersonId(ev.target.value)},mb:4,children:[(0,jsx_runtime.jsx)("option",{value:"",children:"Select a program person"}),peopleOptions]}),(0,jsx_runtime.jsx)(chakra_ui_select_esm.Ph,{"aria-label":"Role of person",value:selectedRole,onChange:function onChange(ev){return setSelectedRole(ev.target.value)},mb:4,children:roleOptions}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"purple",isDisabled:""===selectedPersonId,isLoading:adding,onClick:add,children:"Add"})]})]})}function AddEventPeople_FromGroupPanel(_ref5){var _selectGroupsQuery$er,events=_ref5.events,isExpanded=_ref5.isExpanded,onClose=_ref5.onClose,conference=(0,useConference.fk)(),subconferenceId=(0,AuthParameters.h)().subconferenceId,_useState16=_slicedToArray((0,react.useState)(!1),2),hasBeenExpanded=_useState16[0],setHasBeenExpanded=_useState16[1];(0,react.useEffect)((function(){isExpanded&&setHasBeenExpanded(!0)}),[isExpanded]);var context=(0,react.useMemo)((function(){var _makeContext2;return(0,make_context.f)(((_makeContext2={})[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext2))}),[subconferenceId]),selectRegistrantsQuery=_slicedToArray((0,graphql.V6e)({pause:!hasBeenExpanded,variables:{conferenceId:conference.id},context}),1)[0],selectGroupsQuery=_slicedToArray((0,graphql.gqO)({pause:!hasBeenExpanded,variables:{conferenceId:conference.id,subconferenceCond:subconferenceId?{_eq:subconferenceId}:{_is_null:!0}},context}),1)[0],registrantOptions=(0,react.useMemo)((function(){return selectGroupsQuery.data?_toConsumableArray(selectGroupsQuery.data.registrant_Group).sort((function(x,y){return x.name.localeCompare(y.name)})).map((function(x){return(0,jsx_runtime.jsx)("option",{value:x.id,children:x.name},x.id)})):[]}),[selectGroupsQuery.data]),roleOptions=(0,react.useMemo)((function(){return Object.keys(graphql.hQl).filter((function(x){return"Participant"!==x})).sort((function(x,y){return x.localeCompare(y)})).map((function(x){var v=graphql.hQl[x];return(0,jsx_runtime.jsx)("option",{value:v,children:(0,CRUDComponents.oL)(v)},v)}))}),[]),_useState18=_slicedToArray((0,react.useState)(""),2),selectedGroupId=_useState18[0],setSelectedGroupId=_useState18[1],_useState20=_slicedToArray((0,react.useState)(graphql.hQl.Presenter),2),selectedRole=_useState20[0],setSelectedRole=_useState20[1],insertProgramPeople=(0,graphql.yo2)(),insertEventPeopleQ=(0,graphql.aoC)(),toast=(0,chakra_ui_toast_esm.pm)(),_useState22=_slicedToArray((0,react.useState)(!1),2),adding=_useState22[0],setAdding=_useState22[1],_useState24=_slicedToArray((0,react.useState)(null),2),error=_useState24[0],setError=_useState24[1],client=(0,urql_es.m8)(),add=(0,react.useCallback)(_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){var _headers2,registrants;return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return setAdding(!0),setError(null),_context4.prev=2,_context4.next=5,client.query(graphql.hW3,{groupId:selectedGroupId},{fetchOptions:{headers:(_headers2={},_headers2[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers2)}}).toPromise();case 5:return registrants=_context4.sent,esm.h.truthy(registrants.data,"API returned no data"),_context4.next=9,addRegistrantsToEvent(registrants.data.registrant_Registrant.map((function(x){return x.id})),selectRegistrantsQuery,(function(registrantIds){var _headers3;return client.query(graphql.xB4,{registrantIds},{fetchOptions:{headers:(_headers3={},_headers3[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers3)}}).toPromise()}),insertProgramPeople,conference.id,subconferenceId,events,selectedRole,insertEventPeopleQ);case 9:setAdding(!1),onClose(),toast({title:"Registration group added to events",status:"success",duration:3e3,isClosable:!0,position:"bottom"}),_context4.next=18;break;case 14:_context4.prev=14,_context4.t0=_context4.catch(2),setError(_context4.t0.message||_context4.t0.toString()),setAdding(!1);case 18:case"end":return _context4.stop()}}),_callee4,null,[[2,14]])}))),[client,selectedGroupId,selectRegistrantsQuery,insertProgramPeople,conference.id,subconferenceId,events,selectedRole,insertEventPeopleQ,onClose,toast]);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)(chakra_ui_accordion_esm.KF,{children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{flex:"1",textAlign:"left",children:"Copy from a registration group"}),(0,jsx_runtime.jsx)(chakra_ui_accordion_esm.XE,{})]}),(0,jsx_runtime.jsxs)(chakra_ui_accordion_esm.Hk,{children:[error||selectGroupsQuery.error?(0,jsx_runtime.jsxs)(chakra_ui_alert_esm.bZ,{status:"error",variant:"subtle",mb:4,justifyContent:"flex-start",alignItems:"flex-start",children:[(0,jsx_runtime.jsx)(chakra_ui_alert_esm.zM,{}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{justifyContent:"flex-start",alignItems:"flex-start",children:[(0,jsx_runtime.jsx)(chakra_ui_alert_esm.Cd,{children:error?"Error adding registration group to events":"Error loading list of groups"}),(0,jsx_runtime.jsx)(chakra_ui_alert_esm.X,{children:null!=error?error:null===(_selectGroupsQuery$er=selectGroupsQuery.error)||void 0===_selectGroupsQuery$er?void 0:_selectGroupsQuery$er.message})]})]}):void 0,(0,jsx_runtime.jsxs)(chakra_ui_select_esm.Ph,{"aria-label":"Registration group to add",value:selectedGroupId,onChange:function onChange(ev){return setSelectedGroupId(ev.target.value)},mb:4,children:[(0,jsx_runtime.jsx)("option",{value:"",children:"Select a registration group"}),registrantOptions]}),(0,jsx_runtime.jsx)(chakra_ui_select_esm.Ph,{"aria-label":"Role of registrant",value:selectedRole,onChange:function onChange(ev){return setSelectedRole(ev.target.value)},mb:4,children:roleOptions}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"purple",isDisabled:""===selectedGroupId,isLoading:adding,onClick:add,children:"Add"})]})]})}function AddEventPeople_SingleRegistrantPanel(_ref7){var _selectRegistrantsQue,events=_ref7.events,isExpanded=_ref7.isExpanded,onClose=_ref7.onClose,conference=(0,useConference.fk)(),subconferenceId=(0,AuthParameters.h)().subconferenceId,_useState26=_slicedToArray((0,react.useState)(!1),2),hasBeenExpanded=_useState26[0],setHasBeenExpanded=_useState26[1];(0,react.useEffect)((function(){isExpanded&&setHasBeenExpanded(!0)}),[isExpanded]);var context=(0,react.useMemo)((function(){var _makeContext3;return(0,make_context.f)(((_makeContext3={})[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext3))}),[subconferenceId]),selectRegistrantsQuery=_slicedToArray((0,graphql.V6e)({pause:!hasBeenExpanded,variables:{conferenceId:conference.id},context}),1)[0],registrantOptions=(0,react.useMemo)((function(){return selectRegistrantsQuery.data?_toConsumableArray(selectRegistrantsQuery.data.registrant_Registrant).sort((function(x,y){return x.displayName.localeCompare(y.displayName)})).map((function(x){var _x$profile,_x$invitation;return(0,jsx_runtime.jsxs)("option",{value:x.id,children:[x.displayName,null!==(_x$profile=x.profile)&&void 0!==_x$profile&&_x$profile.affiliation?" ("+x.profile.affiliation+")":"",null!==(_x$invitation=x.invitation)&&void 0!==_x$invitation&&_x$invitation.invitedEmailAddress?" <"+x.invitation.invitedEmailAddress+">":""]},x.id)})):[]}),[selectRegistrantsQuery.data]),roleOptions=(0,react.useMemo)((function(){return Object.keys(graphql.hQl).filter((function(x){return"Participant"!==x})).sort((function(x,y){return x.localeCompare(y)})).map((function(x){var v=graphql.hQl[x];return(0,jsx_runtime.jsx)("option",{value:v,children:(0,CRUDComponents.oL)(v)},v)}))}),[]),_useState28=_slicedToArray((0,react.useState)(""),2),selectedRegistrantId=_useState28[0],setSelectedRegistrantId=_useState28[1],_useState30=_slicedToArray((0,react.useState)(graphql.hQl.Presenter),2),selectedRole=_useState30[0],setSelectedRole=_useState30[1],insertProgramPeople=(0,graphql.yo2)(),insertEventPeopleQ=(0,graphql.aoC)(),toast=(0,chakra_ui_toast_esm.pm)(),_useState32=_slicedToArray((0,react.useState)(!1),2),adding=_useState32[0],setAdding=_useState32[1],_useState34=_slicedToArray((0,react.useState)(null),2),error=_useState34[0],setError=_useState34[1],client=(0,urql_es.m8)(),add=(0,react.useCallback)(_asyncToGenerator(regeneratorRuntime.mark((function _callee5(){var _newEventPeople;return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return setAdding(!0),setError(null),_context5.prev=2,_context5.next=5,addRegistrantsToEvent([selectedRegistrantId],selectRegistrantsQuery,(function(registrantIds){var _headers4;return client.query(graphql.xB4,{registrantIds},{fetchOptions:{headers:(_headers4={},_headers4[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers4)}}).toPromise()}),insertProgramPeople,conference.id,subconferenceId,events,selectedRole,insertEventPeopleQ);case 5:_newEventPeople=_context5.sent,setAdding(!1),onClose(),toast({title:"Registrant added to "+_newEventPeople.length+" event(s)",status:"success",duration:3e3,isClosable:!0,position:"bottom"}),_context5.next=15;break;case 11:_context5.prev=11,_context5.t0=_context5.catch(2),setError(_context5.t0.message||_context5.t0.toString()),setAdding(!1);case 15:case"end":return _context5.stop()}}),_callee5,null,[[2,11]])}))),[selectedRegistrantId,selectRegistrantsQuery,insertProgramPeople,conference.id,subconferenceId,events,selectedRole,insertEventPeopleQ,onClose,toast,client]);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)(chakra_ui_accordion_esm.KF,{children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{flex:"1",textAlign:"left",children:"Add a registrant"}),(0,jsx_runtime.jsx)(chakra_ui_accordion_esm.XE,{})]}),(0,jsx_runtime.jsxs)(chakra_ui_accordion_esm.Hk,{children:[error||selectRegistrantsQuery.error?(0,jsx_runtime.jsxs)(chakra_ui_alert_esm.bZ,{status:"error",variant:"subtle",mb:4,justifyContent:"flex-start",alignItems:"flex-start",children:[(0,jsx_runtime.jsx)(chakra_ui_alert_esm.zM,{}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{justifyContent:"flex-start",alignItems:"flex-start",children:[(0,jsx_runtime.jsx)(chakra_ui_alert_esm.Cd,{children:error?"Error adding registrant to events":"Error loading list of registrants"}),(0,jsx_runtime.jsx)(chakra_ui_alert_esm.X,{children:null!=error?error:null===(_selectRegistrantsQue=selectRegistrantsQuery.error)||void 0===_selectRegistrantsQue?void 0:_selectRegistrantsQue.message})]})]}):void 0,(0,jsx_runtime.jsxs)(chakra_ui_select_esm.Ph,{"aria-label":"Registrant to add",value:selectedRegistrantId,onChange:function onChange(ev){return setSelectedRegistrantId(ev.target.value)},mb:4,children:[(0,jsx_runtime.jsx)("option",{value:"",children:"Select a registrant"}),registrantOptions]}),(0,jsx_runtime.jsx)(chakra_ui_select_esm.Ph,{"aria-label":"Role of registrant",value:selectedRole,onChange:function onChange(ev){return setSelectedRole(ev.target.value)},mb:4,children:roleOptions}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"purple",isDisabled:""===selectedRegistrantId,isLoading:adding,onClick:add,children:"Add"})]})]})}function insertEventPeople(_x3,_x4,_x5){return _insertEventPeople.apply(this,arguments)}function _insertEventPeople(){return(_insertEventPeople=_asyncToGenerator(regeneratorRuntime.mark((function _callee6(newEventPeople,insert,subconferenceId){var _headers5;return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,insert[1]({objects:newEventPeople},{fetchOptions:{headers:(_headers5={},_headers5[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers5)}});case 2:case"end":return _context6.stop()}}),_callee6)})))).apply(this,arguments)}function addRegistrantsToEvent(_x6,_x7,_x8,_x9,_x10,_x11,_x12,_x13,_x14){return _addRegistrantsToEvent.apply(this,arguments)}function _addRegistrantsToEvent(){return(_addRegistrantsToEvent=_asyncToGenerator(regeneratorRuntime.mark((function _callee7(registrantIds,selectRegistrantsQuery,selectProgramPeople_ByRegistrantQuery,insertProgramPeople,conferenceId,subconferenceId,events,selectedRole,insertEventPeopleQ){var programPeople,personIds,insertProgramPersons,_loop3,_iterator7,_step7,registrantId,_headers6,_newPeople$data,_newPeople$data$inser,newPeople,newEventPeople,_iterator8,_step8,_event3,_existingEventPeople3,_loop4,_iterator9,_step9,personId;return regeneratorRuntime.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,selectProgramPeople_ByRegistrantQuery(registrantIds);case 2:programPeople=_context7.sent,personIds=[],insertProgramPersons=[],_loop3=function _loop3(registrantId){var _programPeople$data,_programPeople$data$c,personId=null===(_programPeople$data=programPeople.data)||void 0===_programPeople$data||null===(_programPeople$data$c=_programPeople$data.collection_ProgramPerson.find((function(x){return x.registrantId===registrantId})))||void 0===_programPeople$data$c?void 0:_programPeople$data$c.id;if(personId)personIds.push(personId);else{var _selectRegistrantsQue2,_registrant$profile,_registrant$invitatio,registrant=null===(_selectRegistrantsQue2=selectRegistrantsQuery.data)||void 0===_selectRegistrantsQue2?void 0:_selectRegistrantsQue2.registrant_Registrant.find((function(x){return x.id===registrantId}));esm.h.truthy(registrant,"Failed to find registrant "+registrantId),insertProgramPersons.push({name:registrant.displayName,affiliation:null===(_registrant$profile=registrant.profile)||void 0===_registrant$profile?void 0:_registrant$profile.affiliation,registrantId:registrant.id,conferenceId,subconferenceId,email:null===(_registrant$invitatio=registrant.invitation)||void 0===_registrant$invitatio?void 0:_registrant$invitatio.invitedEmailAddress})}},_iterator7=_createForOfIteratorHelper(registrantIds);try{for(_iterator7.s();!(_step7=_iterator7.n()).done;)registrantId=_step7.value,_loop3(registrantId)}catch(err){_iterator7.e(err)}finally{_iterator7.f()}if(!(insertProgramPersons.length>0)){_context7.next=14;break}return _context7.next=11,insertProgramPeople[1]({objects:insertProgramPersons},{fetchOptions:{headers:(_headers6={},_headers6[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers6)}});case 11:newPeople=_context7.sent,esm.h.truthy(null===(_newPeople$data=newPeople.data)||void 0===_newPeople$data||null===(_newPeople$data$inser=_newPeople$data.insert_collection_ProgramPerson)||void 0===_newPeople$data$inser?void 0:_newPeople$data$inser.returning,"Failed to insert content people"),personIds.push.apply(personIds,_toConsumableArray(newPeople.data.insert_collection_ProgramPerson.returning.map((function(x){return x.id}))));case 14:newEventPeople=[],_iterator8=_createForOfIteratorHelper(events);try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){_event3=_step8.value,_existingEventPeople3=_event3.eventPeople,_loop4=function _loop4(personId){_existingEventPeople3.some((function(person){return person.personId===personId&&person.roleName===selectedRole}))||newEventPeople.push({eventId:_event3.id,personId,roleName:selectedRole})},_iterator9=_createForOfIteratorHelper(personIds);try{for(_iterator9.s();!(_step9=_iterator9.n()).done;)personId=_step9.value,_loop4(personId)}catch(err){_iterator9.e(err)}finally{_iterator9.f()}}}catch(err){_iterator8.e(err)}finally{_iterator8.f()}return _context7.next=19,insertEventPeople(newEventPeople,insertEventPeopleQ,subconferenceId);case 19:return _context7.abrupt("return",newEventPeople);case 20:case"end":return _context7.stop()}}),_callee7)})))).apply(this,arguments)}function BatchAddEventPeople(_ref9){var isOpen=_ref9.isOpen,onClose=_ref9.onClose,events=_ref9.events,rooms=_ref9.rooms,roomOptions=(0,react.useMemo)((function(){return rooms.map((function(room){return(0,jsx_runtime.jsx)("option",{value:room.id,children:room.name},room.id)}))}),[rooms]),_useState36=_slicedToArray((0,react.useState)(),2),startsAfter=_useState36[0],setStartsAfter=_useState36[1],_useState38=_slicedToArray((0,react.useState)(),2),endsBefore=_useState38[0],setEndsBefore=_useState38[1],_useState40=_slicedToArray((0,react.useState)(""),2),selectedRoomId=_useState40[0],setSelectedRoomId=_useState40[1],_useState42=_slicedToArray((0,react.useState)(!0),2),refilterEvents=_useState42[0],setRefilterEvents=_useState42[1];(0,react.useEffect)((function(){setRefilterEvents(!0)}),[events]);var _useState44=_slicedToArray((0,react.useState)([]),2),filteredEvents=_useState44[0],setFilteredEvents=_useState44[1];(0,react.useEffect)((function(){if(refilterEvents){setRefilterEvents(!1);var startsAfterTime=null==startsAfter?void 0:startsAfter.getTime(),endsBeforeTime=null==endsBefore?void 0:endsBefore.getTime(),filteredByRoom=""===selectedRoomId?events:events.filter((function(event){return event.roomId===selectedRoomId})),filteredByTime=startsAfterTime||endsBeforeTime?filteredByRoom.filter((function(event){return(!startsAfterTime||Date.parse(event.scheduledStartTime)>=startsAfterTime)&&(!endsBeforeTime||Date.parse(event.scheduledEndTime)<=endsBeforeTime)})):filteredByRoom;setFilteredEvents(es.HCG([function(a,b){return Date.parse(a.scheduledStartTime)-Date.parse(b.scheduledStartTime)},function(a,b){return Date.parse(a.scheduledEndTime)-Date.parse(b.scheduledEndTime)}],filteredByTime))}}),[endsBefore,events,refilterEvents,selectedRoomId,startsAfter]);var firstEvent=(0,react.useMemo)((function(){return filteredEvents.length>0?filteredEvents[0]:void 0}),[filteredEvents]),lastEvent=(0,react.useMemo)((function(){return filteredEvents.length>1?filteredEvents[filteredEvents.length-1]:void 0}),[filteredEvents]);return(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.u_,{isOpen,onClose,children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.ZA,{}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.hz,{children:[(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.xB,{children:["Add people to events",(0,jsx_runtime.jsx)(chakra_ui_modal_esm.ol,{})]}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.fe,{children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{spacing:4,justifyContent:"flex-start",alignItems:"flex-start",children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{fontStyle:"italic",children:"Use the controls below to filter to particular events."}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Starts after"}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{children:[(0,jsx_runtime.jsx)(DateTimePicker.x,{value:startsAfter,onChange:setStartsAfter,onBlur:function onBlur(){return setRefilterEvents(!0)}}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{"aria-label":"Clear filter",size:"sm",isDisabled:!startsAfter,onClick:function onClick(){return setStartsAfter(void 0)},children:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"times"})})]})]}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Ends before"}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{children:[(0,jsx_runtime.jsx)(DateTimePicker.x,{value:endsBefore,onChange:setEndsBefore,onBlur:function onBlur(){return setRefilterEvents(!0)}}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{"aria-label":"Clear filter",size:"sm",isDisabled:!endsBefore,onClick:function onClick(){return setEndsBefore(void 0)},children:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"times"})})]})]}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"In room"}),(0,jsx_runtime.jsxs)(chakra_ui_select_esm.Ph,{value:selectedRoomId,onChange:function onChange(ev){return setSelectedRoomId(ev.target.value)},onBlur:function onBlur(){return setRefilterEvents(!0)},children:[(0,jsx_runtime.jsx)("option",{value:"",children:"<No filter>"}),roomOptions]})]}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{fontStyle:"italic",children:"Sample of events in your filtered selection."}),firstEvent||lastEvent?(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.aV,{children:[firstEvent?(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.HC,{children:["First: ",new Date(firstEvent.scheduledStartTime).toLocaleString()," -"," ",firstEvent.name]}):void 0,lastEvent?(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.HC,{children:["Last: ",new Date(lastEvent.scheduledStartTime).toLocaleString()," -"," ",lastEvent.name]}):void 0]}):(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:"No events in filtered selection."}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{fontStyle:"italic",children:"Select the bulk operation you would like to perform."}),(0,jsx_runtime.jsxs)(chakra_ui_accordion_esm.UQ,{w:"100%",children:[(0,jsx_runtime.jsx)(chakra_ui_accordion_esm.Qd,{children:function children(_ref10){var isExpanded=_ref10.isExpanded;return(0,jsx_runtime.jsx)(AddEventPeople_FromContentPanel,{events:filteredEvents,isExpanded,onClose})}}),(0,jsx_runtime.jsx)(chakra_ui_accordion_esm.Qd,{children:function children(_ref11){var isExpanded=_ref11.isExpanded;return(0,jsx_runtime.jsx)(AddEventPeople_SingleProgramPersonPanel,{events:filteredEvents,isExpanded,onClose})}}),(0,jsx_runtime.jsx)(RequireRole.Z,{organizerRole:!0,children:(0,jsx_runtime.jsx)(chakra_ui_accordion_esm.Qd,{children:function children(_ref12){var isExpanded=_ref12.isExpanded;return(0,jsx_runtime.jsx)(AddEventPeople_FromGroupPanel,{events:filteredEvents,isExpanded,onClose})}})}),(0,jsx_runtime.jsx)(RequireRole.Z,{organizerRole:!0,children:(0,jsx_runtime.jsx)(chakra_ui_accordion_esm.Qd,{children:function children(_ref13){var isExpanded=_ref13.isExpanded;return(0,jsx_runtime.jsx)(AddEventPeople_SingleRegistrantPanel,{events:filteredEvents,isExpanded,onClose})}})})]})]})})]})]})}(0,urql_core.Ps)(_templateObject||(_templateObject=function _taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(['\n    fragment AddEventPeople_ItemPerson on content_ItemProgramPerson {\n        id\n        itemId\n        personId\n        roleName\n    }\n\n    fragment AddEventPeople_ProgramPerson on collection_ProgramPerson {\n        id\n        name\n        affiliation\n        email\n        registrantId\n    }\n\n    fragment AddEventPeople_Registrant on registrant_Registrant {\n        id\n        displayName\n        profile {\n            registrantId\n            affiliation\n        }\n        invitation {\n            id\n            invitedEmailAddress\n        }\n    }\n\n    fragment AddEventPeople_Group on registrant_Group {\n        id\n        name\n    }\n\n    query AddEventPeople_SelectItemPeople($itemIds: [uuid!]!, $exhibitionIds: [uuid!]!) {\n        content_ItemProgramPerson(where: { itemId: { _in: $itemIds }, roleName: { _neq: "REVIEWER" } }) {\n            ...AddEventPeople_ItemPerson\n        }\n        content_ItemExhibition(where: { exhibitionId: { _in: $exhibitionIds } }) {\n            id\n            exhibitionId\n            itemId\n            item {\n                id\n                itemPeople(where: { roleName: { _neq: "REVIEWER" } }) {\n                    ...AddEventPeople_ItemPerson\n                }\n            }\n        }\n    }\n\n    query AddEventPeople_SelectProgramPeople($conferenceId: uuid!, $subconferenceCond: uuid_comparison_exp!) {\n        collection_ProgramPerson(where: { conferenceId: { _eq: $conferenceId }, subconferenceId: $subconferenceCond }) {\n            ...AddEventPeople_ProgramPerson\n        }\n    }\n\n    query AddEventPeople_SelectRegistrants($conferenceId: uuid!) {\n        registrant_Registrant(where: { conferenceId: { _eq: $conferenceId } }) {\n            ...AddEventPeople_Registrant\n        }\n    }\n\n    query AddEventPeople_SelectProgramPeople_ByRegistrant($registrantIds: [uuid!]!) {\n        collection_ProgramPerson(where: { registrantId: { _in: $registrantIds } }) {\n            ...AddEventPeople_ProgramPerson\n        }\n    }\n\n    query AddEventPeople_SelectGroups($conferenceId: uuid!, $subconferenceCond: uuid_comparison_exp!) {\n        registrant_Group(where: { conferenceId: { _eq: $conferenceId }, subconferenceId: $subconferenceCond }) {\n            ...AddEventPeople_Group\n        }\n    }\n\n    query AddEventPeople_SelectRegistrants_ByGroup($groupId: uuid!) {\n        registrant_Registrant(where: { groupRegistrants: { groupId: { _eq: $groupId } } }) {\n            ...AddEventPeople_Registrant\n        }\n    }\n\n    mutation AddEventPeople_InsertProgramPeople($objects: [collection_ProgramPerson_insert_input!]!) {\n        insert_collection_ProgramPerson(objects: $objects) {\n            returning {\n                ...AddEventPeople_ProgramPerson\n            }\n        }\n    }\n\n    mutation AddEventPeople_InsertEventPeople($objects: [schedule_EventProgramPerson_insert_input!]!) {\n        insert_schedule_EventProgramPerson(\n            objects: $objects\n            on_conflict: { constraint: EventProgramPerson_eventId_personId_roleName_key, update_columns: [] }\n        ) {\n            returning {\n                ...EventProgramPersonInfo\n            }\n        }\n    }\n']))),BatchAddEventPeople.displayName="BatchAddEventPeople";try{BatchAddEventPeople.displayName="BatchAddEventPeople",BatchAddEventPeople.__docgenInfo={description:"",displayName:"BatchAddEventPeople",props:{isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},onOpen:{defaultValue:null,description:"",name:"onOpen",required:!0,type:{name:"() => void"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},events:{defaultValue:null,description:"",name:"events",required:!0,type:{name:"EventInfoFragment[]"}},rooms:{defaultValue:null,description:"",name:"rooms",required:!0,type:{name:"readonly RoomInfoFragment[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/Schedule/BatchAddEventPeople.tsx#BatchAddEventPeople"]={docgenInfo:BatchAddEventPeople.__docgenInfo,name:"BatchAddEventPeople",path:"src/aspects/Conference/Manage/Schedule/BatchAddEventPeople.tsx#BatchAddEventPeople"})}catch(__react_docgen_typescript_loader_error){}var EditStreamTextIntegration_templateObject,EventProgramPersonsModal_templateObject,ManageSchedule_templateObject,ColumnId,ContinuationsEditor=__webpack_require__("./src/aspects/Conference/Manage/Schedule/ContinuationsEditor.tsx"),chakra_ui_spinner_esm=(__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.trim.js"),__webpack_require__("../node_modules/.pnpm/@chakra-ui+spinner@1.2.4_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/spinner/dist/chakra-ui-spinner.esm.js"));function EditStreamTextIntegration_slicedToArray(arr,i){return function EditStreamTextIntegration_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function EditStreamTextIntegration_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function EditStreamTextIntegration_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return EditStreamTextIntegration_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return EditStreamTextIntegration_arrayLikeToArray(o,minLen)}(arr,i)||function EditStreamTextIntegration_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function EditStreamTextIntegration_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function EditStreamTextIntegration(_ref){var _response$data,_response$data$schedu,eventId=_ref.eventId,subconferenceId=(0,AuthParameters.h)().subconferenceId,context=(0,react.useMemo)((function(){var _makeContext;return(0,make_context.f)(((_makeContext={})[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext))}),[subconferenceId]),response=EditStreamTextIntegration_slicedToArray((0,graphql.jwh)({variables:{eventId},requestPolicy:"network-only",context}),1)[0];return response.fetching&&!response.data?(0,jsx_runtime.jsx)(chakra_ui_spinner_esm.$,{}):(0,jsx_runtime.jsx)(EditStreamTextIntegrationInner,{eventId,outerValue:null===(_response$data=response.data)||void 0===_response$data||null===(_response$data$schedu=_response$data.schedule_Event_by_pk)||void 0===_response$data$schedu?void 0:_response$data$schedu.streamTextEventId})}function EditStreamTextIntegrationInner(_ref2){var eventId=_ref2.eventId,outerValue=_ref2.outerValue,subconferenceId=(0,AuthParameters.h)().subconferenceId,_useState2=EditStreamTextIntegration_slicedToArray((0,react.useState)(null!=outerValue?outerValue:null),2),initialValue=_useState2[0],setInitialValue=_useState2[1],_useState4=EditStreamTextIntegration_slicedToArray((0,react.useState)(initialValue),2),value=_useState4[0],setValue=_useState4[1],_useUpdateEventStream2=EditStreamTextIntegration_slicedToArray((0,graphql.sbQ)(),2),updateResponse=_useUpdateEventStream2[0],updateMutation=_useUpdateEventStream2[1],update=(0,react.useCallback)((function(newValue){var _headers;(setValue(newValue),setInitialValue(newValue),newValue!==initialValue)&&updateMutation({eventId,streamTextEventId:""===(null==newValue?void 0:newValue.trim())?null:newValue},{fetchOptions:{headers:(_headers={},_headers[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers)}})}),[eventId,initialValue,subconferenceId,updateMutation]);return(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{spacing:4,alignItems:"flex-start",children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:"StreamText is a 3rd party service for delivering real-time live captions. If you have a StreamText account you can configure an event and input your event id below. This will embed the StreamText feed within Midspace during this event."}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xv,{children:["Learn more at"," ",(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.rU,{href:"https://streamtext.net",isExternal:!0,children:["StreamText.Net",(0,jsx_runtime.jsx)("sup",{children:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.ExternalLinkIcon,{})})]}),"."]}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{fontSize:"xs",children:"The Midspace platform and software are not affiliated with StreamText.Net in any way. We cannot provide support with your StreamText feed. We are not responsible for any issue caused by StreamText software embedded within this site."}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"StreamText Event Id"}),(0,jsx_runtime.jsx)(chakra_ui_input_esm.II,{value:null!=value?value:"",onChange:function onChange(ev){setValue(ev.target.value)}}),(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.Q6,{children:"The event id obtained from StreamText. This is just the id, not the full URL. Leave blank to remove the integration."})]}),(0,jsx_runtime.jsxs)(chakra_ui_button_esm.hE,{children:[(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"pink",onClick:function onClick(){update(null)},isDisabled:updateResponse.fetching||null===value,children:"Clear"}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"gray",onClick:function onClick(){update(initialValue)},isDisabled:updateResponse.fetching||value===initialValue,children:"Reset"}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"purple",onClick:function onClick(){update(value)},isDisabled:value===initialValue,isLoading:updateResponse.fetching,children:"Save"})]}),updateResponse.error?(0,jsx_runtime.jsxs)(chakra_ui_alert_esm.bZ,{status:"error",children:[(0,jsx_runtime.jsx)(chakra_ui_alert_esm.zM,{}),(0,jsx_runtime.jsx)(chakra_ui_alert_esm.Cd,{children:"Error saving changes"}),(0,jsx_runtime.jsx)(chakra_ui_alert_esm.X,{children:updateResponse.error.message})]}):void 0]})}(0,urql_core.Ps)(EditStreamTextIntegration_templateObject||(EditStreamTextIntegration_templateObject=function EditStreamTextIntegration_taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(["\n    query SelectEventStreamTextEventId($eventId: uuid!) {\n        schedule_Event_by_pk(id: $eventId) {\n            id\n            streamTextEventId\n        }\n    }\n\n    mutation UpdateEventStreamTextEventId($eventId: uuid!, $streamTextEventId: String) {\n        update_schedule_Event_by_pk(pk_columns: { id: $eventId }, _set: { streamTextEventId: $streamTextEventId }) {\n            id\n            streamTextEventId\n        }\n    }\n"]))),EditStreamTextIntegrationInner.displayName="EditStreamTextIntegrationInner";try{EditStreamTextIntegration.displayName="EditStreamTextIntegration",EditStreamTextIntegration.__docgenInfo={description:"",displayName:"EditStreamTextIntegration",props:{eventId:{defaultValue:null,description:"",name:"eventId",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/Schedule/EditStreamTextIntegration.tsx#EditStreamTextIntegration"]={docgenInfo:EditStreamTextIntegration.__docgenInfo,name:"EditStreamTextIntegration",path:"src/aspects/Conference/Manage/Schedule/EditStreamTextIntegration.tsx#EditStreamTextIntegration"})}catch(__react_docgen_typescript_loader_error){}function EventProgramPersonsModal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function EventProgramPersonsModal_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){EventProgramPersonsModal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){EventProgramPersonsModal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function EventProgramPersonsModal_toConsumableArray(arr){return function EventProgramPersonsModal_arrayWithoutHoles(arr){if(Array.isArray(arr))return EventProgramPersonsModal_arrayLikeToArray(arr)}(arr)||function EventProgramPersonsModal_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||EventProgramPersonsModal_unsupportedIterableToArray(arr)||function EventProgramPersonsModal_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function EventProgramPersonsModal_slicedToArray(arr,i){return function EventProgramPersonsModal_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function EventProgramPersonsModal_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||EventProgramPersonsModal_unsupportedIterableToArray(arr,i)||function EventProgramPersonsModal_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function EventProgramPersonsModal_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return EventProgramPersonsModal_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?EventProgramPersonsModal_arrayLikeToArray(o,minLen):void 0}}function EventProgramPersonsModal_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function requiresEventPeople(event){return(!event.eventPeople||0===event.eventPeople.length)&&event.modeName===graphql.kdg.Livestream}function AddEventProgramPerson_RegistrantModal(_ref){var _selectRegistrantsQue,event=_ref.event,closeOuter=_ref.closeOuter,subconferenceId=(0,AuthParameters.h)().subconferenceId,_useDisclosure=(0,chakra_ui_hooks_esm.qY)(),isOpen=_useDisclosure.isOpen,onOpen=_useDisclosure.onOpen,onClose=_useDisclosure.onClose,context=(0,react.useMemo)((function(){var _makeContext;return(0,make_context.f)(((_makeContext={})[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext))}),[subconferenceId]),selectRegistrantsQuery=EventProgramPersonsModal_slicedToArray((0,graphql.V6e)({variables:{conferenceId:event.conferenceId},context}),1)[0],registrantOptions=(0,react.useMemo)((function(){return selectRegistrantsQuery.data?EventProgramPersonsModal_toConsumableArray(selectRegistrantsQuery.data.registrant_Registrant).sort((function(x,y){return x.displayName.localeCompare(y.displayName)})).map((function(x){var _x$profile,_x$invitation;return(0,jsx_runtime.jsxs)("option",{value:x.id,children:[x.displayName,null!==(_x$profile=x.profile)&&void 0!==_x$profile&&_x$profile.affiliation?" ("+x.profile.affiliation+")":"",null!==(_x$invitation=x.invitation)&&void 0!==_x$invitation&&_x$invitation.invitedEmailAddress?" <"+x.invitation.invitedEmailAddress+">":""]},x.id)})):void 0}),[selectRegistrantsQuery.data]),roleOptions=(0,react.useMemo)((function(){return Object.keys(graphql.hQl).sort((function(x,y){return x.localeCompare(y)})).map((function(x){var v=graphql.hQl[x];return(0,jsx_runtime.jsx)("option",{value:v,children:(0,CRUDComponents.oL)(v)},v)}))}),[]),_useState2=EventProgramPersonsModal_slicedToArray((0,react.useState)(""),2),selectedRegistrantId=_useState2[0],setSelectedRegistrantId=_useState2[1],_useState4=EventProgramPersonsModal_slicedToArray((0,react.useState)(graphql.hQl.Presenter),2),selectedRole=_useState4[0],setSelectedRole=_useState4[1],insertProgramPeople=(0,graphql.yo2)(),insertEventPeopleQ=(0,graphql.aoC)(),toast=(0,chakra_ui_toast_esm.pm)(),_useState6=EventProgramPersonsModal_slicedToArray((0,react.useState)(!1),2),adding=_useState6[0],setAdding=_useState6[1],_useState8=EventProgramPersonsModal_slicedToArray((0,react.useState)(null),2),error=_useState8[0],setError=_useState8[1],client=(0,urql_es.m8)(),add=(0,react.useCallback)(EventProgramPersonsModal_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var newEventPeople;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return setAdding(!0),setError(null),_context.prev=2,_context.next=5,addRegistrantsToEvent([selectedRegistrantId],selectRegistrantsQuery,(function(registrantIds){var _headers;return client.query(graphql.xB4,{registrantIds},{fetchOptions:{headers:(_headers={},_headers[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers)}}).toPromise()}),insertProgramPeople,event.conferenceId,event.subconferenceId,[event],selectedRole,insertEventPeopleQ);case 5:newEventPeople=_context.sent,setAdding(!1),onClose(),closeOuter(),toast({title:"Registrant added to "+newEventPeople.length+" event",status:"success",duration:3e3,isClosable:!0,position:"bottom"}),_context.next=16;break;case 12:_context.prev=12,_context.t0=_context.catch(2),setError(_context.t0.message||_context.t0.toString()),setAdding(!1);case 16:case"end":return _context.stop()}}),_callee,null,[[2,12]])}))),[selectedRegistrantId,selectRegistrantsQuery,insertProgramPeople,event,selectedRole,insertEventPeopleQ,onClose,closeOuter,toast,client,subconferenceId]);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{onClick:onOpen,children:"Add registrant"}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.u_,{isOpen,onClose,children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.ZA,{}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.hz,{children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.xB,{children:"Add registrant to event"}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.ol,{}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.fe,{children:[error||selectRegistrantsQuery.error?(0,jsx_runtime.jsxs)(chakra_ui_alert_esm.bZ,{status:"error",variant:"subtle",mb:4,justifyContent:"flex-start",alignItems:"flex-start",children:[(0,jsx_runtime.jsx)(chakra_ui_alert_esm.zM,{}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{justifyContent:"flex-start",alignItems:"flex-start",children:[(0,jsx_runtime.jsx)(chakra_ui_alert_esm.Cd,{children:error?"Error adding registrant to event":"Error loading list of registrants"}),(0,jsx_runtime.jsx)(chakra_ui_alert_esm.X,{children:null!=error?error:null===(_selectRegistrantsQue=selectRegistrantsQuery.error)||void 0===_selectRegistrantsQue?void 0:_selectRegistrantsQue.message})]})]}):void 0,registrantOptions?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)(chakra_ui_select_esm.Ph,{"aria-label":"Registrant to add",value:selectedRegistrantId,onChange:function onChange(ev){return setSelectedRegistrantId(ev.target.value)},mb:4,children:[(0,jsx_runtime.jsx)("option",{value:"",children:"Select a registrant"}),registrantOptions]}),(0,jsx_runtime.jsx)(chakra_ui_select_esm.Ph,{"aria-label":"Role of registrant",value:selectedRole,onChange:function onChange(ev){return setSelectedRole(ev.target.value)},mb:4,children:roleOptions.filter((function(x){return x.props.value!==graphql.hQl.Participant}))})]}):(0,jsx_runtime.jsx)(chakra_ui_spinner_esm.$,{label:"Loading registrants"})]}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.mz,{children:(0,jsx_runtime.jsxs)(chakra_ui_button_esm.hE,{children:[(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{onClick:onClose,children:"Cancel"}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"purple",isDisabled:selectRegistrantsQuery.fetching||""===selectedRegistrantId,isLoading:adding,onClick:add,children:"Add"})]})})]})]})]})}function EventProgramPersonsModal(_ref3){var _extractActualError,_ref8,_insertEventProgramPe,isOpen=_ref3.isOpen,onOpen=_ref3.onOpen,onClose=_ref3.onClose,event=_ref3.event,programPeople=_ref3.programPeople,data=(0,react.useMemo)((function(){return EventProgramPersonsModal_toConsumableArray(event.eventPeople)}),[event.eventPeople]),options=(0,react.useMemo)((function(){return EventProgramPersonsModal_toConsumableArray(programPeople).sort((function(x,y){return(0,maybeCompare.D)(x.name,y.name,(function(a,b){return a.localeCompare(b)}))})).map((function(person){return(0,jsx_runtime.jsx)("option",{value:person.id,children:person.name},person.id)}))}),[programPeople]),_useInsertEventProgra2=EventProgramPersonsModal_slicedToArray((0,graphql.TZE)(),2),insertEventProgramPersonResponse=_useInsertEventProgra2[0],insertEventProgramPerson=_useInsertEventProgra2[1],_useUpdateEventProgra2=EventProgramPersonsModal_slicedToArray((0,graphql.En)(),2),updateEventProgramPersonResponse=_useUpdateEventProgra2[0],updateEventProgramPerson=_useUpdateEventProgra2[1],_useDeleteEventProgra2=EventProgramPersonsModal_slicedToArray((0,graphql.M1$)(),2),deleteEventProgramPersonsResponse=_useDeleteEventProgra2[0],deleteEventProgramPersons=_useDeleteEventProgra2[1],row=(0,react.useMemo)((function(){return{getKey:function getKey(record){return record.id},canSelect:function canSelect(_record){return!0},pages:{defaultToLast:!1}}}),[]),roleOptions=(0,react.useMemo)((function(){return Object.keys(graphql.hQl).sort((function(x,y){return x.localeCompare(y)})).map((function(x){var v=graphql.hQl[x];return{value:v,label:(0,CRUDComponents.oL)(v)}}))}),[]),columns=(0,react.useMemo)((function(){return[{id:"ProgramPerson",defaultSortDirection:CRUDTable2.S.Asc,header:function NameHeader(_ref4){var isInCreate=_ref4.isInCreate,onClick=_ref4.onClick,sortDir=_ref4.sortDir;return isInCreate?(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Person"}):(0,jsx_runtime.jsxs)(chakra_ui_button_esm.zx,{size:"xs",onClick,children:["Person",null!==sortDir?" "+sortDir:void 0]})},get:function get(data){return programPeople.find((function(x){return x.id===data.personId}))},set:function set(record,value){record.personId=null==value?void 0:value.id},sort:function sort(x,y){return x&&y?(0,maybeCompare.D)(x.name,y.name,(function(a,b){return a.localeCompare(b)}))||(0,maybeCompare.D)(x.affiliation,y.affiliation,(function(a,b){return a.localeCompare(b)})):x?1:y?-1:0},cell:function ProgramPersonCell(_ref5){var _value$id,isInCreate=_ref5.isInCreate,value=_ref5.value,_onChange=_ref5.onChange,onBlur=_ref5.onBlur,ref=_ref5.ref;return isInCreate?(0,jsx_runtime.jsxs)(chakra_ui_select_esm.Ph,{value:null!==(_value$id=null==value?void 0:value.id)&&void 0!==_value$id?_value$id:"",onChange:function onChange(ev){return null==_onChange?void 0:_onChange(programPeople.find((function(x){return x.id===ev.target.value})))},onBlur,ref,children:[(0,jsx_runtime.jsx)("option",{value:"",children:"Select a person"}),options]}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:value?value.name+(value.affiliation?" ("+value.affiliation+")":""):"Person not found"})}},{id:"role",header:function RoleHeader(_ref6){var isInCreate=_ref6.isInCreate,onClick=_ref6.onClick,sortDir=_ref6.sortDir;return isInCreate?(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Role"}):(0,jsx_runtime.jsxs)(chakra_ui_button_esm.zx,{size:"xs",onClick,children:["Role",null!==sortDir?" "+sortDir:void 0]})},get:function get(data){return data.roleName},set:function set(record,value){record.roleName=value},sort:function sort(x,y){return x.localeCompare(y)},cell:function EventNameCell(_ref7){var value=_ref7.value,_onChange2=_ref7.onChange,onBlur=_ref7.onBlur,ref=_ref7.ref;return(0,jsx_runtime.jsx)(chakra_ui_select_esm.Ph,{value:null!=value?value:"",onChange:function onChange(ev){return null==_onChange2?void 0:_onChange2(ev.target.value)},onBlur,ref,children:roleOptions.filter((function(x){return value===graphql.hQl.Participant||x.value!==graphql.hQl.Participant})).map((function(option){return(0,jsx_runtime.jsx)("option",{value:option.value,children:option.label},option.value)}))})}}]}),[options,programPeople,roleOptions]),forceReloadRef=(0,react.useRef)((function(){}));(0,react.useEffect)((function(){var _forceReloadRef$curre;(insertEventProgramPersonResponse.error||updateEventProgramPersonResponse.error||deleteEventProgramPersonsResponse.error)&&(null===(_forceReloadRef$curre=forceReloadRef.current)||void 0===_forceReloadRef$curre||_forceReloadRef$curre.call(forceReloadRef))}),[deleteEventProgramPersonsResponse.error,insertEventProgramPersonResponse.error,updateEventProgramPersonResponse.error]);var _start,eventPeopleRequired=requiresEventPeople(event);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.M5,{flexDir:"column",children:[(0,jsx_runtime.jsxs)(chakra_ui_button_esm.zx,{onClick:onOpen,colorScheme:eventPeopleRequired?"yellow":"blue",children:[eventPeopleRequired?(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"exclamation-triangle",mr:1}):void 0," ","Manage Event People"]}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{as:"p",mt:2,children:"(People can be listed as presenters or chairs of events.)"})]})}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.u_,{scrollBehavior:"inside",onClose,isOpen,motionPreset:"scale",size:"full",children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.ZA,{}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.hz,{children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.xB,{paddingBottom:0,children:"Manage Event People"}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.xB,{paddingTop:"0.3rem",fontSize:"100%",fontStyle:"italic",fontWeight:"normal",children:["",event.name,""]}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.ol,{}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.fe,{children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{children:[(0,jsx_runtime.jsx)(AddEventProgramPerson_RegistrantModal,{event,closeOuter:onClose}),(0,jsx_runtime.jsx)(CRUDTable2.Z,{data,tableUniqueName:"ManageConferenceSchedule_EventProgramPersonsModal",row,columns,insert:{ongoing:insertEventProgramPersonResponse.fetching,generateDefaults:function generateDefaults(){return{id:(0,v4.Z)(),eventId:event.id,roleName:graphql.hQl.Presenter}},makeWhole:function makeWhole(d){return d.personId&&d},start:(_start=EventProgramPersonsModal_asyncToGenerator(regeneratorRuntime.mark((function _callee2(record){var _headers2,newEventProgramPerson;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return esm.h.truthy(record.roleName),esm.h.truthy(record.personId),newEventProgramPerson={id:(0,v4.Z)(),eventId:event.id,personId:record.personId,roleName:record.roleName},_context2.next=5,insertEventProgramPerson({newEventProgramPerson},{fetchOptions:{headers:(_headers2={},_headers2[auth.k.Role]=event.subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers2)}});case 5:case"end":return _context2.stop()}}),_callee2)}))),function start(_x){return _start.apply(this,arguments)})},update:{ongoing:updateEventProgramPersonResponse.fetching,start:function start(record){var _headers3;updateEventProgramPerson({id:record.id,roleName:record.roleName},{fetchOptions:{headers:(_headers3={},_headers3[auth.k.Role]=event.subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers3)}})}},delete:{ongoing:deleteEventProgramPersonsResponse.fetching,start:function start(keys){var _headers4;deleteEventProgramPersons({deleteEventPeopleIds:keys},{fetchOptions:{headers:(_headers4={},_headers4[auth.k.Role]=event.subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers4)}})}},alert:insertEventProgramPersonResponse.error||updateEventProgramPersonResponse.error||deleteEventProgramPersonsResponse.error?{status:"error",title:"Error saving changes",description:null!==(_extractActualError=(0,ExtractActualError.Z)(null!==(_ref8=null!==(_insertEventProgramPe=insertEventProgramPersonResponse.error)&&void 0!==_insertEventProgramPe?_insertEventProgramPe:updateEventProgramPersonResponse.error)&&void 0!==_ref8?_ref8:deleteEventProgramPersonsResponse.error))&&void 0!==_extractActualError?_extractActualError:"Unknown error"}:void 0,forceReload:forceReloadRef})]})}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.mz,{children:(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"pink",mr:3,onClick:onClose,children:"Done"})})]})]})]})}(0,urql_core.Ps)(EventProgramPersonsModal_templateObject||(EventProgramPersonsModal_templateObject=function EventProgramPersonsModal_taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(["\n    fragment EventInfo on schedule_Event {\n        conferenceId\n        subconferenceId\n        id\n        eventPeople {\n            ...EventProgramPersonInfo\n        }\n        id\n        modeName\n        name\n        roomId\n        scheduledStartTime\n        scheduledEndTime\n        itemId\n        exhibitionId\n        shufflePeriodId\n        enableRecording\n        automaticParticipationSurvey\n        autoPlayElementId\n    }\n\n    fragment EventProgramPersonInfo on schedule_EventProgramPerson {\n        id\n        eventId\n        roleName\n        personId\n    }\n\n    mutation InsertEventProgramPerson($newEventProgramPerson: schedule_EventProgramPerson_insert_input!) {\n        insert_schedule_EventProgramPerson_one(\n            object: $newEventProgramPerson\n            on_conflict: { constraint: EventProgramPerson_eventId_personId_roleName_key, update_columns: [] }\n        ) {\n            ...EventProgramPersonInfo\n        }\n    }\n\n    mutation DeleteEventProgramPersons($deleteEventPeopleIds: [uuid!]!) {\n        delete_schedule_EventProgramPerson(where: { id: { _in: $deleteEventPeopleIds } }) {\n            returning {\n                id\n            }\n        }\n    }\n\n    mutation UpdateEventProgramPerson($id: uuid!, $roleName: schedule_EventProgramPersonRole_enum!) {\n        update_schedule_EventProgramPerson_by_pk(pk_columns: { id: $id }, _set: { roleName: $roleName }) {\n            ...EventProgramPersonInfo\n        }\n    }\n"])));try{requiresEventPeople.displayName="requiresEventPeople",requiresEventPeople.__docgenInfo={description:"",displayName:"requiresEventPeople",props:{__typename:{defaultValue:null,description:"",name:"__typename",required:!1,type:{name:"enum",value:[{value:'"schedule_Event"'}]}},conferenceId:{defaultValue:null,description:"",name:"conferenceId",required:!0,type:{name:"any"}},subconferenceId:{defaultValue:null,description:"",name:"subconferenceId",required:!1,type:{name:"any"}},id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"any"}},modeName:{defaultValue:null,description:"",name:"modeName",required:!1,type:{name:"Schedule_Mode_Enum | null"}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},roomId:{defaultValue:null,description:"",name:"roomId",required:!0,type:{name:"any"}},scheduledStartTime:{defaultValue:null,description:"",name:"scheduledStartTime",required:!1,type:{name:"any"}},scheduledEndTime:{defaultValue:null,description:"",name:"scheduledEndTime",required:!1,type:{name:"any"}},itemId:{defaultValue:null,description:"",name:"itemId",required:!1,type:{name:"any"}},exhibitionId:{defaultValue:null,description:"",name:"exhibitionId",required:!1,type:{name:"any"}},shufflePeriodId:{defaultValue:null,description:"",name:"shufflePeriodId",required:!1,type:{name:"any"}},enableRecording:{defaultValue:null,description:"",name:"enableRecording",required:!0,type:{name:"boolean"}},automaticParticipationSurvey:{defaultValue:null,description:"",name:"automaticParticipationSurvey",required:!0,type:{name:"boolean"}},autoPlayElementId:{defaultValue:null,description:"",name:"autoPlayElementId",required:!1,type:{name:"any"}},eventPeople:{defaultValue:null,description:"",name:"eventPeople",required:!0,type:{name:'readonly { readonly __typename?: "schedule_EventProgramPerson" | undefined; readonly id: any; readonly eventId: any; readonly roleName: Schedule_EventProgramPersonRole_Enum; readonly personId: any; }[]'}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/Schedule/EventProgramPersonsModal.tsx#requiresEventPeople"]={docgenInfo:requiresEventPeople.__docgenInfo,name:"requiresEventPeople",path:"src/aspects/Conference/Manage/Schedule/EventProgramPersonsModal.tsx#requiresEventPeople"})}catch(__react_docgen_typescript_loader_error){}try{AddEventProgramPerson_RegistrantModal.displayName="AddEventProgramPerson_RegistrantModal",AddEventProgramPerson_RegistrantModal.__docgenInfo={description:"",displayName:"AddEventProgramPerson_RegistrantModal",props:{event:{defaultValue:null,description:"",name:"event",required:!0,type:{name:"EventInfoFragment"}},closeOuter:{defaultValue:null,description:"",name:"closeOuter",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/Schedule/EventProgramPersonsModal.tsx#AddEventProgramPerson_RegistrantModal"]={docgenInfo:AddEventProgramPerson_RegistrantModal.__docgenInfo,name:"AddEventProgramPerson_RegistrantModal",path:"src/aspects/Conference/Manage/Schedule/EventProgramPersonsModal.tsx#AddEventProgramPerson_RegistrantModal"})}catch(__react_docgen_typescript_loader_error){}try{EventProgramPersonsModal.displayName="EventProgramPersonsModal",EventProgramPersonsModal.__docgenInfo={description:"",displayName:"EventProgramPersonsModal",props:{isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},onOpen:{defaultValue:null,description:"",name:"onOpen",required:!0,type:{name:"() => void"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},event:{defaultValue:null,description:"",name:"event",required:!0,type:{name:"EventInfoFragment"}},programPeople:{defaultValue:null,description:"",name:"programPeople",required:!0,type:{name:"readonly ProgramPersonInfoFragment[]"}},yellow:{defaultValue:null,description:"",name:"yellow",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/Schedule/EventProgramPersonsModal.tsx#EventProgramPersonsModal"]={docgenInfo:EventProgramPersonsModal.__docgenInfo,name:"EventProgramPersonsModal",path:"src/aspects/Conference/Manage/Schedule/EventProgramPersonsModal.tsx#EventProgramPersonsModal"})}catch(__react_docgen_typescript_loader_error){}function ManageSchedule_toConsumableArray(arr){return function ManageSchedule_arrayWithoutHoles(arr){if(Array.isArray(arr))return ManageSchedule_arrayLikeToArray(arr)}(arr)||function ManageSchedule_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||ManageSchedule_unsupportedIterableToArray(arr)||function ManageSchedule_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ManageSchedule_slicedToArray(arr,i){return function ManageSchedule_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ManageSchedule_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||ManageSchedule_unsupportedIterableToArray(arr,i)||function ManageSchedule_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ManageSchedule_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return ManageSchedule_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ManageSchedule_arrayLikeToArray(o,minLen):void 0}}function ManageSchedule_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function rowWarning(row){if(requiresEventPeople(row))return"This event will be live streamed but no Event People have been assigned to manage it."}function isOngoing(now,startLeeway,endLeeway,start,end){return start-startLeeway<=now&&now<=end+endLeeway}function EditableScheduleTable(){var _wholeSchedule$data2,_shufflePeriodsRespon2,_wholeSchedule$data5,_wholeSchedule$data6,_wholeSchedule$data8,_wholeSchedule$data10,_wholeSchedule$data25,_wholeSchedule$data26,_wholeSchedule$data27,_shufflePeriodsRespon7,_wholeSchedule$data29,_wholeSchedule$data31,_wholeSchedule$data43,_wholeSchedule$data44,_wholeSchedule$data45,_wholeSchedule$data46,_wholeSchedule$data47,_wholeSchedule$data48,_wholeSchedule$data49,_extractActualError,_ref29,_insertEventResponse$,_wholeSchedule$data$c3,_wholeSchedule$data50,_wholeSchedule$data$s2,_wholeSchedule$data51,_wholeSchedule$data$r3,_wholeSchedule$data52,conference=(0,useConference.fk)(),_useAuthParameters=(0,AuthParameters.h)(),conferencePath=_useAuthParameters.conferencePath,subconferenceId=_useAuthParameters.subconferenceId,allowOngoingEventCreation=(0,App.Hv)().developer.allowOngoingEventCreation,context=(0,react.useMemo)((function(){var _makeContext;return(0,make_context.f)(((_makeContext={})[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext))}),[subconferenceId]),wholeScheduleContext=(0,react.useMemo)((function(){return Object.assign({},context,{additionalTypenames:["room_Room","schedule_Event","collection_Tag","collection_Exhibition","content_Item","collection_ProgramPerson"]})}),[context]),wholeSchedule=ManageSchedule_slicedToArray((0,graphql.X3V)({variables:{conferenceId:conference.id,subconferenceCond:subconferenceId?{_eq:subconferenceId}:{_is_null:!0}},requestPolicy:"cache-and-network",context:wholeScheduleContext}),1)[0],data=(0,react.useMemo)((function(){var _wholeSchedule$data$s,_wholeSchedule$data;return ManageSchedule_toConsumableArray(null!==(_wholeSchedule$data$s=null===(_wholeSchedule$data=wholeSchedule.data)||void 0===_wholeSchedule$data?void 0:_wholeSchedule$data.schedule_Event.map((function(x){return Object.assign({},x)})))&&void 0!==_wholeSchedule$data$s?_wholeSchedule$data$s:[])}),[null===(_wholeSchedule$data2=wholeSchedule.data)||void 0===_wholeSchedule$data2?void 0:_wholeSchedule$data2.schedule_Event]),shufflePeriodsNow=(0,react.useMemo)((function(){return(new Date).toISOString()}),[]),shufflePeriodsResponse=ManageSchedule_slicedToArray((0,graphql.p2)({variables:{conferenceId:conference.id,subconferenceCond:subconferenceId?{_eq:subconferenceId}:{_is_null:!0},now:shufflePeriodsNow},context}),1)[0],shufflePeriodOptions=(0,react.useMemo)((function(){var _shufflePeriodsRespon;return null!==(_shufflePeriodsRespon=shufflePeriodsResponse.data)&&void 0!==_shufflePeriodsRespon&&_shufflePeriodsRespon.room_ShufflePeriod?ManageSchedule_toConsumableArray(shufflePeriodsResponse.data.room_ShufflePeriod).sort((function(x,y){return x.name.localeCompare(y.name)})).map((function(period){return(0,jsx_runtime.jsx)("option",{value:period.id,children:period.name},period.id)})):[]}),[null===(_shufflePeriodsRespon2=shufflePeriodsResponse.data)||void 0===_shufflePeriodsRespon2?void 0:_shufflePeriodsRespon2.room_ShufflePeriod]),roomOptions=(0,react.useMemo)((function(){var _wholeSchedule$data3;return null!==(_wholeSchedule$data3=wholeSchedule.data)&&void 0!==_wholeSchedule$data3&&_wholeSchedule$data3.room_Room?ManageSchedule_toConsumableArray(wholeSchedule.data.room_Room).filter((function(room){var _wholeSchedule$data4;return(!room.itemId||(null===(_wholeSchedule$data4=wholeSchedule.data)||void 0===_wholeSchedule$data4?void 0:_wholeSchedule$data4.content_Item.some((function(x){return x.id===room.itemId&&x.typeName===graphql.gqi.Sponsor}))))&&room.managementModeName!==graphql.ZvF.Dm&&room.managementModeName!==graphql.ZvF.Managed})).sort((function(x,y){return x.name.localeCompare(y.name)})).map((function(room){return(0,jsx_runtime.jsx)("option",{value:room.id,children:room.name},room.id)})):void 0}),[null===(_wholeSchedule$data5=wholeSchedule.data)||void 0===_wholeSchedule$data5?void 0:_wholeSchedule$data5.room_Room,null===(_wholeSchedule$data6=wholeSchedule.data)||void 0===_wholeSchedule$data6?void 0:_wholeSchedule$data6.content_Item]),roomModeOptions=(0,react.useMemo)((function(){return Object.keys(graphql.kdg).map((function(x){var v=graphql.kdg[x];return{value:v,label:(0,CRUDComponents.oL)(v)}})).sort((function(x,y){return x.label.localeCompare(y.label)}))}),[]),itemOptions=(0,react.useMemo)((function(){var _wholeSchedule$data7;return null!==(_wholeSchedule$data7=wholeSchedule.data)&&void 0!==_wholeSchedule$data7&&_wholeSchedule$data7.content_Item?ManageSchedule_toConsumableArray(wholeSchedule.data.content_Item).sort((function(x,y){return x.title.localeCompare(y.title)})).map((function(content){return(0,jsx_runtime.jsx)("option",{value:content.id,children:content.title},content.id)})):void 0}),[null===(_wholeSchedule$data8=wholeSchedule.data)||void 0===_wholeSchedule$data8?void 0:_wholeSchedule$data8.content_Item]),exhibitionOptions=(0,react.useMemo)((function(){var _wholeSchedule$data9;return null!==(_wholeSchedule$data9=wholeSchedule.data)&&void 0!==_wholeSchedule$data9&&_wholeSchedule$data9.collection_Exhibition?ManageSchedule_toConsumableArray(wholeSchedule.data.collection_Exhibition).sort((function(x,y){return x.name.localeCompare(y.name)})).map((function(exhibition){return(0,jsx_runtime.jsx)("option",{value:exhibition.id,children:exhibition.name},exhibition.id)})):void 0}),[null===(_wholeSchedule$data10=wholeSchedule.data)||void 0===_wholeSchedule$data10?void 0:_wholeSchedule$data10.collection_Exhibition]),_useDisclosure=(0,chakra_ui_hooks_esm.qY)(),isSecondaryPanelOpen=_useDisclosure.isOpen,onSecondaryPanelOpen=_useDisclosure.onOpen,_onSecondaryPanelClose=_useDisclosure.onClose,_useState2=ManageSchedule_slicedToArray((0,react.useState)(null),2),editingIndex=_useState2[0],setEditingIndex=_useState2[1],_useInsertEventInfoMu2=ManageSchedule_slicedToArray((0,graphql.oDS)(),2),insertEventResponse=_useInsertEventInfoMu2[0],insertEvent=_useInsertEventInfoMu2[1],_useUpdateEventInfoMu2=ManageSchedule_slicedToArray((0,graphql.Sbe)(),2),updateEventResponse=_useUpdateEventInfoMu2[0],updateEvent=_useUpdateEventInfoMu2[1],_useDeleteEventInfosM2=ManageSchedule_slicedToArray((0,graphql.Gs1)(),2),deleteEventsResponse=_useDeleteEventInfosM2[0],deleteEvents=_useDeleteEventInfosM2[1],columns=react.useMemo((function(){return[{id:ColumnId.StartTime,isDataDependency:!0,defaultSortDirection:CRUDTable2.S.Asc,header:function StartTimeHeader(_ref){var isInCreate=_ref.isInCreate,onClick=_ref.onClick,sortDir=_ref.sortDir;return isInCreate?(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Start time"}):(0,jsx_runtime.jsxs)(chakra_ui_button_esm.zx,{size:"xs",onClick,children:["Start Time",null!==sortDir?" "+sortDir:void 0]})},get:function get(record){return record.scheduledStartTime?new Date(record.scheduledStartTime):new Date},set:function set(record,v){record.scheduledStartTime=v.toISOString()},filterFn:(0,CRUDComponents.F2)(["scheduledStartTime"]),filterEl:CRUDComponents.V0,sort:function sort(x,y){return x.getTime()-y.getTime()},cell:function StartTimeCell(_ref2){var isInCreate=_ref2.isInCreate,value=_ref2.value,_onChange=_ref2.onChange,onBlur=_ref2.onBlur,ref=_ref2.ref,staleRecord=_ref2.staleRecord,now=(0,useRealTime.$)(1e4),start=staleRecord.scheduledStartTime?Date.parse(staleRecord.scheduledStartTime):Date.now(),end=staleRecord.scheduledEndTime?Date.parse(staleRecord.scheduledEndTime):start+3e5,ongoing=isOngoing(now,3e5,24e4,start,end)&&!allowOngoingEventCreation,past=end<now-24e4,isLivestream=!!staleRecord.modeName&&staleRecord.modeName===graphql.kdg.Livestream;return(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{children:[!isInCreate&&(ongoing||past)&&isLivestream?(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"You cannot edit the start time of an ongoing or past livestream event.",children:(0,jsx_runtime.jsx)(FAIcon.Z,{color:"blue.400",iconStyle:"s",icon:"info-circle"})}):void 0,(0,jsx_runtime.jsx)(DateTimePicker.x,{size:"sm",value,onChange:function onChange(v){null==_onChange||_onChange(v)},onBlur,isDisabled:!isInCreate&&(past||ongoing)&&isLivestream,ref})]})}},{id:ColumnId.EndTime,isDataDependency:!0,header:function EndTimeHeader(_ref3){var isInCreate=_ref3.isInCreate,onClick=_ref3.onClick,sortDir=_ref3.sortDir;return isInCreate?(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"End time"}):(0,jsx_runtime.jsxs)(chakra_ui_button_esm.zx,{size:"xs",onClick,children:["End Time",null!==sortDir?" "+sortDir:void 0]})},get:function get(record){return record.scheduledEndTime?new Date(record.scheduledEndTime):new Date(Date.parse(record.scheduledStartTime)+3e5)},set:function set(record,v){record.scheduledEndTime=v.toISOString()},filterFn:(0,CRUDComponents.F2)(["scheduledEndTime"]),filterEl:CRUDComponents.V0,sort:function sort(x,y){return x.getTime()-y.getTime()},cell:function EndTimeCell(_ref4){var isInCreate=_ref4.isInCreate,value=_ref4.value,_onChange2=_ref4.onChange,onBlur=_ref4.onBlur,ref=_ref4.ref,staleRecord=_ref4.staleRecord,now=(0,useRealTime.$)(1e4),start=staleRecord.scheduledStartTime?Date.parse(staleRecord.scheduledStartTime):Date.now(),end=staleRecord.scheduledEndTime?Date.parse(staleRecord.scheduledEndTime):start+3e5,ongoing=function isOngoingNearBoundary(now,startLeeway,endLeeway,start,end){return start-startLeeway<=now&&now<=start+startLeeway||end-endLeeway<=now&&now<=end+endLeeway}(now,3e5,24e4,start,end)&&!allowOngoingEventCreation,past=end<now-24e4,isLivestream=!!staleRecord.modeName&&staleRecord.modeName===graphql.kdg.Livestream;return(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{children:[!isInCreate&&past&&isLivestream?(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"You cannot edit the end time of a past livestream event.",children:(0,jsx_runtime.jsx)(FAIcon.Z,{color:"blue.400",iconStyle:"s",icon:"info-circle"})}):void 0,!isInCreate&&(ongoing||past)&&isLivestream?(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"You cannot edit the end time of an ongoing livestream event within 5 minutes of its start or 4 minutes of its end.",children:(0,jsx_runtime.jsx)(FAIcon.Z,{color:"blue.400",iconStyle:"s",icon:"info-circle"})}):void 0,(0,jsx_runtime.jsx)(DateTimePicker.x,{size:"sm",value,onChange:function onChange(v){null==_onChange2||_onChange2(v)},onBlur,isDisabled:!isInCreate&&(past||ongoing)&&isLivestream,ref})]})}},{id:ColumnId.Room,isDataDependency:!0,header:function EndTimeHeader(_ref5){var isInCreate=_ref5.isInCreate,onClick=_ref5.onClick,sortDir=_ref5.sortDir;return isInCreate?(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Room"}):(0,jsx_runtime.jsxs)(chakra_ui_button_esm.zx,{size:"xs",onClick,children:["Room",null!==sortDir?" "+sortDir:void 0]})},get:function get(data){var _wholeSchedule$data11;return null===(_wholeSchedule$data11=wholeSchedule.data)||void 0===_wholeSchedule$data11?void 0:_wholeSchedule$data11.room_Room.find((function(room){return room.id===data.roomId}))},set:function set(record,v){record.roomId=null==v?void 0:v.id},sort:function sort(x,y){return x&&y?x.name.localeCompare(y.name):x?1:y?-1:0},filterFn:function filterFn(rows,filterValue){return rows.filter((function(row){var _wholeSchedule$data$r,_wholeSchedule$data12,_wholeSchedule$data13;return null!==(_wholeSchedule$data$r=null===(_wholeSchedule$data12=wholeSchedule.data)||void 0===_wholeSchedule$data12||null===(_wholeSchedule$data13=_wholeSchedule$data12.room_Room.find((function(room){return room.id===row.roomId})))||void 0===_wholeSchedule$data13?void 0:_wholeSchedule$data13.name.toLowerCase().includes(filterValue.toLowerCase()))&&void 0!==_wholeSchedule$data$r&&_wholeSchedule$data$r}))},filterEl:CRUDComponents.Oe,cell:function RoomCell(_ref6){var _value$id,_wholeSchedule$data15,_wholeSchedule$data16,isInCreate=_ref6.isInCreate,value=_ref6.value,_onChange3=_ref6.onChange,onBlur=_ref6.onBlur,ref=_ref6.ref,staleRecord=_ref6.staleRecord,now=(0,useRealTime.$)(1e4),start=staleRecord.scheduledStartTime?Date.parse(staleRecord.scheduledStartTime):Date.now(),end=staleRecord.scheduledEndTime?Date.parse(staleRecord.scheduledEndTime):start+3e5,ongoing=isOngoing(now,3e5,24e4,start,end)&&!allowOngoingEventCreation,past=end<now-24e4,isLivestream=!!staleRecord.modeName&&staleRecord.modeName===graphql.kdg.Livestream;return(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{children:[value?(0,jsx_runtime.jsx)(LinkButton.Qj,{linkProps:{target:"_blank"},to:conferencePath+"/room/"+value.id,size:"xs","aria-label":"Go to room in new tab",children:(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"Go to room in new tab",children:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"link"})})}):void 0,!isInCreate&&(ongoing||past)&&isLivestream?(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"You cannot edit the room of an ongoing or past livestream event.",children:(0,jsx_runtime.jsx)(FAIcon.Z,{color:"blue.400",iconStyle:"s",icon:"info-circle"})}):void 0,(0,jsx_runtime.jsxs)(chakra_ui_select_esm.Ph,{value:null!==(_value$id=null==value?void 0:value.id)&&void 0!==_value$id?_value$id:"",onChange:function onChange(ev){var _wholeSchedule$data14;return null==_onChange3?void 0:_onChange3(null===(_wholeSchedule$data14=wholeSchedule.data)||void 0===_wholeSchedule$data14?void 0:_wholeSchedule$data14.room_Room.find((function(room){return room.id===ev.target.value})))},onBlur,isDisabled:!isInCreate&&(ongoing||past)&&isLivestream,ref,maxW:400,children:[roomOptions,!value||null!=roomOptions&&roomOptions.some((function(option){return option.props.value===(null==value?void 0:value.id)}))?void 0:(0,jsx_runtime.jsx)("option",{value:value.id,children:null===(_wholeSchedule$data15=wholeSchedule.data)||void 0===_wholeSchedule$data15||null===(_wholeSchedule$data16=_wholeSchedule$data15.room_Room.find((function(x){return x.id===(null==value?void 0:value.id)})))||void 0===_wholeSchedule$data16?void 0:_wholeSchedule$data16.name},value.id)]})]})}},{id:ColumnId.RoomMode,header:function EndTimeHeader(_ref7){var isInCreate=_ref7.isInCreate,onClick=_ref7.onClick,sortDir=_ref7.sortDir;return isInCreate?(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Mode"}):(0,jsx_runtime.jsxs)(chakra_ui_button_esm.zx,{size:"xs",onClick,children:["Mode",null!==sortDir?" "+sortDir:void 0]})},get:function get(data){return data.modeName},set:function set(record,v){record.modeName=v},filterFn:function filterFn(rows,v){return rows.filter((function(r){return r.modeName===v}))},filterEl:(0,CRUDComponents.fD)(Object.values(graphql.kdg)),sort:function sort(x,y){return x.localeCompare(y)},cell:function RoomModeCell(_ref8){var value=_ref8.value,_onChange4=_ref8.onChange,onBlur=_ref8.onBlur,ref=_ref8.ref,staleRecord=_ref8.staleRecord,now=(0,useRealTime.$)(1e4),start=staleRecord.scheduledStartTime?Date.parse(staleRecord.scheduledStartTime):Date.now(),ongoing=isOngoing(now,3e5,24e4,start,staleRecord.scheduledEndTime?Date.parse(staleRecord.scheduledEndTime):start+3e5)&&!allowOngoingEventCreation;return(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{children:[now<start?(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"Live-stream modes must be set at least 10 minutes in advance of an event.",children:(0,jsx_runtime.jsx)(FAIcon.Z,{color:"blue.400",iconStyle:"s",icon:"info-circle"})}):void 0,(0,jsx_runtime.jsx)(chakra_ui_select_esm.Ph,{value:null!=value?value:"",onChange:function onChange(ev){return null==_onChange4?void 0:_onChange4(ev.target.value)},onBlur,ref,maxW:400,children:roomModeOptions.map((function(option){return(0,jsx_runtime.jsx)("option",{value:option.value,disabled:!(!ongoing||option.value!==graphql.kdg.Livestream||option.value===value)||void 0,children:option.label},option.value)}))})]})}},{id:ColumnId.Name,header:function EventNameHeader(_ref9){var isInCreate=_ref9.isInCreate,onClick=_ref9.onClick,sortDir=_ref9.sortDir;return isInCreate?(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Name"}):(0,jsx_runtime.jsxs)(chakra_ui_button_esm.zx,{size:"xs",onClick,children:["Name",null!==sortDir?" "+sortDir:void 0]})},get:function get(data){return data.name},set:function set(record,value){record.name=value},sort:function sort(x,y){return x.localeCompare(y)},filterFn:function filterFn(rows,filterValue){return""===filterValue?rows.filter((function(row){var _row$name;return""===(null!==(_row$name=row.name)&&void 0!==_row$name?_row$name:"")})):rows.filter((function(row){return row.name.toLowerCase().includes(filterValue.toLowerCase())}))},filterEl:CRUDComponents.Oe,cell:function EventNameCell(_ref10){var value=_ref10.value,_onChange5=_ref10.onChange,onBlur=_ref10.onBlur,ref=_ref10.ref;return(0,jsx_runtime.jsx)(chakra_ui_input_esm.II,{type:"text",value:null!=value?value:"",onChange:function onChange(ev){return null==_onChange5?void 0:_onChange5(ev.target.value)},onBlur,border:"1px solid",borderColor:"rgba(255, 255, 255, 0.16)",ref})}},{id:ColumnId.Content,header:function ContentHeader(_ref11){var isInCreate=_ref11.isInCreate,onClick=_ref11.onClick,sortDir=_ref11.sortDir;return isInCreate?(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Content (optional)"}):(0,jsx_runtime.jsxs)(chakra_ui_button_esm.zx,{size:"xs",onClick,children:["Content",null!==sortDir?" "+sortDir:void 0]})},get:function get(data){var _wholeSchedule$data17;return null===(_wholeSchedule$data17=wholeSchedule.data)||void 0===_wholeSchedule$data17?void 0:_wholeSchedule$data17.content_Item.find((function(room){return room.id===data.itemId}))},set:function set(record,value){record.itemId=null==value?void 0:value.id},sortType:function sortType(rowA,rowB){return rowA&&rowB?rowA.title.localeCompare(rowB.title):rowA?1:rowB?-1:0},filterFn:function filterFn(rows,filterValue){return""===filterValue?rows.filter((function(row){return!row.itemId})):rows.filter((function(row){var _ref12,_wholeSchedule$data18,_wholeSchedule$data19;return null!==(_ref12=row.itemId&&(null===(_wholeSchedule$data18=wholeSchedule.data)||void 0===_wholeSchedule$data18||null===(_wholeSchedule$data19=_wholeSchedule$data18.content_Item.find((function(room){return room.id===row.itemId})))||void 0===_wholeSchedule$data19?void 0:_wholeSchedule$data19.title.toLowerCase().includes(filterValue.toLowerCase())))&&void 0!==_ref12&&_ref12}))},filterEl:CRUDComponents.Oe,cell:function ContentCell(_ref13){var _value$id2,isInCreate=_ref13.isInCreate,value=_ref13.value,_onChange6=_ref13.onChange,onBlur=_ref13.onBlur,ref=_ref13.ref,staleRecord=_ref13.staleRecord,now=(0,useRealTime.$)(1e4),start=staleRecord.scheduledStartTime?Date.parse(staleRecord.scheduledStartTime):Date.now(),end=staleRecord.scheduledEndTime?Date.parse(staleRecord.scheduledEndTime):start+3e5,ongoing=isOngoing(now,3e5,24e4,start,end)&&!allowOngoingEventCreation,past=end<now-24e4,isLivestream=!!staleRecord.modeName&&staleRecord.modeName===graphql.kdg.Livestream;return(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{children:[value?(0,jsx_runtime.jsx)(LinkButton.Qj,{linkProps:{target:"_blank"},to:conferencePath+"/item/"+value.id,size:"xs","aria-label":"Go to content in new tab",children:(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"Go to content in new tab",children:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"link"})})}):void 0,!isInCreate&&(ongoing||past)&&isLivestream?(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"You cannot edit the content of an ongoing or past livestream event.",children:(0,jsx_runtime.jsx)(FAIcon.Z,{color:"blue.400",iconStyle:"s",icon:"info-circle"})}):void 0,(0,jsx_runtime.jsxs)(chakra_ui_select_esm.Ph,{value:null!==(_value$id2=null==value?void 0:value.id)&&void 0!==_value$id2?_value$id2:"",onChange:function onChange(ev){var _wholeSchedule$data20;return null==_onChange6?void 0:_onChange6(null===(_wholeSchedule$data20=wholeSchedule.data)||void 0===_wholeSchedule$data20?void 0:_wholeSchedule$data20.content_Item.find((function(room){return room.id===ev.target.value})))},onBlur,isDisabled:!isInCreate&&(ongoing||past)&&isLivestream,ref,maxW:400,children:[(0,jsx_runtime.jsx)("option",{value:"",children:"<None selected>"}),itemOptions]})]})}},{id:ColumnId.Exhibition,header:function ExhibitionHeader(_ref14){var isInCreate=_ref14.isInCreate,onClick=_ref14.onClick,sortDir=_ref14.sortDir;return isInCreate?(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Exhibition (optional)"}):(0,jsx_runtime.jsxs)(chakra_ui_button_esm.zx,{size:"xs",onClick,children:["Exhibition",null!==sortDir?" "+sortDir:void 0]})},get:function get(data){var _wholeSchedule$data21;return null===(_wholeSchedule$data21=wholeSchedule.data)||void 0===_wholeSchedule$data21?void 0:_wholeSchedule$data21.collection_Exhibition.find((function(exhibition){return exhibition.id===data.exhibitionId}))},set:function set(record,value){record.exhibitionId=null==value?void 0:value.id},sortType:function sortType(rowA,rowB){return rowA&&rowB?rowA.name.localeCompare(rowB.name):rowA?1:rowB?-1:0},filterFn:function filterFn(rows,filterValue){return""===filterValue?rows.filter((function(row){return!row.exhibitionId})):rows.filter((function(row){var _ref15,_wholeSchedule$data22,_wholeSchedule$data23;return null!==(_ref15=row.exhibitionId&&(null===(_wholeSchedule$data22=wholeSchedule.data)||void 0===_wholeSchedule$data22||null===(_wholeSchedule$data23=_wholeSchedule$data22.collection_Exhibition.find((function(exhibition){return exhibition.id===row.exhibitionId})))||void 0===_wholeSchedule$data23?void 0:_wholeSchedule$data23.name.toLowerCase().includes(filterValue.toLowerCase())))&&void 0!==_ref15&&_ref15}))},filterEl:CRUDComponents.Oe,cell:function ExhibitionCell(_ref16){var _value$id3,value=_ref16.value,_onChange7=_ref16.onChange,onBlur=_ref16.onBlur,ref=_ref16.ref;return(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{children:[value?(0,jsx_runtime.jsx)(LinkButton.Qj,{linkProps:{target:"_blank"},to:conferencePath+"/exhibition/"+value.id,size:"xs","aria-label":"Go to exhibition in new tab",children:(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"Go to exhibition in new tab",children:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"link"})})}):void 0,(0,jsx_runtime.jsxs)(chakra_ui_select_esm.Ph,{value:null!==(_value$id3=null==value?void 0:value.id)&&void 0!==_value$id3?_value$id3:"",onChange:function onChange(ev){var _wholeSchedule$data24;return null==_onChange7?void 0:_onChange7(null===(_wholeSchedule$data24=wholeSchedule.data)||void 0===_wholeSchedule$data24?void 0:_wholeSchedule$data24.collection_Exhibition.find((function(room){return room.id===ev.target.value})))},onBlur,ref,maxW:400,children:[(0,jsx_runtime.jsx)("option",{value:"",children:"<None selected>"}),exhibitionOptions]})]})}},{id:ColumnId.ShufflePeriod,header:function ShufflePeriodHeader(_ref17){var isInCreate=_ref17.isInCreate,onClick=_ref17.onClick,sortDir=_ref17.sortDir;return isInCreate?(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Shuffle Period (optional)"}):(0,jsx_runtime.jsxs)(chakra_ui_button_esm.zx,{size:"xs",onClick,children:["Shuffle Period",null!==sortDir?" "+sortDir:void 0]})},get:function get(data){var _shufflePeriodsRespon3;return null===(_shufflePeriodsRespon3=shufflePeriodsResponse.data)||void 0===_shufflePeriodsRespon3?void 0:_shufflePeriodsRespon3.room_ShufflePeriod.find((function(shufflePeriod){return shufflePeriod.id===data.shufflePeriodId}))},set:function set(record,value){record.shufflePeriodId=null==value?void 0:value.id},sortType:function sortType(rowA,rowB){return rowA&&rowB?rowA.name.localeCompare(rowB.name):rowA?1:rowB?-1:0},filterFn:function filterFn(rows,filterValue){return""===filterValue?rows.filter((function(row){return!row.shufflePeriodId})):rows.filter((function(row){var _ref18,_shufflePeriodsRespon4,_shufflePeriodsRespon5;return null!==(_ref18=row.shufflePeriodId&&(null===(_shufflePeriodsRespon4=shufflePeriodsResponse.data)||void 0===_shufflePeriodsRespon4||null===(_shufflePeriodsRespon5=_shufflePeriodsRespon4.room_ShufflePeriod.find((function(shufflePeriod){return shufflePeriod.id===row.shufflePeriodId})))||void 0===_shufflePeriodsRespon5?void 0:_shufflePeriodsRespon5.name.toLowerCase().includes(filterValue.toLowerCase())))&&void 0!==_ref18&&_ref18}))},filterEl:CRUDComponents.Oe,cell:function ShufflePeriodCell(_ref19){var _value$id4,value=_ref19.value,_onChange8=_ref19.onChange,onBlur=_ref19.onBlur,ref=_ref19.ref;return(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{children:[value?(0,jsx_runtime.jsx)(LinkButton.Qj,{linkProps:{target:"_blank"},to:conferencePath+"/manage/shuffle",size:"xs","aria-label":"Go to shuffle period in new tab",children:(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:"Go to shuffle period in new tab",children:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"link"})})}):void 0,(0,jsx_runtime.jsxs)(chakra_ui_select_esm.Ph,{value:null!==(_value$id4=null==value?void 0:value.id)&&void 0!==_value$id4?_value$id4:"",onChange:function onChange(ev){var _shufflePeriodsRespon6;return null==_onChange8?void 0:_onChange8(null===(_shufflePeriodsRespon6=shufflePeriodsResponse.data)||void 0===_shufflePeriodsRespon6?void 0:_shufflePeriodsRespon6.room_ShufflePeriod.find((function(room){return room.id===ev.target.value})))},onBlur,ref,maxW:400,children:[(0,jsx_runtime.jsx)("option",{value:"",children:"<None selected>"}),shufflePeriodOptions]})]})}},{id:ColumnId.EnableRecording,header:function EnableRecordingHeader(_ref20){var isInCreate=_ref20.isInCreate,onClick=_ref20.onClick,sortDir=_ref20.sortDir;return isInCreate?(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Recorded?"}):(0,jsx_runtime.jsxs)(chakra_ui_button_esm.zx,{size:"xs",onClick,h:"auto",py:1,children:["Recorded?",null!==sortDir?" "+sortDir:void 0]})},get:function get(data){var _data$enableRecording;return null!==(_data$enableRecording=data.enableRecording)&&void 0!==_data$enableRecording&&_data$enableRecording},set:function set(data,value){data.enableRecording=value},sort:function sort(x,y){return x&&y?0:x?-1:y?1:0},filterFn:function filterFn(rows,filterValue){return rows.filter((function(row){return!!row.enableRecording===filterValue}))},filterEl:CRUDComponents.DV,cell:function EnableRecordingCell(_ref21){var value=_ref21.value,_onChange9=_ref21.onChange,onBlur=_ref21.onBlur,ref=_ref21.ref;return(0,jsx_runtime.jsx)(chakra_ui_layout_esm.M5,{children:(0,jsx_runtime.jsx)(chakra_ui_checkbox_esm.XZ,{isChecked:null!=value&&value,onChange:function onChange(ev){return null==_onChange9?void 0:_onChange9(ev.target.checked)},onBlur,ref})})}},{id:ColumnId.AutomaticParticipationSurvey,header:function AutomaticParticipationSurveyHeader(_ref22){var isInCreate=_ref22.isInCreate,onClick=_ref22.onClick,sortDir=_ref22.sortDir;return isInCreate?(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Participation survey?"}):(0,jsx_runtime.jsxs)(chakra_ui_button_esm.zx,{size:"xs",onClick,h:"auto",py:1,children:["Participation survey?",null!==sortDir?" "+sortDir:void 0]})},get:function get(data){var _data$automaticPartic;return null!==(_data$automaticPartic=data.automaticParticipationSurvey)&&void 0!==_data$automaticPartic&&_data$automaticPartic},set:function set(data,value){data.automaticParticipationSurvey=value},sort:function sort(x,y){return x&&y?0:x?-1:y?1:0},filterFn:function filterFn(rows,filterValue){return rows.filter((function(row){return!!row.automaticParticipationSurvey===filterValue}))},filterEl:CRUDComponents.DV,cell:function AutomaticParticipationSurveyCell(_ref23){var value=_ref23.value,_onChange10=_ref23.onChange,onBlur=_ref23.onBlur,ref=_ref23.ref;return(0,jsx_runtime.jsx)(chakra_ui_layout_esm.M5,{children:(0,jsx_runtime.jsx)(chakra_ui_checkbox_esm.XZ,{isChecked:null!=value&&value,onChange:function onChange(ev){return null==_onChange10?void 0:_onChange10(ev.target.checked)},onBlur,ref})})}}]}),[allowOngoingEventCreation,null===(_wholeSchedule$data25=wholeSchedule.data)||void 0===_wholeSchedule$data25?void 0:_wholeSchedule$data25.room_Room,null===(_wholeSchedule$data26=wholeSchedule.data)||void 0===_wholeSchedule$data26?void 0:_wholeSchedule$data26.content_Item,null===(_wholeSchedule$data27=wholeSchedule.data)||void 0===_wholeSchedule$data27?void 0:_wholeSchedule$data27.collection_Exhibition,roomOptions,roomModeOptions,itemOptions,exhibitionOptions,null===(_shufflePeriodsRespon7=shufflePeriodsResponse.data)||void 0===_shufflePeriodsRespon7?void 0:_shufflePeriodsRespon7.room_ShufflePeriod,shufflePeriodOptions,conferencePath]),yellow=(0,chakra_ui_color_mode_esm.ff)("yellow.300","yellow.700"),row=(0,react.useMemo)((function(){return{getKey:function getKey(record){return record.id},colour:function colour(record){return rowWarning(record)?yellow:void 0},warning:function warning(record){return rowWarning(record)},invalid:function invalid(record,isNew,dependentData){var start=record.scheduledStartTime?Date.parse(record.scheduledStartTime):Date.now(),end=record.scheduledEndTime?Date.parse(record.scheduledEndTime):start+3e5,now=Date.now(),ongoing=isOngoing(now,594e3,24e4,start,end)&&!allowOngoingEventCreation,past=end<now-24e4,isLivestream=record.modeName===graphql.kdg.Livestream;if(isNew&&isLivestream&&(ongoing||past))return{reason:"Cannot create a livestream event that is already ongoing or in the past.",columnId:ColumnId.StartTime};if(!record.name&&!record.itemId&&!record.exhibitionId)return{reason:"Event must have a name, content or exhibition.",columnId:ColumnId.Name};if(record.roomId&&ManageSchedule_toConsumableArray(dependentData.entries()).filter((function(_ref24){var _x$ColumnId$Room,_ref25=ManageSchedule_slicedToArray(_ref24,2),id=_ref25[0];return(null===(_x$ColumnId$Room=_ref25[1][ColumnId.Room])||void 0===_x$ColumnId$Room?void 0:_x$ColumnId$Room.id)===record.roomId&&id!==record.id})).some((function(_ref26){var _ref27=ManageSchedule_slicedToArray(_ref26,2),event=(_ref27[0],_ref27[1]),startE=event.scheduledStartTime.getTime(),endE=event.scheduledEndTime.getTime();return function areOverlapping(start1,end1,start2,end2){return start1<end2&&start2<end1}(start,end,startE,endE)})))return{reason:"Events in a room cannot overlap.",columnId:ColumnId.StartTime};return!1},canSelect:function canSelect(record){var start=record.scheduledStartTime?Date.parse(record.scheduledStartTime):Date.now(),end=record.scheduledEndTime?Date.parse(record.scheduledEndTime):start+3e5,ongoing=isOngoing(Date.now(),3e5,24e4,start,end)&&!allowOngoingEventCreation,isLivestream=!!record.modeName&&record.modeName===graphql.kdg.Livestream;return!ongoing||!isLivestream||"Cannot delete an ongoing livestream event."},canDelete:function canDelete(record){var start=record.scheduledStartTime?Date.parse(record.scheduledStartTime):Date.now(),end=record.scheduledEndTime?Date.parse(record.scheduledEndTime):start+3e5,ongoing=isOngoing(Date.now(),3e5,24e4,start,end)&&!allowOngoingEventCreation,isLivestream=!!record.modeName&&record.modeName===graphql.kdg.Livestream;return!ongoing||!isLivestream||"Cannot delete an ongoing livestream event."},pages:{defaultToLast:!1}}}),[allowOngoingEventCreation,yellow]),localTimeZone=(0,react.useMemo)((function(){return Intl.DateTimeFormat().resolvedOptions().timeZone}),[]),grey=(0,chakra_ui_color_mode_esm.ff)("gray.200","gray.600"),forceReloadRef=(0,react.useRef)((function(){}));(0,react.useEffect)((function(){var _forceReloadRef$curre;(insertEventResponse.error||updateEventResponse.error||deleteEventsResponse.error)&&(null===(_forceReloadRef$curre=forceReloadRef.current)||void 0===_forceReloadRef$curre||_forceReloadRef$curre.call(forceReloadRef))}),[deleteEventsResponse.error,insertEventResponse.error,updateEventResponse.error]);var edit=(0,react.useMemo)((function(){return{open:function open(key){var _wholeSchedule$data28,idx=null===(_wholeSchedule$data28=wholeSchedule.data)||void 0===_wholeSchedule$data28?void 0:_wholeSchedule$data28.schedule_Event.findIndex((function(event){return event.id===key})),newIdx=void 0!==idx&&-1!==idx?idx:null;setEditingIndex(newIdx),null!==newIdx?onSecondaryPanelOpen():_onSecondaryPanelClose()}}}),[_onSecondaryPanelClose,onSecondaryPanelOpen,null===(_wholeSchedule$data29=wholeSchedule.data)||void 0===_wholeSchedule$data29?void 0:_wholeSchedule$data29.schedule_Event]),insert=(0,react.useMemo)((function(){return roomOptions&&roomOptions.length>0?{ongoing:insertEventResponse.fetching,generateDefaults:function generateDefaults(){return{id:(0,v4.Z)(),conferenceId:conference.id,modeName:graphql.kdg.VideoChat,name:"Innominate event",roomId:roomOptions[0].props.value,scheduledStartTime:luxon.ou.local().plus({minutes:10}).endOf("hour").plus({milliseconds:1}).toISO(),scheduledEndTime:luxon.ou.local().plus({minutes:10}).endOf("hour").plus({minutes:5}).toISO(),itemId:null,exhibitionId:null,shufflePeriodId:null,enableRecording:!0,automaticParticipationSurvey:!1,autoPlayElementId:null}},makeWhole:function makeWhole(d){return d},start:function start(record){var _headers;insertEvent({object:{id:record.id,conferenceId:record.conferenceId,modeName:record.modeName,name:record.name,roomId:record.roomId,scheduledStartTime:record.scheduledStartTime,scheduledEndTime:record.scheduledEndTime,itemId:record.itemId,exhibitionId:record.exhibitionId,shufflePeriodId:record.shufflePeriodId,enableRecording:record.enableRecording,automaticParticipationSurvey:record.automaticParticipationSurvey,continuations:record.modeName===graphql.kdg.Livestream&&record.itemId?{data:[{colour:"#4471de",defaultFor:"Presenters",description:"Join the discussion room",isActiveChoice:!1,priority:0,to:{type:"AutoDiscussionRoom",id:null}}]}:void 0}},{fetchOptions:{headers:(_headers={},_headers[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers)},additionalTypenames:["schedule_Event"]})}}:void 0}),[conference.id,insertEvent,insertEventResponse.fetching,roomOptions,subconferenceId]),update=(0,react.useMemo)((function(){return{ongoing:updateEventResponse.fetching,start:function start(record){var _headers2,shiftPresentationsByMinutes=0;if(record.id){var _wholeSchedule$data30,originalEvent=null===(_wholeSchedule$data30=wholeSchedule.data)||void 0===_wholeSchedule$data30?void 0:_wholeSchedule$data30.schedule_Event.find((function(x){return x.id===record.id}));if(!originalEvent)throw new Error("Could not find original event.");record.scheduledStartTime&&originalEvent.scheduledStartTime&&(shiftPresentationsByMinutes=Math.round((Date.parse(record.scheduledStartTime)-Date.parse(originalEvent.scheduledStartTime))/6e4))}var set=Object.assign({},record);delete set.id,delete set.eventPeople,delete set.conferenceId,delete set.subconferenceId,delete set.__typename,updateEvent({eventId:record.id,set,shiftPresentationsByMinutes},{fetchOptions:{headers:(_headers2={},_headers2[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers2)},additionalTypenames:["schedule_Event"]})}}}),[subconferenceId,updateEvent,updateEventResponse.fetching,null===(_wholeSchedule$data31=wholeSchedule.data)||void 0===_wholeSchedule$data31?void 0:_wholeSchedule$data31.schedule_Event]),deleteProps=(0,react.useMemo)((function(){return{ongoing:deleteEventsResponse.fetching,start:function start(keys){var _headers3;deleteEvents({eventIds:keys},{fetchOptions:{headers:(_headers3={},_headers3[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers3)},additionalTypenames:["schedule_Event"]})}}}),[deleteEvents,deleteEventsResponse.fetching,subconferenceId]),batchAddPeopleDisclosure=(0,chakra_ui_hooks_esm.qY)(),pageSizes=(0,react.useMemo)((function(){return[5,10,15,20]}),[]),buttons=(0,react.useMemo)((function(){return[{render:function ImportButton(_selectedData){return(0,jsx_runtime.jsx)(LinkButton.Qj,{colorScheme:"purple",to:conferencePath+"/manage/import/program",children:"Import"})}},{render:function render(_ref28){var selectedData=_ref28.selectedData;function doExport(dataToExport){var _csvURL,csvURL,csvText=papaparse_min_default().unparse(dataToExport.map((function(event){var _wholeSchedule$data$r2,_wholeSchedule$data32,_wholeSchedule$data33,_event$itemId,_wholeSchedule$data$c,_wholeSchedule$data34,_wholeSchedule$data35,_event$exhibitionId,_wholeSchedule$data$c2,_wholeSchedule$data36,_wholeSchedule$data37,_event$shufflePeriodI;return{"Conference Id":event.conferenceId,"Subconference Id":event.subconferenceId,"Event Id":event.id,Start:event.scheduledStartTime?new Date(event.scheduledStartTime).toISOString():null,End:event.scheduledEndTime?new Date(event.scheduledEndTime).toISOString():null,Mode:event.modeName,"Room Id":event.roomId,"Room Name":null!==(_wholeSchedule$data$r2=null===(_wholeSchedule$data32=wholeSchedule.data)||void 0===_wholeSchedule$data32||null===(_wholeSchedule$data33=_wholeSchedule$data32.room_Room.find((function(x){return x.id===event.roomId})))||void 0===_wholeSchedule$data33?void 0:_wholeSchedule$data33.name)&&void 0!==_wholeSchedule$data$r2?_wholeSchedule$data$r2:"",Name:event.name,"Content Id":null!==(_event$itemId=event.itemId)&&void 0!==_event$itemId?_event$itemId:"","Content Title":event.itemId&&null!==(_wholeSchedule$data$c=null===(_wholeSchedule$data34=wholeSchedule.data)||void 0===_wholeSchedule$data34||null===(_wholeSchedule$data35=_wholeSchedule$data34.content_Item.find((function(item){return item.id===event.itemId})))||void 0===_wholeSchedule$data35?void 0:_wholeSchedule$data35.title)&&void 0!==_wholeSchedule$data$c?_wholeSchedule$data$c:"","Exhibition Id":null!==(_event$exhibitionId=event.exhibitionId)&&void 0!==_event$exhibitionId?_event$exhibitionId:"","Exhibition Title":event.exhibitionId&&null!==(_wholeSchedule$data$c2=null===(_wholeSchedule$data36=wholeSchedule.data)||void 0===_wholeSchedule$data36||null===(_wholeSchedule$data37=_wholeSchedule$data36.collection_Exhibition.find((function(exh){return exh.id===event.exhibitionId})))||void 0===_wholeSchedule$data37?void 0:_wholeSchedule$data37.name)&&void 0!==_wholeSchedule$data$c2?_wholeSchedule$data$c2:"","Shuffle Period Id":null!==(_event$shufflePeriodI=event.shufflePeriodId)&&void 0!==_event$shufflePeriodI?_event$shufflePeriodI:"",People:event.eventPeople.map((function(eventPerson){var _wholeSchedule$data38,_person$affiliation,_person$email,person=null===(_wholeSchedule$data38=wholeSchedule.data)||void 0===_wholeSchedule$data38?void 0:_wholeSchedule$data38.collection_ProgramPerson.find((function(person){return person.id===eventPerson.personId}));return eventPerson.personId+" ("+eventPerson.roleName+") ["+(person?person.name+" ("+(null!==(_person$affiliation=person.affiliation)&&void 0!==_person$affiliation?_person$affiliation:"No affiliation")+") <"+(null!==(_person$email=person.email)&&void 0!==_person$email?_person$email:"No email")+"> "+(null!=person&&person.registrantId?"Registered":"Unregistered"):"Person not found")+"]"})),"Registered People":event.eventPeople.flatMap((function(eventPerson){var _wholeSchedule$data39,_person$affiliation2,_person$email2,person=null===(_wholeSchedule$data39=wholeSchedule.data)||void 0===_wholeSchedule$data39?void 0:_wholeSchedule$data39.collection_ProgramPerson.find((function(person){return person.id===eventPerson.personId}));return null!=person&&person.registrantId?[eventPerson.personId+" ("+eventPerson.roleName+") ["+(person?person.name+" ("+(null!==(_person$affiliation2=person.affiliation)&&void 0!==_person$affiliation2?_person$affiliation2:"No affiliation")+") <"+(null!==(_person$email2=person.email)&&void 0!==_person$email2?_person$email2:"No email")+">":"Person not found")+"]"]:[]})),"Participate Link":""+window.location.origin+conferencePath+"/room/"+event.roomId,"Info link":event.itemId?""+window.location.origin+conferencePath+"/item/"+event.itemId:event.exhibitionId?""+window.location.origin+conferencePath+"/exhibition/"+event.exhibitionId:""+window.location.origin+conferencePath+"/schedule","Room Link":""+window.location.origin+conferencePath+"/room/"+event.roomId,"Content Link":event.itemId?""+window.location.origin+conferencePath+"/item/"+event.itemId:"","Exhibition Link":event.exhibitionId?""+window.location.origin+conferencePath+"/exhibition/"+event.exhibitionId:"","Shuffle Link":event.shufflePeriodId?""+window.location.origin+conferencePath+"/shuffle":"","Recording Enabled":event.enableRecording,"Automatic Participation Survey Enabled":event.automaticParticipationSurvey,"Auto Play Element Id":event.autoPlayElementId}})),{columns:["Conference Id","Subconference Id","Event Id","Start","End","Duration (seconds)","Mode","Room Id","Room Name","Name","Content Id","Content Title","Exhibition Id","Exhibition Title","Shuffle Period Id","People","Registered People","Participate Link","Info link","Room Link","Content Link","Exhibition Link","Shuffle Link","Tag Ids","Recording Enabled","Automatic Participation Survey Enabled","Auto Play Element Id"]}),csvData=new Blob([csvText],{type:"text/csv;charset=utf-8;"}),now=new Date,fileName=now.getFullYear()+"-"+(now.getMonth()+1).toString().padStart(2,"0")+"-"+now.getDate().toString().padStart(2,"0")+"T"+now.getHours().toString().padStart(2,"0")+"-"+now.getMinutes().toString().padStart(2,"0")+" - Midspace Schedule.csv";csvURL=window.URL.createObjectURL(csvData);var tempLink=document.createElement("a");tempLink.href=null!==(_csvURL=csvURL)&&void 0!==_csvURL?_csvURL:"",tempLink.setAttribute("download",fileName),tempLink.click()}var _wholeSchedule$data41,tooltip=function tooltip(filler){return"Exports "+filler+"."};return 0===selectedData.length?(0,jsx_runtime.jsxs)(chakra_ui_menu_esm.v2,{children:[(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:tooltip("all events (from a chosen room)"),children:(0,jsx_runtime.jsx)(chakra_ui_menu_esm.j2,{as:chakra_ui_button_esm.zx,colorScheme:"purple",rightIcon:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.ChevronDownIcon,{}),children:"Export"})}),(0,jsx_runtime.jsxs)(chakra_ui_menu_esm.qy,{maxH:"400px",overflowY:"auto",children:[(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{onClick:function onClick(){var _wholeSchedule$data40;null!==(_wholeSchedule$data40=wholeSchedule.data)&&void 0!==_wholeSchedule$data40&&_wholeSchedule$data40.schedule_Event&&doExport(wholeSchedule.data.schedule_Event)},children:"All rooms"}),(0,jsx_runtime.jsx)(chakra_ui_menu_esm.kS,{children:null===(_wholeSchedule$data41=wholeSchedule.data)||void 0===_wholeSchedule$data41?void 0:_wholeSchedule$data41.room_Room.filter((function(room){return room.isProgramRoom})).map((function(room){return(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{onClick:function onClick(){var _wholeSchedule$data42;null!==(_wholeSchedule$data42=wholeSchedule.data)&&void 0!==_wholeSchedule$data42&&_wholeSchedule$data42.schedule_Event&&doExport(wholeSchedule.data.schedule_Event.filter((function(event){return event.roomId===room.id})))},children:room.name},room.id)}))})]})]}):(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:tooltip("selected events"),children:(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{children:(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"purple",isDisabled:0===selectedData.length,onClick:function onClick(){return doExport(selectedData)},children:"Export"})})})}}]}),[null===(_wholeSchedule$data43=wholeSchedule.data)||void 0===_wholeSchedule$data43?void 0:_wholeSchedule$data43.room_Room,null===(_wholeSchedule$data44=wholeSchedule.data)||void 0===_wholeSchedule$data44?void 0:_wholeSchedule$data44.content_Item,null===(_wholeSchedule$data45=wholeSchedule.data)||void 0===_wholeSchedule$data45?void 0:_wholeSchedule$data45.collection_Exhibition,null===(_wholeSchedule$data46=wholeSchedule.data)||void 0===_wholeSchedule$data46?void 0:_wholeSchedule$data46.schedule_Event,null===(_wholeSchedule$data47=wholeSchedule.data)||void 0===_wholeSchedule$data47?void 0:_wholeSchedule$data47.collection_ProgramPerson,conferencePath]);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{flexWrap:"wrap",maxW:"100%",justifyContent:"center",gridRowGap:2,children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.M5,{borderStyle:"solid",borderWidth:1,borderColor:grey,borderRadius:5,p:2,children:[(0,jsx_runtime.jsx)(FAIcon.Z,{icon:"clock",iconStyle:"s",mr:2}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xv,{as:"span",children:["Timezone: ",localTimeZone]})]}),(0,jsx_runtime.jsx)(LinkButton.Qj,{linkProps:{m:"3px"},to:conferencePath+"/manage/rooms",colorScheme:"yellow",children:"Manage Rooms"}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{onClick:batchAddPeopleDisclosure.onOpen,children:"Add people to events (batch)"})]}),(0,jsx_runtime.jsxs)(chakra_ui_visually_hidden_esm.TX,{children:["Timezone is ",localTimeZone]}),null!==(_wholeSchedule$data48=wholeSchedule.data)&&void 0!==_wholeSchedule$data48&&_wholeSchedule$data48.room_Room&&0===wholeSchedule.data.room_Room.length?(0,jsx_runtime.jsxs)(chakra_ui_alert_esm.bZ,{status:"warning",children:[(0,jsx_runtime.jsx)(chakra_ui_alert_esm.zM,{}),(0,jsx_runtime.jsx)(chakra_ui_alert_esm.Cd,{children:"No rooms"}),(0,jsx_runtime.jsx)(chakra_ui_alert_esm.X,{children:"Please create a room first."})]}):void 0,(0,jsx_runtime.jsx)(CRUDTable2.Z,{tableUniqueName:"ManageConferenceSchedule",data:!wholeSchedule.fetching&&(null!==(_wholeSchedule$data49=wholeSchedule.data)&&void 0!==_wholeSchedule$data49&&_wholeSchedule$data49.schedule_Event?data:null),columns,row,edit,insert,update,delete:deleteProps,pageSizes,alert:insertEventResponse.error||updateEventResponse.error||deleteEventsResponse.error?{status:"error",title:"Error saving changes",description:null!==(_extractActualError=(0,ExtractActualError.Z)(null!==(_ref29=null!==(_insertEventResponse$=insertEventResponse.error)&&void 0!==_insertEventResponse$?_insertEventResponse$:updateEventResponse.error)&&void 0!==_ref29?_ref29:deleteEventsResponse.error))&&void 0!==_extractActualError?_extractActualError:"Unknown error"}:void 0,forceReload:forceReloadRef,buttons}),(0,jsx_runtime.jsx)(EventSecondaryEditor,{yellowC:yellow,programPeople:null!==(_wholeSchedule$data$c3=null===(_wholeSchedule$data50=wholeSchedule.data)||void 0===_wholeSchedule$data50?void 0:_wholeSchedule$data50.collection_ProgramPerson)&&void 0!==_wholeSchedule$data$c3?_wholeSchedule$data$c3:[],events:null!==(_wholeSchedule$data$s2=null===(_wholeSchedule$data51=wholeSchedule.data)||void 0===_wholeSchedule$data51?void 0:_wholeSchedule$data51.schedule_Event)&&void 0!==_wholeSchedule$data$s2?_wholeSchedule$data$s2:[],index:editingIndex,isSecondaryPanelOpen,onSecondaryPanelClose:function onSecondaryPanelClose(){var _forceReloadRef$curre2;_onSecondaryPanelClose(),setEditingIndex(null),null===(_forceReloadRef$curre2=forceReloadRef.current)||void 0===_forceReloadRef$curre2||_forceReloadRef$curre2.call(forceReloadRef)}}),(0,jsx_runtime.jsx)(BatchAddEventPeople,Object.assign({events:data,rooms:null!==(_wholeSchedule$data$r3=null===(_wholeSchedule$data52=wholeSchedule.data)||void 0===_wholeSchedule$data52?void 0:_wholeSchedule$data52.room_Room)&&void 0!==_wholeSchedule$data$r3?_wholeSchedule$data$r3:[]},batchAddPeopleDisclosure))]})}function ManageSchedule(){return(0,jsx_runtime.jsx)(DashboardPage.Y,{title:"Schedule",children:(0,jsx_runtime.jsx)(EditableScheduleTable,{})})}function EventSecondaryEditor(_ref30){var _event$id,_event$itemId2,events=_ref30.events,programPeople=_ref30.programPeople,isSecondaryPanelOpen=_ref30.isSecondaryPanelOpen,onSecondaryPanelClose=_ref30.onSecondaryPanelClose,index=_ref30.index,yellowC=_ref30.yellowC,event=null!==index?events[index]:null,_useClipboard=(0,chakra_ui_hooks_esm.VP)(null!==(_event$id=null==event?void 0:event.id)&&void 0!==_event$id?_event$id:""),onCopyEventId=_useClipboard.onCopy,hasCopiedEventId=_useClipboard.hasCopied,_useClipboard2=(0,chakra_ui_hooks_esm.VP)(null!==(_event$itemId2=null==event?void 0:event.itemId)&&void 0!==_event$itemId2?_event$itemId2:""),onCopyItemId=_useClipboard2.onCopy,hasCopiedItemId=_useClipboard2.hasCopied;return(0,jsx_runtime.jsx)(chakra_ui_modal_esm.dy,{isOpen:isSecondaryPanelOpen,placement:"right",onClose:onSecondaryPanelClose,size:"lg",children:(0,jsx_runtime.jsx)(chakra_ui_modal_esm.P1,{children:(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.sc,{children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.cC,{}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.OX,{pb:0,pr:"3em",children:event?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xv,{fontSize:"lg",overflow:"wrap",children:["Edit: ",event.name]}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xv,{fontSize:"xs",mt:2,children:["Event: ",(0,jsx_runtime.jsx)(chakra_ui_layout_esm.EK,{fontSize:"xs",children:event.id}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{onClick:onCopyEventId,size:"xs",ml:"auto",variant:"ghost",p:0,h:"auto",minH:0,"aria-label":"Copy event id",children:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:hasCopiedEventId?"check-circle":"clipboard",m:0,p:0})})]}),event.itemId?(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xv,{fontSize:"xs",mt:1,children:["Item:",(0,jsx_runtime.jsx)(chakra_ui_layout_esm.EK,{fontSize:"xs",children:event.itemId}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{onClick:onCopyItemId,size:"xs",ml:"auto",variant:"ghost",p:0,h:"auto",minH:0,"aria-label":"Copy item id",children:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:hasCopiedItemId?"check-circle":"clipboard",m:0,p:0})})]}):void 0]}):"No event"}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.Ng,{children:event?(0,jsx_runtime.jsxs)(chakra_ui_accordion_esm.UQ,{defaultIndex:[0],children:[(0,jsx_runtime.jsxs)(chakra_ui_accordion_esm.Qd,{children:[(0,jsx_runtime.jsxs)(chakra_ui_accordion_esm.KF,{children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{flex:"1",textAlign:"left",children:"People"}),(0,jsx_runtime.jsx)(chakra_ui_accordion_esm.XE,{})]}),(0,jsx_runtime.jsx)(chakra_ui_accordion_esm.Hk,{children:(0,jsx_runtime.jsx)(EventPeopleEditorModal,{yellowC,event,programPeople})})]},"people"),(0,jsx_runtime.jsxs)(chakra_ui_accordion_esm.Qd,{children:[(0,jsx_runtime.jsxs)(chakra_ui_accordion_esm.KF,{children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{flex:"1",textAlign:"left",children:"Continuations"}),(0,jsx_runtime.jsx)(chakra_ui_accordion_esm.XE,{})]}),(0,jsx_runtime.jsx)(chakra_ui_accordion_esm.Hk,{children:(0,jsx_runtime.jsx)(ContinuationsEditor.Z,{from:{eventId:event.id},itemId:event.itemId})})]},"continuations"),(0,jsx_runtime.jsxs)(chakra_ui_accordion_esm.Qd,{children:[(0,jsx_runtime.jsxs)(chakra_ui_accordion_esm.KF,{children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{flex:"1",textAlign:"left",children:"Embed StreamText.Net (CART)"}),(0,jsx_runtime.jsx)(chakra_ui_accordion_esm.XE,{})]}),(0,jsx_runtime.jsx)(chakra_ui_accordion_esm.Hk,{children:(0,jsx_runtime.jsx)(EditStreamTextIntegration,{eventId:event.id})})]},"streamtext")]}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"No event found."})})]})})})}function EventPeopleEditorModal(_ref31){var event=_ref31.event,programPeople=_ref31.programPeople,yellowC=_ref31.yellowC,_useDisclosure2=(0,chakra_ui_hooks_esm.qY)(),isOpen=_useDisclosure2.isOpen,onOpen=_useDisclosure2.onOpen,onClose=_useDisclosure2.onClose;return(0,jsx_runtime.jsx)(EventProgramPersonsModal,{yellow:yellowC,isOpen,onOpen,onClose,event,programPeople})}(0,urql_core.Ps)(ManageSchedule_templateObject||(ManageSchedule_templateObject=function ManageSchedule_taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(["\n    fragment RoomInfo on room_Room {\n        capacity\n        conferenceId\n        subconferenceId\n        id\n        name\n        priority\n        itemId\n        managementModeName\n        isProgramRoom\n    }\n\n    fragment ElementInfo on content_Element {\n        conferenceId\n        subconferenceId\n        itemId\n        typeName\n        data\n        id\n        isHidden\n        layoutData\n        name\n        uploadsRemaining\n    }\n\n    fragment ProgramPersonInfo on collection_ProgramPerson {\n        id\n        conferenceId\n        subconferenceId\n        name\n        affiliation\n        email\n        registrantId\n    }\n\n    fragment ItemTagInfo on content_ItemTag {\n        id\n        tagId\n        itemId\n    }\n\n    fragment ItemExhibitionInfo on content_ItemExhibition {\n        id\n        itemId\n        exhibitionId\n        priority\n        layout\n    }\n\n    fragment ItemPersonInfo on content_ItemProgramPerson {\n        id\n        itemId\n        personId\n        priority\n        roleName\n    }\n\n    fragment ItemFullNestedInfo on content_Item {\n        id\n        conferenceId\n        subconferenceId\n        typeName\n        title\n        shortTitle\n        elements {\n            ...ElementInfo\n        }\n        itemTags {\n            ...ItemTagInfo\n        }\n        itemExhibitions {\n            ...ItemExhibitionInfo\n        }\n        itemPeople {\n            ...ItemPersonInfo\n        }\n        room {\n            id\n            created_at\n        }\n    }\n\n    fragment TagInfo on collection_Tag {\n        id\n        conferenceId\n        subconferenceId\n        colour\n        name\n        priority\n    }\n\n    fragment ExhibitionInfo on collection_Exhibition {\n        id\n        conferenceId\n        subconferenceId\n        colour\n        name\n        priority\n        isHidden\n    }\n\n    query SelectWholeSchedule($conferenceId: uuid!, $subconferenceCond: uuid_comparison_exp!) {\n        room_Room(\n            where: {\n                conferenceId: { _eq: $conferenceId }\n                subconferenceId: $subconferenceCond\n                managementModeName: { _in: [PUBLIC, PRIVATE] }\n            }\n        ) {\n            ...RoomInfo\n        }\n        schedule_Event(\n            where: {\n                conferenceId: { _eq: $conferenceId }\n                subconferenceId: $subconferenceCond\n                sessionEventId: { _is_null: true }\n            }\n            order_by: [{ scheduledStartTime: asc }, { scheduledEndTime: asc }]\n        ) {\n            ...EventInfo\n        }\n        collection_Tag(where: { conferenceId: { _eq: $conferenceId }, subconferenceId: $subconferenceCond }) {\n            ...TagInfo\n        }\n        collection_Exhibition(where: { conferenceId: { _eq: $conferenceId }, subconferenceId: $subconferenceCond }) {\n            ...ExhibitionInfo\n        }\n        content_Item(where: { conferenceId: { _eq: $conferenceId }, subconferenceId: $subconferenceCond }) {\n            ...ItemFullNestedInfo\n        }\n        collection_ProgramPerson(where: { conferenceId: { _eq: $conferenceId }, subconferenceId: $subconferenceCond }) {\n            ...ProgramPersonInfo\n        }\n    }\n\n    query ManageSchedule_ShufflePeriods(\n        $conferenceId: uuid!\n        $subconferenceCond: uuid_comparison_exp!\n        $now: timestamptz!\n    ) {\n        room_ShufflePeriod(\n            where: { conferenceId: { _eq: $conferenceId }, subconferenceId: $subconferenceCond, endAt: { _gt: $now } }\n        ) {\n            ...ShufflePeriodInfo\n        }\n    }\n\n    fragment ShufflePeriodInfo on room_ShufflePeriod {\n        id\n        name\n        conferenceId\n        endAt\n    }\n\n    mutation InsertEventInfo($object: schedule_Event_insert_input!) {\n        insert_schedule_Event_one(object: $object) {\n            ...EventInfo\n        }\n    }\n\n    mutation UpdateEventInfo($eventId: uuid!, $set: schedule_Event_set_input!, $shiftPresentationsByMinutes: Int!) {\n        update_schedule_Event_by_pk(pk_columns: { id: $eventId }, _set: $set) {\n            ...EventInfo\n        }\n        schedule_shiftPresentationTimes(args: { sessionId: $eventId, minutes: $shiftPresentationsByMinutes }) {\n            id\n        }\n    }\n\n    mutation DeleteEventInfos($eventIds: [uuid!]!) {\n        delete_schedule_Event(where: { id: { _in: $eventIds } }) {\n            returning {\n                id\n            }\n        }\n    }\n"]))),function(ColumnId){ColumnId.StartTime="scheduledStartTime",ColumnId.EndTime="scheduledEndTime",ColumnId.Room="room",ColumnId.RoomMode="roomMode",ColumnId.Name="name",ColumnId.Content="content",ColumnId.Exhibition="exhibition",ColumnId.ShufflePeriod="shufflePeriod",ColumnId.EnableRecording="enableRecording",ColumnId.AutomaticParticipationSurvey="automaticParticipationSurvey"}(ColumnId||(ColumnId={})),ManageSchedule.displayName="ManageSchedule",EventSecondaryEditor.displayName="EventSecondaryEditor"}}]);