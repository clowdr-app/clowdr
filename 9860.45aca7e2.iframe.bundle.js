/*! For license information please see 9860.45aca7e2.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunk_midspace_frontend=self.webpackChunk_midspace_frontend||[]).push([[9860],{"./src/aspects/Conference/Manage/DashboardPage.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Y:()=>DashboardPage});__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.includes.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.includes.js");var chakra_ui_color_mode_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+color-mode@1.4.3_react@17.0.2/node_modules/@chakra-ui/color-mode/dist/chakra-ui-color-mode.esm.js"),chakra_ui_layout_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+layout@1.7.4_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/layout/dist/chakra-ui-layout.esm.js"),react=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),useTitle=__webpack_require__("./src/aspects/Hooks/useTitle.tsx"),useConference=__webpack_require__("./src/aspects/Conference/useConference.tsx"),chakra_ui_breadcrumb_esm=(__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.find.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.map.js"),__webpack_require__("../node_modules/.pnpm/@chakra-ui+breadcrumb@1.3.4_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/breadcrumb/dist/chakra-ui-breadcrumb.esm.js")),react_router_dom=__webpack_require__("../node_modules/.pnpm/react-router-dom@5.3.0_react@17.0.2/node_modules/react-router-dom/esm/react-router-dom.js"),es=__webpack_require__("../node_modules/.pnpm/use-react-router-breadcrumbs@2.0.2_react-router@5.2.1+react@17.0.2/node_modules/use-react-router-breadcrumbs/dist/es/index.js"),AuthParameters=__webpack_require__("./src/aspects/GQL/AuthParameters.tsx"),jsx_runtime=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");function Breadcrumbs(){var conference=(0,useConference.fk)(),subconferenceId=(0,AuthParameters.h)().subconferenceId,confTitle=(0,react.useMemo)((function(){var _ref,_conference$subconfer;return null!==(_ref=subconferenceId?null===(_conference$subconfer=conference.subconferences.find((function(x){return x.id===subconferenceId})))||void 0===_conference$subconfer?void 0:_conference$subconfer.shortName:void 0)&&void 0!==_ref?_ref:conference.shortName}),[conference.shortName,conference.subconferences,subconferenceId]),routes=(0,react.useMemo)((function(){return[{path:"/conference/:slug/manage",breadcrumb:"Manage "+confTitle},{path:"/c/:slug/manage",breadcrumb:"Manage "+confTitle},{path:"/conference/:slug/manage/export/youtube",breadcrumb:"YouTube"},{path:"/c/:slug/manage/export/youtube",breadcrumb:"YouTube"},{path:"/conference/:slug/manage/export/download-videos",breadcrumb:"Download videos"},{path:"/c/:slug/manage/export/download-videos",breadcrumb:"Download videos"}]}),[confTitle]),breadcrumbs=(0,es.Z)(routes,{excludePaths:["/","/conference","/c","/conference/:slug","/c/:slug"]});return(0,jsx_runtime.jsx)(chakra_ui_breadcrumb_esm.aG,{separator:">",children:breadcrumbs.map((function(breadcrumb){return(0,jsx_runtime.jsx)(chakra_ui_breadcrumb_esm.gN,{isCurrentPage:breadcrumb.key===breadcrumb.location.key,children:(0,jsx_runtime.jsx)(chakra_ui_breadcrumb_esm.At,{as:react_router_dom.rU,to:breadcrumb.key,children:breadcrumb.breadcrumb})},breadcrumb.key)}))})}function DashboardHeaderControls(_ref){var children=_ref.children;return children?(0,jsx_runtime.jsx)(chakra_ui_layout_esm.Ug,{spacing:4,mb:4,children}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{})}Breadcrumbs.displayName="Breadcrumbs";try{DashboardHeaderControls.displayName="DashboardHeaderControls",DashboardHeaderControls.__docgenInfo={description:"",displayName:"DashboardHeaderControls",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/DashboardHeaderControls.tsx#DashboardHeaderControls"]={docgenInfo:DashboardHeaderControls.__docgenInfo,name:"DashboardHeaderControls",path:"src/aspects/Conference/Manage/DashboardHeaderControls.tsx#DashboardHeaderControls"})}catch(__react_docgen_typescript_loader_error){}var SubconferenceSelector=__webpack_require__("./src/aspects/Conference/Manage/Subconferences/SubconferenceSelector.tsx");function DashboardPage(_ref){var title=_ref.title,children=_ref.children,controls=_ref.controls,_ref$stickyHeader=_ref.stickyHeader,stickyHeader=void 0===_ref$stickyHeader||_ref$stickyHeader,_ref$autoOverflow=_ref.autoOverflow,autoOverflow=void 0===_ref$autoOverflow||_ref$autoOverflow,conference=(0,useConference.fk)(),grayBg=(0,chakra_ui_color_mode_esm.ff)("gray.50","gray.900"),grayBorder=(0,chakra_ui_color_mode_esm.ff)("gray.300","gray.600"),titleEl=(0,useTitle.Z)(title.includes(conference.shortName)?title:title+" - "+conference.shortName);return(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.kC,{flexDir:"column",w:{base:"100%",xl:"80%"},px:[2,2,4],children:[titleEl,(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{position:stickyHeader?"sticky":void 0,top:0,left:0,zIndex:1e5,bgColor:grayBg,pt:4,borderBottom:"1px solid",borderBottomColor:grayBorder,children:[(0,jsx_runtime.jsx)(Breadcrumbs,{}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.X6,{id:"page-heading",as:"h1",size:"xl",textAlign:"left",mt:4,mb:4,children:title}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.LZ,{}),(0,jsx_runtime.jsx)(SubconferenceSelector.B,{})]}),(0,jsx_runtime.jsx)(DashboardHeaderControls,{children:controls})]}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.kC,{flexDir:"column",mt:4,w:"100%",overflow:autoOverflow?"auto":void 0,children})]})}DashboardPage.displayName="DashboardPage";try{DashboardPage.displayName="DashboardPage",DashboardPage.__docgenInfo={description:"",displayName:"DashboardPage",props:{title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},stickyHeader:{defaultValue:{value:"true"},description:"",name:"stickyHeader",required:!1,type:{name:"boolean"}},autoOverflow:{defaultValue:{value:"true"},description:"",name:"autoOverflow",required:!1,type:{name:"boolean"}},controls:{defaultValue:null,description:"",name:"controls",required:!1,type:{name:"ReactChild[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/DashboardPage.tsx#DashboardPage"]={docgenInfo:DashboardPage.__docgenInfo,name:"DashboardPage",path:"src/aspects/Conference/Manage/DashboardPage.tsx#DashboardPage"})}catch(__react_docgen_typescript_loader_error){}},"./src/aspects/Conference/Manage/Schedule/ManageScheduleV2.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>ManageScheduleV2});__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.slice.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.is-array.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.description.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.symbol.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.from.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/web.timers.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.promise.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.map.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.assign.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.regexp.to-string.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.date.to-string.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.parse-int.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.date.to-iso-string.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.set.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.map.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.concat.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.filter.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.function.name.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.some.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.find.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.find-index.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.for-each.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/web.dom-collections.for-each.js");var chakra_ui_icons_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+icons@1.1.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/icons/dist/chakra-ui-icons.esm.js"),chakra_ui_hooks_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+hooks@1.8.2_react@17.0.2/node_modules/@chakra-ui/hooks/dist/chakra-ui-hooks.esm.js"),chakra_ui_color_mode_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+color-mode@1.4.3_react@17.0.2/node_modules/@chakra-ui/color-mode/dist/chakra-ui-color-mode.esm.js"),chakra_ui_layout_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+layout@1.7.4_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/layout/dist/chakra-ui-layout.esm.js"),chakra_ui_system_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+system@1.10.3_922a85da57e3646a57465b7970b0de85/node_modules/@chakra-ui/system/dist/chakra-ui-system.esm.js"),chakra_ui_form_control_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+form-control@1.5.6_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/form-control/dist/chakra-ui-form-control.esm.js"),chakra_ui_input_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+input@1.4.1_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/input/dist/chakra-ui-input.esm.js"),chakra_ui_button_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+button@1.5.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/button/dist/chakra-ui-button.esm.js"),chakra_ui_alert_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+alert@1.3.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/alert/dist/chakra-ui-alert.esm.js"),chakra_ui_spinner_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+spinner@1.2.4_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/spinner/dist/chakra-ui-spinner.esm.js"),chakra_ui_select_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+select@1.2.6_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/select/dist/chakra-ui-select.esm.js"),auth=__webpack_require__("../packages/shared/shared-types/build/esm/auth.js"),react=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),urql_es=__webpack_require__("../node_modules/.pnpm/urql@2.1.3_graphql@15.7.2+react@17.0.2/node_modules/urql/dist/urql.es.js"),urql_core=__webpack_require__("../node_modules/.pnpm/@urql+core@2.4.1_graphql@15.7.2/node_modules/@urql/core/dist/urql-core.mjs");var graphql=__webpack_require__("./src/generated/graphql.tsx"),SelectButton=__webpack_require__("./src/aspects/Card/SelectButton.tsx"),DateTimePicker=__webpack_require__("./src/aspects/Chakra/DateTimePicker.tsx"),chakra_ui_tabs_esm=(__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.object.keys.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.index-of.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.every.js"),__webpack_require__("../node_modules/.pnpm/@chakra-ui+tabs@1.6.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/tabs/dist/chakra-ui-tabs.esm.js")),chakra_ui_modal_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+modal@1.10.7_d24435ba52f1f88b08cc54a1f1d4e56f/node_modules/@chakra-ui/modal/dist/chakra-ui-modal.esm.js"),chakra_ui_progress_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+progress@1.2.4_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/progress/dist/chakra-ui-progress.esm.js"),jsx_runtime=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js"),_excluded=["children","className"],_excluded2=["htmlProps","descendants"];function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function Editor(_ref){var isOpen=_ref.isOpen,_onClose=_ref.onClose,isCreate=_ref.isCreate,recordTypeName=_ref.recordTypeName,steps=_ref.steps,initialStepIdx=_ref.initialStepIdx,initialRecord=_ref.initialRecord,isSaving=_ref.isSaving,onSave=_ref.onSave,_useState2=_slicedToArray((0,react.useState)(initialRecord),2),record=_useState2[0],setRecord=_useState2[1],_useState4=_slicedToArray((0,react.useState)(initialStepIdx),2),stepIdx=_useState4[0],setStepIdx=_useState4[1],maxSteps=steps.length,step=steps[stepIdx],leastDestructiveActionRef=(0,react.useRef)(null),loseChangesLeastDestructiveRef=(0,react.useRef)(null),firstInputRefs=(0,react.useMemo)((function(){return steps.map((function(_step){return react.createRef()}))}),[steps]),_useState6=_slicedToArray((0,react.useState)(""),2),saveError=_useState6[0],setSaveError=_useState6[1],saveErrorDisclosure=(0,chakra_ui_hooks_esm.qY)(),_useState8=_slicedToArray((0,react.useState)(steps.map((function(_){return"no error"}))),2),stepValidStates=_useState8[0],setStepValidStates=_useState8[1],clearStepStateRefs=(0,react.useMemo)((function(){for(var result=[],i=0;i<steps.length;i++)result.push(react.createRef());return result}),[steps.length]),_useState10=_slicedToArray((0,react.useState)(!1),2),anyChanges=_useState10[0],setAnyChanges=_useState10[1],loseChangesDisclosure=(0,chakra_ui_hooks_esm.qY)();(0,react.useEffect)((function(){var _leastDestructiveActi;isOpen&&(setStepIdx(initialStepIdx),setRecord(initialRecord),setSaveError(""),setStepValidStates(steps.map((function(_){return"no error"}))),setAnyChanges(!1),saveErrorDisclosure.onClose(),clearStepStateRefs.forEach((function(clear){var _clear$current;return null===(_clear$current=clear.current)||void 0===_clear$current?void 0:_clear$current.call(clear)})),isCreate||null===(_leastDestructiveActi=leastDestructiveActionRef.current)||void 0===_leastDestructiveActi||_leastDestructiveActi.focus())}),[isOpen]),(0,react.useEffect)((function(){var _firstInputRefs$stepI,_firstInputRefs$stepI2;isCreate&&(null===(_firstInputRefs$stepI=firstInputRefs[stepIdx])||void 0===_firstInputRefs$stepI||null===(_firstInputRefs$stepI2=_firstInputRefs$stepI.current)||void 0===_firstInputRefs$stepI2||_firstInputRefs$stepI2.focus())}),[stepIdx]);var tabProps=(0,react.useMemo)((function(){return{index:stepIdx,onChange:setStepIdx,children:void 0,colorScheme:"PrimaryActionButton"}}),[stepIdx]),styles=(0,chakra_ui_system_esm.jC)("Tabs",tabProps),_omitThemingProps=(0,chakra_ui_system_esm.Lr)(tabProps),rest=(_omitThemingProps.children,_omitThemingProps.className,_objectWithoutProperties(_omitThemingProps,_excluded)),_useTabs=(0,chakra_ui_tabs_esm.YE)(rest),descendants=(_useTabs.htmlProps,_useTabs.descendants),ctx=_objectWithoutProperties(_useTabs,_excluded2),context=(0,react.useMemo)((function(){return ctx}),[ctx]),finishOrCancelButton=(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{ref:leastDestructiveActionRef,colorScheme:"PrimaryActionButton",variant:"ghost",fontSize:"110%",isDisabled:isSaving,isLoading:isCreate&&stepIdx<maxSteps-1&&isSaving,onClick:_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var result;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!anyChanges){_context.next=16;break}if(!isCreate){_context.next=13;break}if(stepValidStates.every((function(x){return"no error"===x}))){_context.next=6;break}loseChangesDisclosure.onOpen(),_context.next=11;break;case 6:return setSaveError(""),_context.next=9,onSave(record);case 9:"no error"===(result=_context.sent)?_onClose():(setSaveError(result.error),saveErrorDisclosure.onOpen());case 11:_context.next=14;break;case 13:loseChangesDisclosure.onOpen();case 14:_context.next=17;break;case 16:_onClose();case 17:case"end":return _context.stop()}}),_callee)}))),children:isCreate&&anyChanges?"Finished for now":"Cancel"}),nextOrFinishButton=(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"SecondaryActionButton",variant:"solid",minW:"10em",onClick:_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var result;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(!(isCreate&&stepIdx<maxSteps-1)){_context2.next=4;break}setStepIdx((function(old){return old+1})),_context2.next=9;break;case 4:return setSaveError(""),_context2.next=7,onSave(record);case 7:"no error"===(result=_context2.sent)?_onClose():(setSaveError(result.error),saveErrorDisclosure.onOpen());case 9:case"end":return _context2.stop()}}),_callee2)}))),pr:isCreate?2:void 0,isDisabled:!anyChanges||isSaving||(isCreate?"no error"!==stepValidStates[stepIdx]:!stepValidStates.every((function(x){return"no error"===x}))),isLoading:(!isCreate||stepIdx===maxSteps-1)&&isSaving,children:isCreate?stepIdx===maxSteps-1?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Finished ",(0,jsx_runtime.jsx)(chakra_ui_icons_esm.CheckIcon,{m:2,fontSize:"85%"})]}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Next: ",steps[stepIdx+1].name.toLocaleLowerCase(),(0,jsx_runtime.jsx)(chakra_ui_icons_esm.ChevronRightIcon,{ml:1,fontSize:"125%"})]}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"Save changes"})});return(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.dy,{isOpen,onClose:function onClose(){isSaving||(anyChanges?loseChangesDisclosure.onOpen():_onClose())},placement:"right",size:"lg",initialFocusRef:firstInputRefs[stepIdx],children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.P1,{}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.sc,{children:(0,jsx_runtime.jsx)(chakra_ui_tabs_esm.mE,{value:descendants,children:(0,jsx_runtime.jsxs)(chakra_ui_tabs_esm.X,{value:context,children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.OX,{display:"flex",flexDir:"column",p:0,children:isCreate?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(chakra_ui_progress_esm.Ex,{colorScheme:"blue",value:stepIdx+1,min:0,max:maxSteps,size:"sm"}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.kC,{alignItems:"flex-start",px:12,py:4,children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.X6,{as:"h2",fontSize:"3xl",textAlign:"left",fontWeight:"600",children:[recordTypeName," ",step.name.toLocaleLowerCase()]}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xu,{ml:"auto",fontWeight:"400",children:[(stepIdx+1).toString()," of ",maxSteps.toString()]})]})]}):(0,jsx_runtime.jsx)(chakra_ui_system_esm.Fo,{value:styles,children:(0,jsx_runtime.jsx)(chakra_ui_tabs_esm.td,{px:4,pt:4,children:steps.map((function(step,idx){return(0,jsx_runtime.jsx)(chakra_ui_tabs_esm.OK,{fontSize:"xl",borderBottomWidth:"4px",children:step.name},step.name+"-"+idx)}))})})}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.Ng,{px:12,py:4,children:(0,jsx_runtime.jsx)(chakra_ui_system_esm.Fo,{value:styles,children:(0,jsx_runtime.jsx)(chakra_ui_tabs_esm.nP,{children:steps.map((function(step,idx){return(0,jsx_runtime.jsx)(chakra_ui_tabs_esm.x4,{p:0,children:step.panel({isCreate,isDisabled:isSaving,firstInputRef:firstInputRefs[idx],clearState:clearStepStateRefs[idx],record,updateRecord:setRecord,onValid:function onValid(){setStepValidStates((function(old){var newStates=_toConsumableArray(old);return newStates[idx]="no error",newStates}))},onInvalid:function onInvalid(error){setStepValidStates((function(old){var newStates=_toConsumableArray(old);return newStates[idx]=error,newStates}))},onAnyChange:function onAnyChange(){setAnyChanges(!0)}})},idx)}))})})}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.ze,{shadow:"bottom-popup-light",px:12,py:4,children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{spacing:2,alignItems:"flex-start",w:"100%",children:[saveError.length?(0,jsx_runtime.jsxs)(chakra_ui_alert_esm.bZ,{status:"error",children:[(0,jsx_runtime.jsx)(chakra_ui_alert_esm.zM,{}),(0,jsx_runtime.jsx)(chakra_ui_alert_esm.X,{children:saveError})]}):void 0,(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.kC,{w:"100%",justifyContent:"flex-end",children:[!isCreate||stepIdx<maxSteps-1?finishOrCancelButton:void 0,(0,jsx_runtime.jsxs)(chakra_ui_button_esm.hE,{ml:"auto",isAttached:!0,children:[isCreate&&stepIdx>0?(0,jsx_runtime.jsx)(chakra_ui_button_esm.hU,{colorScheme:"SecondaryActionButton","aria-label":"Previous step",icon:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.ChevronLeftIcon,{fontSize:"115%"}),mr:"1px",onClick:function onClick(){setStepIdx((function(old){return old-1}))},isDisabled:isSaving}):void 0,nextOrFinishButton]})]})]})})]})})}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.aR,{isOpen:loseChangesDisclosure.isOpen,onClose:function onClose(){loseChangesDisclosure.onClose()},leastDestructiveRef:loseChangesLeastDestructiveRef,children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.dh,{}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm._T,{children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.fY,{children:"Discard changes?"}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.lq,{}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.iP,{children:isCreate?"The information is incomplete and cannot be saved yet.":"Are you sure you wish to discard your changes?"}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.xo,{children:(0,jsx_runtime.jsxs)(chakra_ui_button_esm.hE,{children:[(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"PrimaryActionButton",variant:"outline",onClick:function onClick(){loseChangesDisclosure.onClose()},ref:loseChangesLeastDestructiveRef,children:"Continue editing"}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"DestructiveActionButton",onClick:function onClick(){loseChangesDisclosure.onClose(),_onClose()},children:"Discard changes"})]})})]})]})]})}Editor.displayName="Editor";try{Editor.displayName="Editor",Editor.__docgenInfo={description:"",displayName:"Editor",props:{isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},isCreate:{defaultValue:null,description:"",name:"isCreate",required:!0,type:{name:"boolean"}},recordTypeName:{defaultValue:null,description:"",name:"recordTypeName",required:!0,type:{name:"string"}},steps:{defaultValue:null,description:"",name:"steps",required:!0,type:{name:"Step<T>[]"}},initialStepIdx:{defaultValue:null,description:"",name:"initialStepIdx",required:!0,type:{name:"number"}},initialRecord:{defaultValue:null,description:"",name:"initialRecord",required:!0,type:{name:"DeepPartial<T>"}},isSaving:{defaultValue:null,description:"",name:"isSaving",required:!0,type:{name:"boolean"}},onSave:{defaultValue:null,description:"",name:"onSave",required:!0,type:{name:"(record: DeepPartial<T>) => Promise<ValidationState>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/CRUDCards/Editor.tsx#Editor"]={docgenInfo:Editor.__docgenInfo,name:"Editor",path:"src/aspects/CRUDCards/Editor.tsx#Editor"})}catch(__react_docgen_typescript_loader_error){}var _templateObject,AuthParameters=__webpack_require__("./src/aspects/GQL/AuthParameters.tsx"),ExtractActualError=__webpack_require__("./src/aspects/GQL/ExtractActualError.ts"),make_context=__webpack_require__("./src/aspects/GQL/make-context.ts"),useRestorableState=__webpack_require__("./src/aspects/Hooks/useRestorableState.ts"),useConference=__webpack_require__("./src/aspects/Conference/useConference.tsx"),DashboardPage=__webpack_require__("./src/aspects/Conference/Manage/DashboardPage.tsx");function ContentPanel(_ref){var record=_ref.record,isSession=!("sessionEventId"in record&&record.sessionEventId);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Coming soon! For now, please use the Manage Content page to edit your"," ",isSession?"session's":"presentation's"," content."]})}(0,urql_core.Ps)(_templateObject||(_templateObject=function _taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(["\n    fragment ManageSchedule_Element on content_Element {\n        id\n        name\n        data\n        layoutData\n        typeName\n        uploadsRemaining\n        isHidden\n    }\n"])));try{ContentPanel.displayName="ContentPanel",ContentPanel.__docgenInfo={description:"",displayName:"ContentPanel",props:{isCreate:{defaultValue:null,description:"",name:"isCreate",required:!0,type:{name:"boolean"}},isDisabled:{defaultValue:null,description:"",name:"isDisabled",required:!0,type:{name:"boolean"}},firstInputRef:{defaultValue:null,description:"",name:"firstInputRef",required:!0,type:{name:"MutableRefObject<HTMLButtonElement | HTMLInputElement | HTMLSelectElement | null>"}},clearState:{defaultValue:null,description:"",name:"clearState",required:!0,type:{name:"MutableRefObject<(() => void) | null>"}},record:{defaultValue:null,description:"",name:"record",required:!0,type:{name:"DeepPartial<ScheduleEditorRecord>"}},updateRecord:{defaultValue:null,description:"",name:"updateRecord",required:!0,type:{name:"(record: DeepPartial<ScheduleEditorRecord> | ((old: DeepPartial<ScheduleEditorRecord>) => DeepPartial<ScheduleEditorRecord>)) => void"}},onValid:{defaultValue:null,description:"",name:"onValid",required:!0,type:{name:"() => void"}},onInvalid:{defaultValue:null,description:"",name:"onInvalid",required:!0,type:{name:"(error: ValidationError) => void"}},onAnyChange:{defaultValue:null,description:"",name:"onAnyChange",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/Schedule/Components/ContentPanel.tsx#ContentPanel"]={docgenInfo:ContentPanel.__docgenInfo,name:"ContentPanel",path:"src/aspects/Conference/Manage/Schedule/Components/ContentPanel.tsx#ContentPanel"})}catch(__react_docgen_typescript_loader_error){}__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.flat-map.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.unscopables.flat-map.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.date.now.js");var DeleteModal_templateObject,chakra_ui_toast_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+toast@1.5.4_3467197ee0b52af28e4f3b42a3c78b88/node_modules/@chakra-ui/toast/dist/chakra-ui-toast.esm.js"),useRealTime=__webpack_require__("./src/aspects/Hooks/useRealTime.tsx");function DeleteModal_toConsumableArray(arr){return function DeleteModal_arrayWithoutHoles(arr){if(Array.isArray(arr))return DeleteModal_arrayLikeToArray(arr)}(arr)||function DeleteModal_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||DeleteModal_unsupportedIterableToArray(arr)||function DeleteModal_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function DeleteModal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function DeleteModal_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){DeleteModal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){DeleteModal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function DeleteModal_slicedToArray(arr,i){return function DeleteModal_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function DeleteModal_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||DeleteModal_unsupportedIterableToArray(arr,i)||function DeleteModal_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function DeleteModal_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return DeleteModal_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?DeleteModal_arrayLikeToArray(o,minLen):void 0}}function DeleteModal_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function DeleteModal(props){return props.isOpen?(0,jsx_runtime.jsx)(DeleteModalInner,Object.assign({},props)):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{})}function DeleteModalInner(_ref){var _ref4,_ref5,isOpen=_ref.isOpen,_onClose=_ref.onClose,deleteEventIds=_ref.deleteEventIds,deleteEventType=_ref.deleteEventType,toast=(0,chakra_ui_toast_esm.pm)(),subconferenceId=(0,AuthParameters.h)().subconferenceId,context=(0,react.useMemo)((function(){var _makeContext;return(0,make_context.f)(((_makeContext={})[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext))}),[subconferenceId]),client=(0,urql_es.m8)(),deleteSessionsLeastDestructiveActionRef=(0,react.useRef)(null),_useState2=DeleteModal_slicedToArray((0,react.useState)(null),2),startDeleteContentAt=_useState2[0],setStartDeleteContentAt=_useState2[1],_useState4=DeleteModal_slicedToArray((0,react.useState)(null),2),startDeleteEventsAt=_useState4[0],setStartDeleteEventsAt=_useState4[1],now=(0,useRealTime.$)(1e3),_useState6=DeleteModal_slicedToArray((0,react.useState)(!1),2),deletingContent=_useState6[0],setDeletingContent=_useState6[1],_useState8=DeleteModal_slicedToArray((0,react.useState)(!1),2),deletingEvents=_useState8[0],setDeletingEvents=_useState8[1],_useState10=DeleteModal_slicedToArray((0,react.useState)(null),2),error=_useState10[0],setError=_useState10[1];return(0,react.useEffect)((function(){null!==startDeleteContentAt?now-startDeleteContentAt>1e4&&setDeletingContent(!0):null!==startDeleteEventsAt&&now-startDeleteEventsAt>1e4&&setDeletingEvents(!0)}),[now,startDeleteContentAt,startDeleteEventsAt]),(0,react.useEffect)((function(){deletingContent&&DeleteModal_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _idsResponse$data$sch,_idsResponse$data,idsResponse,_extractActualError,itemIds,response2,_extractActualError2,response,_extractActualError3,_e$message;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,client.query(graphql.EIM,{eventIds:deleteEventIds},context).toPromise();case 3:if(!(idsResponse=_context.sent).error){_context.next=6;break}throw null!==(_extractActualError=(0,ExtractActualError.Z)(idsResponse.error))&&void 0!==_extractActualError?_extractActualError:"Unknown error fetching content ids.";case 6:return itemIds=null!==(_idsResponse$data$sch=null===(_idsResponse$data=idsResponse.data)||void 0===_idsResponse$data?void 0:_idsResponse$data.schedule_Event.flatMap((function(x){return[x.itemId].concat(DeleteModal_toConsumableArray(x.presentations.map((function(y){return y.itemId}))))})).filter((function(x){return!!x})))&&void 0!==_idsResponse$data$sch?_idsResponse$data$sch:[],_context.next=9,client.mutation(graphql.AFC,{ids:deleteEventIds},context).toPromise();case 9:if(!(response2=_context.sent).error){_context.next=12;break}throw null!==(_extractActualError2=(0,ExtractActualError.Z)(response2.error))&&void 0!==_extractActualError2?_extractActualError2:"Unknown error deleting events.";case 12:return _context.next=14,client.mutation(graphql.iEx,{itemIds},context).toPromise();case 14:if(!(response=_context.sent).error){_context.next=17;break}throw null!==(_extractActualError3=(0,ExtractActualError.Z)(response.error))&&void 0!==_extractActualError3?_extractActualError3:"Unknown error deleting events.";case 17:setError(null),_onClose(!0),_context.next=24;break;case 21:_context.prev=21,_context.t0=_context.catch(0),setError("string"==typeof _context.t0?_context.t0:null!==(_e$message=_context.t0.message)&&void 0!==_e$message?_e$message:_context.t0.toString());case 24:return _context.prev=24,setDeletingContent(!1),_context.finish(24);case 27:case"end":return _context.stop()}}),_callee,null,[[0,21,24,27]])})))()}),[deletingContent]),(0,react.useEffect)((function(){deletingEvents&&DeleteModal_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var response,_extractActualError4,_e$message2;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.prev=0,_context2.next=3,client.mutation(graphql.AFC,{ids:deleteEventIds},context).toPromise();case 3:if(!(response=_context2.sent).error){_context2.next=6;break}throw null!==(_extractActualError4=(0,ExtractActualError.Z)(response.error))&&void 0!==_extractActualError4?_extractActualError4:"Unknown error deleting events.";case 6:setError(null),_onClose(!0),_context2.next=13;break;case 10:_context2.prev=10,_context2.t0=_context2.catch(0),setError("string"==typeof _context2.t0?_context2.t0:null!==(_e$message2=_context2.t0.message)&&void 0!==_e$message2?_e$message2:_context2.t0.toString());case 13:return _context2.prev=13,setDeletingContent(!1),_context2.finish(13);case 16:case"end":return _context2.stop()}}),_callee2,null,[[0,10,13,16]])})))()}),[deletingEvents]),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.aR,{isOpen,onClose:function onClose(){return _onClose(!1)},leastDestructiveRef:deleteSessionsLeastDestructiveActionRef,size:"2xl",children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.dh,{}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm._T,{children:[(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.fY,{children:["Delete ",deleteEventIds.length," ",deleteEventType,1!==deleteEventIds.length?"s":"","?"]}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.lq,{}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.iP,{children:["This cannot be undone. ",deleteEventIds.length," event",1===deleteEventIds.length?"":"s"," will be deleted."]}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.xo,{children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{w:"100%",alignItems:"flex-end",children:[null!==error?(0,jsx_runtime.jsx)(chakra_ui_alert_esm.bZ,{children:(0,jsx_runtime.jsx)(chakra_ui_alert_esm.X,{children:error})}):void 0,(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{ref:deleteSessionsLeastDestructiveActionRef,colorScheme:"blue",variant:null!==startDeleteContentAt||null!==startDeleteEventsAt?"solid":"outline",onClick:function onClick(){null===startDeleteContentAt&&null===startDeleteEventsAt||(toast({status:"info",title:"Delete canceled",isClosable:!0,duration:5e3,position:"top"}),setDeletingContent(!1),setDeletingEvents(!1)),_onClose(!1)},isDisabled:deletingContent||deletingEvents,children:deletingContent||deletingEvents?"Deleting... ("+Math.floor(Math.abs(10-(now-(null!==(_ref4=null!=startDeleteContentAt?startDeleteContentAt:startDeleteEventsAt)&&void 0!==_ref4?_ref4:0))/1e3))+")":null!==startDeleteContentAt||null!==startDeleteEventsAt?"Made a mistake? Click to cancel ("+Math.floor(Math.abs(10-(now-(null!==(_ref5=null!=startDeleteContentAt?startDeleteContentAt:startDeleteEventsAt)&&void 0!==_ref5?_ref5:0))/1e3))+")":"Cancel"}),(0,jsx_runtime.jsxs)(chakra_ui_button_esm.zx,{colorScheme:"DestructiveActionButton",variant:"outline",onClick:function onClick(){setStartDeleteContentAt(Date.now())},isLoading:deletingContent,isDisabled:deletingContent||null!==startDeleteContentAt||null!==startDeleteEventsAt,children:["Delete ","session"===deleteEventType?"sessions and presentations, ":"presentations, ","including content"]}),(0,jsx_runtime.jsxs)(chakra_ui_button_esm.zx,{colorScheme:"DestructiveActionButton",variant:"solid",onClick:function onClick(){setStartDeleteEventsAt(Date.now())},isLoading:deletingEvents,isDisabled:deletingContent||null!==startDeleteContentAt||null!==startDeleteEventsAt,children:["Delete ","session"===deleteEventType?"sessions and presentations ":"presentations "," ","only"]})]})})]})]})}(0,urql_core.Ps)(DeleteModal_templateObject||(DeleteModal_templateObject=function DeleteModal_taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(["\n    mutation ManageSchedule_DeleteEvents($ids: [uuid!]!) {\n        delete_schedule_Event(where: { id: { _in: $ids } }) {\n            affected_rows\n        }\n    }\n\n    mutation ManageSchedule_DeleteContent($itemIds: [uuid!]!) {\n        delete_content_Item(where: { id: { _in: $itemIds } }) {\n            affected_rows\n        }\n    }\n\n    query ManageSchedule_GetContentIds($eventIds: [uuid!]!) {\n        schedule_Event(where: { id: { _in: $eventIds } }) {\n            id\n\n            itemId\n            presentations {\n                id\n                itemId\n            }\n        }\n    }\n"]))),DeleteModalInner.displayName="DeleteModalInner";try{DeleteModal.displayName="DeleteModal",DeleteModal.__docgenInfo={description:"",displayName:"DeleteModal",props:{isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"(shouldRefetch: boolean) => void"}},deleteEventIds:{defaultValue:null,description:"",name:"deleteEventIds",required:!0,type:{name:"string[]"}},deleteEventType:{defaultValue:null,description:"",name:"deleteEventType",required:!0,type:{name:"enum",value:[{value:'"presentation"'},{value:'"session"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/Schedule/Components/DeleteModal.tsx#DeleteModal"]={docgenInfo:DeleteModal.__docgenInfo,name:"DeleteModal",path:"src/aspects/Conference/Manage/Schedule/Components/DeleteModal.tsx#DeleteModal"})}catch(__react_docgen_typescript_loader_error){}__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.reduce.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.number.constructor.js");var CreateTagModal_templateObject,DetailsPanel_templateObject,FindExistingContentModal_templateObject,chakra_ui_textarea_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+textarea@1.2.6_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/textarea/dist/chakra-ui-textarea.esm.js"),content=__webpack_require__("../packages/shared/shared-types/build/esm/content.js"),es=__webpack_require__("../node_modules/.pnpm/ramda@0.28.0/node_modules/ramda/es/index.js"),MultiSelect=__webpack_require__("./src/aspects/Chakra/MultiSelect.tsx"),MathUtils=__webpack_require__("./src/aspects/Utils/MathUtils.ts"),chakra_ui_number_input_esm=(__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.trim.js"),__webpack_require__("../node_modules/.pnpm/@chakra-ui+number-input@1.4.2_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/number-input/dist/chakra-ui-number-input.esm.js")),react_color_es=__webpack_require__("../node_modules/.pnpm/react-color@2.19.3_react@17.0.2/node_modules/react-color/es/index.js"),ItemList=__webpack_require__("./src/aspects/Conference/Attend/Content/ItemList.tsx");function CreateTagModal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CreateTagModal_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CreateTagModal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CreateTagModal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function CreateTagModal_slicedToArray(arr,i){return function CreateTagModal_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CreateTagModal_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CreateTagModal_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CreateTagModal_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CreateTagModal_arrayLikeToArray(o,minLen)}(arr,i)||function CreateTagModal_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CreateTagModal_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function CreateTagModal(_ref){var initialName=_ref.initialName,onCreate=_ref.onCreate,isOpen=_ref.isOpen,onClose=_ref.onClose,conference=(0,useConference.fk)(),subconferenceId=(0,AuthParameters.h)().subconferenceId,_useState2=CreateTagModal_slicedToArray((0,react.useState)(initialName),2),name=_useState2[0],setName=_useState2[1],_useRestorableState2=CreateTagModal_slicedToArray((0,useRestorableState.aX)("CreateTagModal_Priority",10,(function(x){return x.toString()}),(function(x){return parseInt(x,10)})),2),priority=_useRestorableState2[0],setPriority=_useRestorableState2[1],_useRestorableState4=CreateTagModal_slicedToArray((0,useRestorableState.aX)("CreateTagModal_Colour","rgba(0,0,0,1)",(function(x){return x}),(function(x){return x})),2),colour=_useRestorableState4[0],setColour=_useRestorableState4[1],_useState4=CreateTagModal_slicedToArray((0,react.useState)(!1),2),nameHasChanged=_useState4[0],setNameHasChanged=_useState4[1],_useState6=CreateTagModal_slicedToArray((0,react.useState)("no error"),2),nameValidation=_useState6[0],setNameValidation=_useState6[1];(0,react.useEffect)((function(){isOpen&&(setName(initialName),setNameHasChanged(initialName.length>0))}),[isOpen]);var tagPreviewElement=function tagPreviewElement(copyNum){return(0,jsx_runtime.jsx)(ItemList.D,{tag:{name:name.length?name:"Preview",priority,colour,id:""},isExpanded:!1,notExpander:!0,withBorder:!0},copyNum)},previewLightBgColour=(0,chakra_ui_color_mode_esm.ff)("AppPage.pageBackground-light","AppPage.pageBackground-dark"),previewDarkBgColour=(0,chakra_ui_color_mode_esm.ff)("AppPage.pageBackground-dark","AppPage.pageBackground-light");(0,react.useEffect)((function(){nameHasChanged?name.length>0?setNameValidation("no error"):setNameValidation({error:"Name is required."}):setNameValidation("no error")}),[name.length,nameHasChanged]);var _useCreateTagModal_Cr2=CreateTagModal_slicedToArray((0,graphql.Pg7)(),2),createTagResponse=_useCreateTagModal_Cr2[0],createTag=_useCreateTagModal_Cr2[1],_useState8=CreateTagModal_slicedToArray((0,react.useState)(null),2),createError=_useState8[0],setCreateError=_useState8[1];return(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.u_,{isOpen,onClose,children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.ZA,{}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.hz,{children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.xB,{children:"Create a tag"}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.fe,{children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{spacing:4,children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.M5,{flexDir:"column",children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{mb:4,children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{p:5,backgroundColor:previewLightBgColour,children:tagPreviewElement(0)}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{p:5,backgroundColor:previewDarkBgColour,children:tagPreviewElement(1)})]})}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{id:"create-tag-name",isInvalid:"no error"!==nameValidation,children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Name"}),(0,jsx_runtime.jsx)(chakra_ui_input_esm.II,{type:"text",value:name,onChange:function onChange(ev){setCreateError(null),setName(ev.target.value),setNameHasChanged(!0)}}),(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.J1,{children:"no error"!==nameValidation?nameValidation.error:"No error"})]}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{id:"create-tag-priority",children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Priority"}),(0,jsx_runtime.jsxs)(chakra_ui_number_input_esm.Y2,{value:priority,onChange:function onChange(_,value){setCreateError(null),setPriority(value)},children:[(0,jsx_runtime.jsx)(chakra_ui_number_input_esm.zu,{}),(0,jsx_runtime.jsxs)(chakra_ui_number_input_esm.Fi,{children:[(0,jsx_runtime.jsx)(chakra_ui_number_input_esm.WQ,{}),(0,jsx_runtime.jsx)(chakra_ui_number_input_esm.Y_,{})]})]}),(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.Q6,{children:"Use priority to order tags. Lower numbers sort first. Tags of equal priority are sorted alphabetically."})]}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Color"}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{color:"black",children:(0,jsx_runtime.jsx)(react_color_es.xS,{color:colour,onChange:function onChange(c){var _c$rgb$a;setCreateError(null),setColour("rgba("+c.rgb.r+","+c.rgb.g+","+c.rgb.b+","+(null!==(_c$rgb$a=c.rgb.a)&&void 0!==_c$rgb$a?_c$rgb$a:0)+")")}})})]})]})}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.mz,{flexDir:"column",alignItems:"flex-end",children:[null!==createError?(0,jsx_runtime.jsxs)(chakra_ui_alert_esm.bZ,{status:"error",mb:4,children:[(0,jsx_runtime.jsx)(chakra_ui_alert_esm.Cd,{children:"Error"}),(0,jsx_runtime.jsx)(chakra_ui_alert_esm.X,{children:createError})]}):void 0,(0,jsx_runtime.jsxs)(chakra_ui_button_esm.hE,{children:[(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"DestructiveActionButton",variant:"outline",onClick:function onClick(){onClose()},isDisabled:createTagResponse.fetching,children:"Cancel"}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"ConfirmButton",onClick:CreateTagModal_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _headers,_result$data,result,_extractActualError;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if("no error"!==nameValidation){_context.next=5;break}return _context.next=3,createTag({object:{conferenceId:conference.id,subconferenceId,name:name.trim(),priority,colour}},{fetchOptions:{headers:(_headers={},_headers[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_headers)}});case 3:result=_context.sent,null!==(_result$data=result.data)&&void 0!==_result$data&&_result$data.insert_collection_Tag_one?(setCreateError(null),onClose(),onCreate(result.data.insert_collection_Tag_one.id)):setCreateError(null!==(_extractActualError=(0,ExtractActualError.Z)(result.error))&&void 0!==_extractActualError?_extractActualError:null);case 5:case"end":return _context.stop()}}),_callee)}))),isDisabled:"no error"!==nameValidation,isLoading:createTagResponse.fetching,children:"Create"})]})]})]})]})}(0,urql_core.Ps)(CreateTagModal_templateObject||(CreateTagModal_templateObject=function CreateTagModal_taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(["\n    mutation CreateTagModal_CreateTag($object: collection_Tag_insert_input!) {\n        insert_collection_Tag_one(object: $object) {\n            id\n        }\n    }\n"]))),CreateTagModal.displayName="CreateTagModal";try{CreateTagModal.displayName="CreateTagModal",CreateTagModal.__docgenInfo={description:"",displayName:"CreateTagModal",props:{initialName:{defaultValue:null,description:"",name:"initialName",required:!0,type:{name:"string"}},onCreate:{defaultValue:null,description:"",name:"onCreate",required:!0,type:{name:"(newTagId: string) => void"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/Schedule/Components/CreateTagModal.tsx#CreateTagModal"]={docgenInfo:CreateTagModal.__docgenInfo,name:"CreateTagModal",path:"src/aspects/Conference/Manage/Schedule/Components/CreateTagModal.tsx#CreateTagModal"})}catch(__react_docgen_typescript_loader_error){}function DetailsPanel_toConsumableArray(arr){return function DetailsPanel_arrayWithoutHoles(arr){if(Array.isArray(arr))return DetailsPanel_arrayLikeToArray(arr)}(arr)||function DetailsPanel_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||DetailsPanel_unsupportedIterableToArray(arr)||function DetailsPanel_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function DetailsPanel_slicedToArray(arr,i){return function DetailsPanel_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function DetailsPanel_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||DetailsPanel_unsupportedIterableToArray(arr,i)||function DetailsPanel_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function DetailsPanel_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return DetailsPanel_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?DetailsPanel_arrayLikeToArray(o,minLen):void 0}}function DetailsPanel_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function DetailsPanel(_ref){var _record$item3,_record$item3$title,_presentationsRespons3,_record$item5,_tagsResponse$data2,_record$item7,_tagsResponse$data4,_tagsResponse$data7,_tagsResponse$data8,_record$item9,_ref2,_record$item$title2,_record$item10,_record$item$abstract,_record$item11,_record$item11$abstra,_record$item11$abstra2,_record$item11$abstra3,_record$item11$abstra4,_record$item$typeName,_record$item13,isCreate=_ref.isCreate,isDisabled=_ref.isDisabled,clearState=_ref.clearState,firstInputRef=_ref.firstInputRef,record=_ref.record,updateRecord=_ref.updateRecord,onValid=_ref.onValid,onInvalid=_ref.onInvalid,onAnyChange=_ref.onAnyChange,isSession=!("sessionEventId"in record&&record.sessionEventId),conference=(0,useConference.fk)(),subconferenceId=(0,AuthParameters.h)().subconferenceId,context=(0,react.useMemo)((function(){var _makeContext;return(0,make_context.f)(((_makeContext={})[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext))}),[subconferenceId]),hoursOptions=(0,react.useMemo)((function(){for(var result=[],i=0;i<=4;i++)result.push((0,jsx_runtime.jsx)("option",{value:i,children:i},i));return result}),[]),minutesOptions=(0,react.useMemo)((function(){for(var result=[],i=0;i<=59;i++)result.push((0,jsx_runtime.jsx)("option",{value:i,children:i},i));return result}),[]),startTime=(0,react.useMemo)((function(){return record.scheduledStartTime?new Date(record.scheduledStartTime):isSession?new Date((0,MathUtils.FG)(Date.now(),3e5)):void 0}),[isSession,record.scheduledStartTime]),durationMinutes=(0,react.useMemo)((function(){return startTime&&record.scheduledEndTime?Math.max(0,Math.round((Date.parse(record.scheduledEndTime)-startTime.getTime())/6e4)):60}),[record.scheduledEndTime,startTime]),_useState2=DetailsPanel_slicedToArray((0,react.useState)(!1),2),startTimeHasChanged=_useState2[0],setStartTimeHasChanged=_useState2[1],_useState4=DetailsPanel_slicedToArray((0,react.useState)("no error"),2),startTimeValidation=_useState4[0],setStartTimeValidation=_useState4[1],_useState6=DetailsPanel_slicedToArray((0,react.useState)(!1),2),durationHasChanged=_useState6[0],setDurationHasChanged=_useState6[1],_useState8=DetailsPanel_slicedToArray((0,react.useState)("no error"),2),durationValidation=_useState8[0],setDurationValidation=_useState8[1],_useState10=DetailsPanel_slicedToArray((0,react.useState)(!1),2),nameHasChanged=_useState10[0],setNameHasChanged=_useState10[1],_useState12=DetailsPanel_slicedToArray((0,react.useState)("no error"),2),nameValidation=_useState12[0],setNameValidation=_useState12[1],updateValidity=(0,react.useCallback)((function(){if(isCreate){var _record$item,_record$item$title,_record$item2,_record$item2$title;if(!(nameHasChanged||null!==(_record$item=record.item)&&void 0!==_record$item&&null!==(_record$item$title=_record$item.title)&&void 0!==_record$item$title&&_record$item$title.length))return void onInvalid({error:"A name is required."});null!==(_record$item2=record.item)&&void 0!==_record$item2&&null!==(_record$item2$title=_record$item2.title)&&void 0!==_record$item2$title&&_record$item2$title.length&&onAnyChange()}"no error"!==startTimeValidation?onInvalid(startTimeValidation):"no error"!==durationValidation?onInvalid(durationValidation):"no error"!==nameValidation?onInvalid(nameValidation):onValid()}),[durationValidation,isCreate,nameHasChanged,nameValidation,startTimeValidation,null===(_record$item3=record.item)||void 0===_record$item3||null===(_record$item3$title=_record$item3.title)||void 0===_record$item3$title?void 0:_record$item3$title.length]);clearState.current=(0,react.useCallback)((function(){setStartTimeHasChanged(!1),setDurationHasChanged(!1),setNameHasChanged(!1),updateValidity()}),[updateValidity]),(0,react.useEffect)((function(){(startTimeHasChanged||durationHasChanged||nameHasChanged)&&onAnyChange()}),[durationHasChanged,nameHasChanged,onAnyChange,startTimeHasChanged]),(0,react.useEffect)((function(){startTimeHasChanged?isSession?record.scheduledStartTime?"modeName"in record&&record.modeName===graphql.kdg.Livestream&&Date.parse(record.scheduledStartTime)-Date.now()<12e5?setStartTimeValidation({error:"Live-stream sessions must be scheduled at least 20 minutes in advance."}):setStartTimeValidation("no error"):setStartTimeValidation({error:"A start date/time is required."}):record.scheduledStartTime?new Date(record.scheduledStartTime).getTime()<new Date(record.session.scheduledStartTime).getTime()?setStartTimeValidation({error:"Presentation must start at or after the start of the session."}):new Date(record.scheduledStartTime).getTime()>=new Date(record.session.scheduledEndTime).getTime()?setStartTimeValidation({error:"Presentation must start before the end of the session."}):setStartTimeValidation("no error"):setStartTimeValidation("no error"):setStartTimeValidation("no error")}),[isSession,record.scheduledStartTime,record,startTimeHasChanged]);var presentationsResponse=DetailsPanel_slicedToArray((0,graphql.LO_)({variables:{sessionEventId:record.id},pause:!record.id,context,requestPolicy:"network-only"}),1)[0];(0,react.useEffect)((function(){if(durationHasChanged){var _presentationsRespons,_presentationsRespons2,presentationsMinMax=null===(_presentationsRespons=presentationsResponse.data)||void 0===_presentationsRespons?void 0:_presentationsRespons.schedule_Event.reduce((function(acc,x){var start=Date.parse(x.scheduledStartTime),end=Date.parse(x.scheduledEndTime);return start<acc.min&&(acc.min=start),end>acc.max&&(acc.max=end),acc}),{min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY});if(!(!record.id||Boolean(0===(null===(_presentationsRespons2=presentationsResponse.data)||void 0===_presentationsRespons2?void 0:_presentationsRespons2.schedule_Event.length)||presentationsMinMax&&record.scheduledStartTime&&record.scheduledEndTime&&Math.max(0,presentationsMinMax.max-presentationsMinMax.min)<=Math.max(0,Date.parse(record.scheduledEndTime)-Date.parse(record.scheduledStartTime)))))return void setDurationValidation({error:"Presentations do not fit within the new session time."});if(isSession)if(record.scheduledStartTime&&record.scheduledEndTime){var duration=Math.max(0,Math.round((Date.parse(record.scheduledEndTime)-Date.parse(record.scheduledStartTime))/6e4));setDurationValidation(duration>=3?"no error":{error:"Must be at least 3 minutes."})}else setDurationValidation({error:"Duration is required."});else if(record.scheduledStartTime)if(record.scheduledEndTime)Math.max(0,Math.round((Date.parse(record.scheduledEndTime)-Date.parse(record.scheduledStartTime))/6e4))>=3?new Date(record.scheduledEndTime).getTime()>new Date(record.session.scheduledEndTime).getTime()?setDurationValidation({error:"Presentation must end at or before the end of the session."}):setDurationValidation("no error"):setDurationValidation({error:"Must be at least 3 minutes."});else setDurationValidation({error:"Duration is required when a start time is set."});else setDurationValidation("no error")}else setDurationValidation("no error")}),[durationHasChanged,record.scheduledStartTime,record.scheduledEndTime,isSession,record,null===(_presentationsRespons3=presentationsResponse.data)||void 0===_presentationsRespons3?void 0:_presentationsRespons3.schedule_Event]),(0,react.useEffect)((function(){var _record$item4,_record$item4$title,_record$name;nameHasChanged?null!==(_record$item4=record.item)&&void 0!==_record$item4&&null!==(_record$item4$title=_record$item4.title)&&void 0!==_record$item4$title&&_record$item4$title.length||null!==(_record$name=record.name)&&void 0!==_record$name&&_record$name.length?setNameValidation("no error"):setNameValidation({error:"A name is required."}):setNameValidation("no error")}),[nameHasChanged,null===(_record$item5=record.item)||void 0===_record$item5?void 0:_record$item5.title,record.name]),(0,react.useEffect)(updateValidity,[updateValidity]);var _useManageSchedule_Ge4=DetailsPanel_slicedToArray((0,graphql.PSE)({variables:{conferenceId:conference.id,subconferenceCond:subconferenceId?{_eq:subconferenceId}:{_is_null:!0}},context,requestPolicy:"cache-and-network"}),2),tagsResponse=_useManageSchedule_Ge4[0],refetchTags=_useManageSchedule_Ge4[1],tagOptions=(0,react.useMemo)((function(){var _tagsResponse$data$co,_tagsResponse$data,result=null!==(_tagsResponse$data$co=null===(_tagsResponse$data=tagsResponse.data)||void 0===_tagsResponse$data?void 0:_tagsResponse$data.collection_Tag.map((function(x){return{label:x.name,value:x.id}})))&&void 0!==_tagsResponse$data$co?_tagsResponse$data$co:[];return result.push({label:"Create a tag",value:"create"}),result}),[null===(_tagsResponse$data2=tagsResponse.data)||void 0===_tagsResponse$data2?void 0:_tagsResponse$data2.collection_Tag]),tagValues=(0,react.useMemo)((function(){var _record$item$itemTags,_record$item6,_record$item6$itemTag;return null!==(_record$item$itemTags=null===(_record$item6=record.item)||void 0===_record$item6||null===(_record$item6$itemTag=_record$item6.itemTags)||void 0===_record$item6$itemTag?void 0:_record$item6$itemTag.map((function(x){var _tagsResponse$data$co2,_tagsResponse$data3,_tagsResponse$data3$c;return{label:null!==(_tagsResponse$data$co2=null===(_tagsResponse$data3=tagsResponse.data)||void 0===_tagsResponse$data3||null===(_tagsResponse$data3$c=_tagsResponse$data3.collection_Tag.find((function(y){return y.id===x.tagId})))||void 0===_tagsResponse$data3$c?void 0:_tagsResponse$data3$c.name)&&void 0!==_tagsResponse$data$co2?_tagsResponse$data$co2:"<Loading...>",value:x.tagId}})))&&void 0!==_record$item$itemTags?_record$item$itemTags:[]}),[null===(_record$item7=record.item)||void 0===_record$item7?void 0:_record$item7.itemTags,null===(_tagsResponse$data4=tagsResponse.data)||void 0===_tagsResponse$data4?void 0:_tagsResponse$data4.collection_Tag]),_useRestorableState2=DetailsPanel_slicedToArray((0,useRestorableState.aX)("recently-used-tags:"+conference.id+":"+(null!=subconferenceId?subconferenceId:"no-subconf"),[],(function(x){return JSON.stringify(x)}),(function(x){return JSON.parse(x)})),2),recentlyUsedTags=_useRestorableState2[0],_setRecentlyUsedTags=_useRestorableState2[1],updateRecentlyUsedTags=(0,react.useCallback)((function(value){var _tagsResponse$data5;null!==(_tagsResponse$data5=tagsResponse.data)&&void 0!==_tagsResponse$data5&&_tagsResponse$data5.collection_Tag&&(value=value.filter((function(x){var _tagsResponse$data6;return null===(_tagsResponse$data6=tagsResponse.data)||void 0===_tagsResponse$data6?void 0:_tagsResponse$data6.collection_Tag.some((function(y){return y.id===x.id}))})));var now=Date.now(),sortedTags=es.HCG([function(a,b){return Math.round(10*Math.log(b.count))/10-Math.round(10*Math.log(a.count))/10},function(a,b){return b.lastUsedAt-a.lastUsedAt}],es.hXT((function(x){return now-x.lastUsedAt<1728e5}),value));_setRecentlyUsedTags(sortedTags)}),[_setRecentlyUsedTags,null===(_tagsResponse$data7=tagsResponse.data)||void 0===_tagsResponse$data7?void 0:_tagsResponse$data7.collection_Tag]),setRecentlyUsedTags=(0,react.useCallback)((function(value){updateRecentlyUsedTags("function"==typeof value?value(recentlyUsedTags):value)}),[recentlyUsedTags,updateRecentlyUsedTags]);(0,react.useEffect)((function(){updateRecentlyUsedTags(recentlyUsedTags)}),[null===(_tagsResponse$data8=tagsResponse.data)||void 0===_tagsResponse$data8?void 0:_tagsResponse$data8.collection_Tag]);var upsertRecentlyUsedTag=(0,react.useCallback)((function(tagId){setRecentlyUsedTags((function(old){var newList=DetailsPanel_toConsumableArray(old),existing=newList.find((function(x){return x.id===tagId}));return existing?(existing.count++,existing.lastUsedAt=Date.now()):newList.push({id:tagId,count:1,lastUsedAt:Date.now()}),newList}))}),[setRecentlyUsedTags]),remainingRecentlyUsedTags=(0,react.useMemo)((function(){return recentlyUsedTags.filter((function(x){var _record$item8,_record$item8$itemTag;return!(null!==(_record$item8=record.item)&&void 0!==_record$item8&&null!==(_record$item8$itemTag=_record$item8.itemTags)&&void 0!==_record$item8$itemTag&&_record$item8$itemTag.some((function(y){return y.tagId===x.id})))})).slice(0,3)}),[recentlyUsedTags,null===(_record$item9=record.item)||void 0===_record$item9?void 0:_record$item9.itemTags]),_useState14=DetailsPanel_slicedToArray((0,react.useState)(""),2),createTagName=_useState14[0],setCreateTagName=_useState14[1],createTagDisclosure=(0,chakra_ui_hooks_esm.qY)(),onCreateTag=(0,react.useCallback)((function(newTagId){refetchTags(),onAnyChange(),upsertRecentlyUsedTag(newTagId),updateRecord((function(old){var _old$item$itemTags,_old$item;return Object.assign({},old,{item:Object.assign({},old.item,{itemTags:[].concat(DetailsPanel_toConsumableArray(null!==(_old$item$itemTags=null===(_old$item=old.item)||void 0===_old$item?void 0:_old$item.itemTags)&&void 0!==_old$item$itemTags?_old$item$itemTags:[]),[{tagId:newTagId}])})})}))}),[onAnyChange,refetchTags,updateRecord,upsertRecentlyUsedTag]),defaultItemTypeName=isSession?graphql.gqi.Session:graphql.gqi.Presentation;return(0,react.useEffect)((function(){updateRecord(isSession?function(old){var _old$scheduledStartTi,_old$scheduledEndTime,_old$item$typeName;return Object.assign({},old,{scheduledStartTime:null!==(_old$scheduledStartTi=old.scheduledStartTime)&&void 0!==_old$scheduledStartTi?_old$scheduledStartTi:null==startTime?void 0:startTime.toISOString(),scheduledEndTime:null!==(_old$scheduledEndTime=old.scheduledEndTime)&&void 0!==_old$scheduledEndTime?_old$scheduledEndTime:startTime?new Date(startTime.getTime()+60*durationMinutes*1e3).toISOString():void 0,item:old.item?Object.assign({},old.item,{typeName:null!==(_old$item$typeName=old.item.typeName)&&void 0!==_old$item$typeName?_old$item$typeName:defaultItemTypeName}):{typeName:defaultItemTypeName}})}:function(old){var _old$item$typeName2;return Object.assign({},old,{item:old.item?Object.assign({},old.item,{typeName:null!==(_old$item$typeName2=old.item.typeName)&&void 0!==_old$item$typeName2?_old$item$typeName2:defaultItemTypeName}):{typeName:defaultItemTypeName}})})}),[durationMinutes,isSession,startTime]),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{spacing:6,p:0,children:[(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{isInvalid:"no error"!==startTimeValidation,isDisabled,id:"editor-session-start-time",children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Start date and time"}),(0,jsx_runtime.jsx)(DateTimePicker.x,{isDisabled,ref:firstInputRef,value:startTime,allowUndefined:!isSession,onChange:function onChange(value){setStartTimeHasChanged(!0),updateRecord((function(old){return Object.assign({},old,{scheduledStartTime:null==value?void 0:value.toISOString(),scheduledEndTime:value?new Date(value.getTime()+60*durationMinutes*1e3).toISOString():startTime?new Date(startTime.getTime()+60*durationMinutes*1e3).toISOString():void 0})}))}}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.Q6,{children:["Enter times in your local timezone."," ",isSession?void 0:"Leave blank for sessions that do not follow a preset schedule."]}),(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.J1,{children:"no error"!==startTimeValidation?startTimeValidation.error:"No error"})]}),isSession||startTime?(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{isInvalid:"no error"!==durationValidation,isDisabled,children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{id:"editor-session-duration-label",children:"Duration"}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{w:"auto",children:[(0,jsx_runtime.jsxs)(chakra_ui_input_esm.BZ,{w:"auto",children:[(0,jsx_runtime.jsx)(chakra_ui_select_esm.Ph,{"aria-labelledby":"editor-session-duration-label editor-session-duration-hours-label",value:Math.floor(durationMinutes/60),onChange:function onChange(ev){setDurationHasChanged(!0);var existingMinutes=durationMinutes%60,value=60*parseInt(ev.target.value,10)+existingMinutes,endTime=startTime?new Date(startTime.getTime()+60*value*1e3):void 0;updateRecord((function(old){return Object.assign({},old,{scheduledStartTime:startTime,scheduledEndTime:null==endTime?void 0:endTime.toISOString()})}))},children:hoursOptions}),(0,jsx_runtime.jsx)(chakra_ui_input_esm.xW,{id:"editor-session-duration-hours-label",children:"hours"})]}),(0,jsx_runtime.jsxs)(chakra_ui_input_esm.BZ,{w:"auto",children:[(0,jsx_runtime.jsx)(chakra_ui_select_esm.Ph,{"aria-labelledby":"editor-session-duration-label editor-session-duration-minutes-label",value:durationMinutes%60,onChange:function onChange(ev){setDurationHasChanged(!0);var value=60*Math.floor(durationMinutes/60)+parseInt(ev.target.value,10),endTime=startTime?new Date(startTime.getTime()+60*value*1e3):void 0;updateRecord((function(old){return Object.assign({},old,{scheduledStartTime:startTime,scheduledEndTime:null==endTime?void 0:endTime.toISOString()})}))},children:minutesOptions}),(0,jsx_runtime.jsx)(chakra_ui_input_esm.xW,{id:"editor-session-duration-minutes-label",children:"minutes"})]})]}),(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.J1,{children:"no error"!==durationValidation?durationValidation.error:"No error"})]}):void 0,(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{id:"editor-session-name",isInvalid:"no error"!==nameValidation,isDisabled,children:[(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.lX,{children:["Name of ",isSession?"session":"presentation"]}),(0,jsx_runtime.jsx)(chakra_ui_input_esm.II,{type:"text",value:null!==(_ref2=null!==(_record$item$title2=null===(_record$item10=record.item)||void 0===_record$item10?void 0:_record$item10.title)&&void 0!==_record$item$title2?_record$item$title2:record.name)&&void 0!==_ref2?_ref2:"",onChange:function onChange(ev){setNameHasChanged(!0);var value=ev.target.value;updateRecord((function(old){return Object.assign({},old,{name:value,item:old.item?Object.assign({},old.item,{title:value}):{title:value}})}))}}),(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.J1,{children:"no error"!==nameValidation?nameValidation.error:"No error"})]}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{id:"editor-session-description",isDisabled,children:[(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.lX,{children:[isSession?"Session":"Presentation"," description (abstract)"]}),(0,jsx_runtime.jsx)(chakra_ui_textarea_esm.g,{value:null!==(_record$item$abstract=null===(_record$item11=record.item)||void 0===_record$item11||null===(_record$item11$abstra=_record$item11.abstract)||void 0===_record$item11$abstra||null===(_record$item11$abstra2=_record$item11$abstra[0])||void 0===_record$item11$abstra2||null===(_record$item11$abstra3=_record$item11$abstra2.data)||void 0===_record$item11$abstra3||null===(_record$item11$abstra4=_record$item11$abstra3[record.item.abstract[0].data.length-1])||void 0===_record$item11$abstra4?void 0:_record$item11$abstra4.data.text)&&void 0!==_record$item$abstract?_record$item$abstract:"",onChange:function onChange(ev){onAnyChange();var value=ev.target.value;updateRecord((function(old){var _old$item$abstract,_old$item$abstract$0$;return Object.assign({},old,{item:old.item?Object.assign({},old.item,{abstract:null!==(_old$item$abstract=old.item.abstract)&&void 0!==_old$item$abstract&&_old$item$abstract.length?[Object.assign({},old.item.abstract[0],{data:null!==(_old$item$abstract$0$=old.item.abstract[0].data)&&void 0!==_old$item$abstract$0$&&_old$item$abstract$0$.length?[Object.assign({},old.item.abstract[0].data[0],{data:{baseType:content.bN.Text,type:content.bK.Abstract,text:value}})]:[{createdAt:Date.now(),createdBy:"user",data:{baseType:content.bN.Text,type:content.bK.Abstract,text:value}}]})]:[{data:[{createdAt:Date.now(),createdBy:"user",data:{baseType:content.bN.Text,type:content.bK.Abstract,text:value}}]}]}):{abstract:[{data:[{createdAt:Date.now(),createdBy:"user",data:{baseType:content.bN.Text,type:content.bK.Abstract,text:value}}]}]}})}))}}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.Q6,{children:["Use"," ",(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.rU,{isExternal:!0,href:"https://itsfoss.com/markdown-guide/",children:["Markdown syntax",(0,jsx_runtime.jsx)("sup",{children:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.ExternalLinkIcon,{})})]})," ","to format your text."]})]}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Tags"}),(0,jsx_runtime.jsx)(MultiSelect.M9,{options:tagOptions,value:tagValues,onCreateOption:function onCreateOption(value){setCreateTagName(value),createTagDisclosure.onOpen()},onChange:function onChange(options,action){var _action$option;if("create-option"===action.action||"select-option"===action.action&&"create"===(null===(_action$option=action.option)||void 0===_action$option?void 0:_action$option.value)){var _action$name;setCreateTagName("create-option"===action.action&&null!==(_action$name=action.name)&&void 0!==_action$name?_action$name:""),createTagDisclosure.onOpen()}else{var _action$option2,tagIds=es.jj$(options.filter((function(x){return"create"!==x.value})).map((function(x){return x.value})));onAnyChange(),"select-option"===action.action&&null!==(_action$option2=action.option)&&void 0!==_action$option2&&_action$option2.value&&upsertRecentlyUsedTag(action.option.value),updateRecord((function(old){return Object.assign({},old,{item:Object.assign({},old.item,{itemTags:tagIds.map((function(tagId){return{tagId}}))})})}))}}}),remainingRecentlyUsedTags.length>0?(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{spacing:2,mt:1,children:[(0,jsx_runtime.jsx)(chakra_ui_system_esm.m$.span,{fontSize:"sm",children:"Recently used:"}),remainingRecentlyUsedTags.map((function(_ref3){var _tagOptions$find$labe,_tagOptions$find,id=_ref3.id;return(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{size:"xs",h:"auto",minH:0,py:1,px:2,minW:0,borderRadius:"full",colorScheme:"gray",onClick:function onClick(){var _record$item$itemTags2,_record$item12,_record$item12$itemTa,tagIds=null!==(_record$item$itemTags2=null===(_record$item12=record.item)||void 0===_record$item12||null===(_record$item12$itemTa=_record$item12.itemTags)||void 0===_record$item12$itemTa?void 0:_record$item12$itemTa.map((function(x){return x.tagId})))&&void 0!==_record$item$itemTags2?_record$item$itemTags2:[];tagIds.push(id),onAnyChange(),upsertRecentlyUsedTag(id),updateRecord((function(old){return Object.assign({},old,{item:Object.assign({},old.item,{itemTags:tagIds.map((function(tagId){return{tagId}}))})})}))},children:null!==(_tagOptions$find$labe=null===(_tagOptions$find=tagOptions.find((function(x){return x.value===id})))||void 0===_tagOptions$find?void 0:_tagOptions$find.label)&&void 0!==_tagOptions$find$labe?_tagOptions$find$labe:"<Loading...>"},id)}))]}):void 0]}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{id:"editor-session-type",isDisabled,children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Type"}),(0,jsx_runtime.jsx)(chakra_ui_select_esm.Ph,{value:null!==(_record$item$typeName=null===(_record$item13=record.item)||void 0===_record$item13?void 0:_record$item13.typeName)&&void 0!==_record$item$typeName?_record$item$typeName:defaultItemTypeName,onChange:function onChange(ev){onAnyChange(),updateRecord((function(old){return Object.assign({},old,{item:old.item?Object.assign({},old.item,{typeName:ev.target.value}):{typeName:ev.target.value}})}))},children:isSession?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("option",{value:graphql.gqi.Session,children:"Session"}),(0,jsx_runtime.jsx)("option",{value:graphql.gqi.Social,children:"Social"}),(0,jsx_runtime.jsx)("option",{value:graphql.gqi.Symposium,children:"Symposium"}),(0,jsx_runtime.jsx)("option",{value:graphql.gqi.Tutorial,children:"Tutorial"}),(0,jsx_runtime.jsx)("option",{value:graphql.gqi.Workshop,children:"Workshop"})]}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("option",{value:graphql.gqi.Demonstration,children:"Demonstration"}),(0,jsx_runtime.jsx)("option",{value:graphql.gqi.Keynote,children:"Keynote"}),(0,jsx_runtime.jsx)("option",{value:graphql.gqi.Other,children:"Other"}),(0,jsx_runtime.jsx)("option",{value:graphql.gqi.Paper,children:"Paper"}),(0,jsx_runtime.jsx)("option",{value:graphql.gqi.Poster,children:"Poster"}),(0,jsx_runtime.jsx)("option",{value:graphql.gqi.Presentation,children:"Presentation"}),(0,jsx_runtime.jsx)("option",{value:graphql.gqi.SessionQAndA,children:"Session Q&A"})]})}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.Q6,{children:["This is a descriptive label only, to help your attendees understand what kind of"," ",isSession?"session":"presentation"," this is."]})]}),(0,jsx_runtime.jsx)(CreateTagModal,{initialName:createTagName,isOpen:createTagDisclosure.isOpen,onClose:createTagDisclosure.onClose,onCreate:onCreateTag})]})}(0,urql_core.Ps)(DetailsPanel_templateObject||(DetailsPanel_templateObject=function DetailsPanel_taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(["\n    query ManageSchedule_GetPresentationTimes($sessionEventId: uuid!) {\n        schedule_Event(where: { sessionEventId: { _eq: $sessionEventId }, scheduledStartTime: { _is_null: false } }) {\n            id\n            scheduledStartTime\n            scheduledEndTime\n        }\n    }\n"]))),DetailsPanel.displayName="DetailsPanel";try{DetailsPanel.displayName="DetailsPanel",DetailsPanel.__docgenInfo={description:"",displayName:"DetailsPanel",props:{isCreate:{defaultValue:null,description:"",name:"isCreate",required:!0,type:{name:"boolean"}},isDisabled:{defaultValue:null,description:"",name:"isDisabled",required:!0,type:{name:"boolean"}},firstInputRef:{defaultValue:null,description:"",name:"firstInputRef",required:!0,type:{name:"MutableRefObject<HTMLButtonElement | HTMLInputElement | HTMLSelectElement | null>"}},clearState:{defaultValue:null,description:"",name:"clearState",required:!0,type:{name:"MutableRefObject<(() => void) | null>"}},record:{defaultValue:null,description:"",name:"record",required:!0,type:{name:"DeepPartial<ScheduleEditorRecord>"}},updateRecord:{defaultValue:null,description:"",name:"updateRecord",required:!0,type:{name:"(record: DeepPartial<ScheduleEditorRecord> | ((old: DeepPartial<ScheduleEditorRecord>) => DeepPartial<ScheduleEditorRecord>)) => void"}},onValid:{defaultValue:null,description:"",name:"onValid",required:!0,type:{name:"() => void"}},onInvalid:{defaultValue:null,description:"",name:"onInvalid",required:!0,type:{name:"(error: ValidationError) => void"}},onAnyChange:{defaultValue:null,description:"",name:"onAnyChange",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/Schedule/Components/DetailsPanel.tsx#DetailsPanel"]={docgenInfo:DetailsPanel.__docgenInfo,name:"DetailsPanel",path:"src/aspects/Conference/Manage/Schedule/Components/DetailsPanel.tsx#DetailsPanel"})}catch(__react_docgen_typescript_loader_error){}function FindExistingContentModal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function FindExistingContentModal_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){FindExistingContentModal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){FindExistingContentModal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function FindExistingContentModal_slicedToArray(arr,i){return function FindExistingContentModal_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function FindExistingContentModal_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function FindExistingContentModal_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return FindExistingContentModal_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return FindExistingContentModal_arrayLikeToArray(o,minLen)}(arr,i)||function FindExistingContentModal_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function FindExistingContentModal_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function FindExistingContentModal(props){return props.isOpen?(0,jsx_runtime.jsx)(FindExistingContentModalInner,Object.assign({},props)):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{})}function FindExistingContentModalInner(_ref){var _itemsResponse$data,isOpen=_ref.isOpen,_onClose=_ref.onClose,typeNames=_ref.typeNames,typeDisplayName=_ref.typeDisplayName,sessionOrPresentation=_ref.sessionOrPresentation,_useState2=FindExistingContentModal_slicedToArray((0,react.useState)(null),2),selectedId=_useState2[0],setSelectedId=_useState2[1],conference=(0,useConference.fk)(),subconferenceId=(0,AuthParameters.h)().subconferenceId,context=(0,react.useMemo)((function(){var _makeContext;return(0,make_context.f)(((_makeContext={})[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext))}),[subconferenceId]),itemsResponse=FindExistingContentModal_slicedToArray((0,graphql.hW8)({variables:{conferenceId:conference.id,subconferenceCond:subconferenceId?{_eq:subconferenceId}:{_is_null:!0},typeNames},context}),1)[0];return(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.u_,{isOpen,onClose:function onClose(){return _onClose()},children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.ZA,{}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.hz,{children:[(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.xB,{children:["Add ",sessionOrPresentation," for ",typeDisplayName.toLowerCase()]}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.fe,{children:(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:typeDisplayName}),(0,jsx_runtime.jsxs)(chakra_ui_select_esm.Ph,{value:null!=selectedId?selectedId:"",onChange:function onChange(ev){setSelectedId(ev.target.value)},children:[(0,jsx_runtime.jsxs)("option",{value:"",children:["Select ",typeDisplayName.toLowerCase()]}),null===(_itemsResponse$data=itemsResponse.data)||void 0===_itemsResponse$data?void 0:_itemsResponse$data.content_Item.map((function(x){return(0,jsx_runtime.jsx)("option",{value:x.id,children:x.title},x.id)}))]})]})}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.mz,{children:(0,jsx_runtime.jsxs)(chakra_ui_button_esm.hE,{children:[(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{variant:"outline",colorScheme:"blue",onClick:function onClick(){return _onClose()},children:"Cancel"}),(0,jsx_runtime.jsxs)(chakra_ui_button_esm.zx,{variant:"solid",colorScheme:"PrimaryActionButton",onClick:FindExistingContentModal_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:_onClose(null!=selectedId?selectedId:void 0);case 1:case"end":return _context.stop()}}),_callee)}))),isDisabled:!(null!=selectedId&&selectedId.length),children:["Add ",sessionOrPresentation]})]})})]})]})}(0,urql_core.Ps)(FindExistingContentModal_templateObject||(FindExistingContentModal_templateObject=function FindExistingContentModal_taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(["\n    query ManageSchedule_ListAllItemTitles(\n        $conferenceId: uuid!\n        $subconferenceCond: uuid_comparison_exp!\n        $typeNames: [content_ItemType_enum!]!\n    ) {\n        content_Item(\n            where: {\n                conferenceId: { _eq: $conferenceId }\n                subconferenceId: $subconferenceCond\n                typeName: { _in: $typeNames }\n                _or: [{ _not: { events: {} } }, { typeName: { _eq: SPONSOR } }]\n            }\n        ) {\n            id\n            title\n        }\n    }\n"]))),FindExistingContentModalInner.displayName="FindExistingContentModalInner";try{FindExistingContentModal.displayName="FindExistingContentModal",FindExistingContentModal.__docgenInfo={description:"",displayName:"FindExistingContentModal",props:{isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"(id?: string | undefined) => void"}},typeNames:{defaultValue:null,description:"",name:"typeNames",required:!0,type:{name:"Content_ItemType_Enum[]"}},typeDisplayName:{defaultValue:null,description:"",name:"typeDisplayName",required:!0,type:{name:"string"}},sessionOrPresentation:{defaultValue:null,description:"",name:"sessionOrPresentation",required:!0,type:{name:"enum",value:[{value:'"presentation"'},{value:'"session"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/Schedule/Components/FindExistingContentModal.tsx#FindExistingContentModal"]={docgenInfo:FindExistingContentModal.__docgenInfo,name:"FindExistingContentModal",path:"src/aspects/Conference/Manage/Schedule/Components/FindExistingContentModal.tsx#FindExistingContentModal"})}catch(__react_docgen_typescript_loader_error){}var chakra_ui_menu_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+menu@1.8.6_381b254eb05ba0b21fa13fc526cde82c/node_modules/@chakra-ui/menu/dist/chakra-ui-menu.esm.js"),react_router=__webpack_require__("../node_modules/.pnpm/react-router@5.2.1_react@17.0.2/node_modules/react-router/esm/react-router.js");__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.includes.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.includes.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.split.js"),__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.regexp.exec.js");var CreatePersonModal_templateObject,PeoplePanel_templateObject,chakra_ui_tooltip_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+tooltip@1.4.6_3467197ee0b52af28e4f3b42a3c78b88/node_modules/@chakra-ui/tooltip/dist/chakra-ui-tooltip.esm.js"),FAIcon=__webpack_require__("./src/aspects/Chakra/FAIcon.tsx"),maybeCompare=__webpack_require__("./src/aspects/Utils/maybeCompare.tsx");__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.match.js");function CreatePersonModal_toConsumableArray(arr){return function CreatePersonModal_arrayWithoutHoles(arr){if(Array.isArray(arr))return CreatePersonModal_arrayLikeToArray(arr)}(arr)||function CreatePersonModal_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||CreatePersonModal_unsupportedIterableToArray(arr)||function CreatePersonModal_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CreatePersonModal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CreatePersonModal_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CreatePersonModal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CreatePersonModal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function CreatePersonModal_slicedToArray(arr,i){return function CreatePersonModal_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CreatePersonModal_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||CreatePersonModal_unsupportedIterableToArray(arr,i)||function CreatePersonModal_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CreatePersonModal_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return CreatePersonModal_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?CreatePersonModal_arrayLikeToArray(o,minLen):void 0}}function CreatePersonModal_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function CreatePersonModal(_ref){var _registrant$displayNa,initialName=_ref.initialName,initialExistingRegistrantId=_ref.initialExistingRegistrantId,onCreate=_ref.onCreate,isOpen=_ref.isOpen,onClose=_ref.onClose,conference=(0,useConference.fk)(),subconferenceId=(0,AuthParameters.h)().subconferenceId,_useState2=CreatePersonModal_slicedToArray((0,react.useState)(initialName),2),name=_useState2[0],setName=_useState2[1],_useState4=CreatePersonModal_slicedToArray((0,react.useState)(""),2),affiliation=_useState4[0],setAffiliation=_useState4[1],_useState6=CreatePersonModal_slicedToArray((0,react.useState)(""),2),email=_useState6[0],setEmail=_useState6[1],_useState8=CreatePersonModal_slicedToArray((0,react.useState)(initialExistingRegistrantId),2),registrantId=_useState8[0],setRegistrantId=_useState8[1],_useState10=CreatePersonModal_slicedToArray((0,react.useState)(!1),2),nameHasChanged=_useState10[0],setNameHasChanged=_useState10[1],_useState12=CreatePersonModal_slicedToArray((0,react.useState)("no error"),2),nameValidation=_useState12[0],setNameValidation=_useState12[1],_useState14=CreatePersonModal_slicedToArray((0,react.useState)(!1),2),setAffiliationHasChanged=(_useState14[0],_useState14[1]),_useState16=CreatePersonModal_slicedToArray((0,react.useState)(!1),2),emailHasChanged=_useState16[0],setEmailHasChanged=_useState16[1],_useState18=CreatePersonModal_slicedToArray((0,react.useState)("no error"),2),emailValidation=_useState18[0],setEmailValidation=_useState18[1];(0,react.useEffect)((function(){isOpen&&(setName(initialName.trim()),setAffiliation(""),setEmail(""),setNameHasChanged(initialName.trim().length>0),setRegistrantId(initialExistingRegistrantId))}),[isOpen]),(0,react.useEffect)((function(){nameHasChanged?name.trim().length>0?setNameValidation("no error"):setNameValidation({error:"Name is required."}):setNameValidation("no error")}),[name,nameHasChanged]),(0,react.useEffect)((function(){emailHasChanged&&email.trim().length>0?email.trim().match(/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i)?setEmailValidation("no error"):setEmailValidation({error:"Email address is not valid"}):setEmailValidation("no error")}),[email,emailHasChanged]);var client=(0,urql_es.m8)(),context=(0,react.useMemo)((function(){var _makeContext;return(0,make_context.f)(((_makeContext={})[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext))}),[subconferenceId]),_useState20=CreatePersonModal_slicedToArray((0,react.useState)(""),2),searchTerm=_useState20[0],setSearchTerm=_useState20[1],_useState22=CreatePersonModal_slicedToArray((0,react.useState)([]),2),searchResults=_useState22[0],setSearchResults=_useState22[1],_useState24=CreatePersonModal_slicedToArray((0,react.useState)(!1),2),isSearching=_useState24[0],setIsSearching=_useState24[1];(0,react.useEffect)((function(){var tId=setTimeout(CreatePersonModal_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var result;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!(searchTerm.length>=3)){_context.next=10;break}return setIsSearching(!0),_context.prev=2,_context.next=5,client.query(graphql.Xg7,{conferenceId:conference.id,search:searchTerm},context).toPromise();case 5:(result=_context.sent).data&&setSearchResults(result.data.registrant_searchRegistrants);case 7:return _context.prev=7,setIsSearching(!1),_context.finish(7);case 10:case"end":return _context.stop()}}),_callee,null,[[2,,7,10]])}))),500);return function(){clearTimeout(tId)}}),[client,conference.id,context,searchTerm,subconferenceId]);var searchedOptions=(0,react.useMemo)((function(){return[{label:"No registration",value:"none"}].concat(CreatePersonModal_toConsumableArray(searchTerm.length>=3?[].concat(CreatePersonModal_toConsumableArray(searchResults.map((function(x){return{label:x.displayName,value:x.id}}))),CreatePersonModal_toConsumableArray(subconferenceId?[]:[{label:"Add a registration",value:"create"}])):subconferenceId?[]:[{label:"Add a registration",value:"create"}]))}),[searchResults,searchTerm.length,subconferenceId]),_useState26=CreatePersonModal_slicedToArray((0,react.useState)(null),2),registrant=_useState26[0],setRegistrant=_useState26[1],_useState28=CreatePersonModal_slicedToArray((0,react.useState)(!1),2),loadingRegistrant=_useState28[0],setLoadingRegistrant=_useState28[1];(0,react.useEffect)((function(){registrantId&&"create"!==registrantId&&CreatePersonModal_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var _response$data,response;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return setLoadingRegistrant(!0),_context2.next=3,client.query(graphql.Qf3,{id:registrantId},context).toPromise();case 3:response=_context2.sent,null!==(_response$data=response.data)&&void 0!==_response$data&&_response$data.registrant_Registrant_by_pk?setRegistrant(response.data.registrant_Registrant_by_pk):setRegistrant(null),setLoadingRegistrant(!1);case 6:case"end":return _context2.stop()}}),_callee2)})))()}),[client,context,registrantId]),(0,react.useEffect)((function(){var _registrant$profile$a,_registrant$profile,_registrant$invitatio,_registrant$invitatio2;registrant?(setName(registrant.displayName),setAffiliation(null!==(_registrant$profile$a=null===(_registrant$profile=registrant.profile)||void 0===_registrant$profile?void 0:_registrant$profile.affiliation)&&void 0!==_registrant$profile$a?_registrant$profile$a:""),setEmail(null!==(_registrant$invitatio=null===(_registrant$invitatio2=registrant.invitation)||void 0===_registrant$invitatio2?void 0:_registrant$invitatio2.invitedEmailAddress)&&void 0!==_registrant$invitatio?_registrant$invitatio:"")):loadingRegistrant?(setName("<Loading...>"),setAffiliation("<Loading...>"),setEmail("<Loading...>")):(setName("<Unknown>"),setAffiliation("<Unknown>"),setEmail("<Unknown>"))}),[loadingRegistrant,registrant]);var _useCreatePersonModal2=CreatePersonModal_slicedToArray((0,graphql.cC0)(),2),createPersonResponse=_useCreatePersonModal2[0],createPerson=_useCreatePersonModal2[1],_useState30=CreatePersonModal_slicedToArray((0,react.useState)(null),2),createError=_useState30[0],setCreateError=_useState30[1];return(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.u_,{isOpen,onClose,children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.ZA,{}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.hz,{children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.xB,{children:"Create a person"}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.fe,{children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{spacing:4,children:[(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Registration"}),(0,jsx_runtime.jsxs)(chakra_ui_input_esm.BZ,{w:"100%",children:[(0,jsx_runtime.jsx)(chakra_ui_input_esm.Ui,{children:isSearching?(0,jsx_runtime.jsx)(chakra_ui_spinner_esm.$,{}):(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"search"})}),(0,jsx_runtime.jsx)(MultiSelect.q4,{placeholder:"Start typing to search registrations",onInputChange:function onInputChange(value){setSearchTerm(value)},value:"create"===registrantId?{label:"Add a registration",value:registrantId}:"none"!==registrantId&&registrantId?{label:null!==(_registrant$displayNa=null==registrant?void 0:registrant.displayName)&&void 0!==_registrant$displayNa?_registrant$displayNa:loadingRegistrant?"<Loading...>":"<Unknown>",value:registrantId}:{label:"No registration",value:"none"},onChange:function onChange(value,action){!value||"create-option"!==action.action&&"select-option"!==action.action?"clear"===action.action&&setRegistrantId(null):setRegistrantId("none"===value.value?null:value.value)},options:searchedOptions,styles:{container:function container(base){return Object.assign({},base,{width:"100%"})}}})]})]}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.iz,{}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{id:"create-person-name",isInvalid:"no error"!==nameValidation,children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Name"}),(0,jsx_runtime.jsx)(chakra_ui_input_esm.II,{type:"text",value:name,onChange:function onChange(ev){setCreateError(null),setName(ev.target.value),setNameHasChanged(!0)}}),(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.J1,{children:"no error"!==nameValidation?nameValidation.error:"No error"})]}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{id:"create-person-name",children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Affiliation"}),(0,jsx_runtime.jsx)(chakra_ui_input_esm.II,{type:"text",value:affiliation,onChange:function onChange(ev){setCreateError(null),setAffiliation(ev.target.value),setAffiliationHasChanged(!0)},isDisabled:Boolean(registrantId)&&"create"!==registrantId})]}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{id:"create-person-name",isInvalid:"no error"!==emailValidation,children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Email"}),(0,jsx_runtime.jsx)(chakra_ui_input_esm.II,{type:"email",value:email,onChange:function onChange(ev){setCreateError(null),setEmail(ev.target.value),setEmailHasChanged(!0)},isDisabled:Boolean(registrantId)&&"create"!==registrantId}),(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.J1,{children:"no error"!==emailValidation?emailValidation.error:"No error"})]})]})}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.mz,{flexDir:"column",alignItems:"flex-end",children:[null!==createError?(0,jsx_runtime.jsxs)(chakra_ui_alert_esm.bZ,{status:"error",mb:4,children:[(0,jsx_runtime.jsx)(chakra_ui_alert_esm.Cd,{children:"Error"}),(0,jsx_runtime.jsx)(chakra_ui_alert_esm.X,{children:createError})]}):void 0,(0,jsx_runtime.jsxs)(chakra_ui_button_esm.hE,{children:[(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"DestructiveActionButton",variant:"outline",onClick:function onClick(){onClose()},isDisabled:createPersonResponse.fetching,children:"Cancel"}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"ConfirmButton",onClick:CreatePersonModal_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var _result$data,result,_extractActualError;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if("no error"!==nameValidation){_context3.next=5;break}return _context3.next=3,createPerson({person:{conferenceId:conference.id,subconferenceId,name:name.trim(),affiliation:affiliation.trim(),email:email.trim().toLowerCase(),registrant:!subconferenceId&&registrantId?{data:{conferenceId:conference.id,id:"create"===registrantId?void 0:registrantId,displayName:name.trim(),profile:"create"===registrantId?{data:{affiliation:affiliation.trim()},on_conflict:{constraint:graphql._6O.ProfileRegistrantIdKey,update_columns:[graphql.KOe.Affiliation]}}:void 0,invitation:"create"===registrantId?{data:{conferenceId:conference.id,invitedEmailAddress:email.trim().toLowerCase()},on_conflict:{constraint:graphql.a7O.InvitationRegistrantIdKey,update_columns:[graphql.FyK.InvitedEmailAddress]}}:void 0},on_conflict:{constraint:graphql.ckX.RegistrantPkey,update_columns:[graphql.wt2.DisplayName]}}:void 0}},context);case 3:result=_context3.sent,null!==(_result$data=result.data)&&void 0!==_result$data&&_result$data.insert_collection_ProgramPerson_one?(setCreateError(null),onClose(),onCreate(result.data.insert_collection_ProgramPerson_one.id)):setCreateError(null!==(_extractActualError=(0,ExtractActualError.Z)(result.error))&&void 0!==_extractActualError?_extractActualError:null);case 5:case"end":return _context3.stop()}}),_callee3)}))),isDisabled:loadingRegistrant||"no error"!==nameValidation||"no error"!==emailValidation,isLoading:createPersonResponse.fetching,children:"Create"})]})]})]})]})}(0,urql_core.Ps)(CreatePersonModal_templateObject||(CreatePersonModal_templateObject=function CreatePersonModal_taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(["\n    mutation CreatePersonModal_CreatePerson($person: collection_ProgramPerson_insert_input!) {\n        insert_collection_ProgramPerson_one(object: $person) {\n            id\n        }\n    }\n\n    fragment CreatePersonModal_Registrant on registrant_Registrant {\n        id\n        displayName\n        profile {\n            registrantId\n            affiliation\n        }\n        invitation {\n            id\n            invitedEmailAddress\n        }\n    }\n\n    query CreatePersonModal_GetRegistrant($id: uuid!) {\n        registrant_Registrant_by_pk(id: $id) {\n            ...CreatePersonModal_Registrant\n        }\n    }\n\n    query CreatePersonModal_SearchRegistrants($conferenceId: uuid!, $search: String!) {\n        registrant_searchRegistrants(args: { conferenceid: $conferenceId, search: $search }, limit: 5) {\n            ...CreatePersonModal_Registrant\n        }\n    }\n"]))),CreatePersonModal.displayName="CreatePersonModal";try{CreatePersonModal.displayName="CreatePersonModal",CreatePersonModal.__docgenInfo={description:"",displayName:"CreatePersonModal",props:{initialName:{defaultValue:null,description:"",name:"initialName",required:!0,type:{name:"string"}},initialExistingRegistrantId:{defaultValue:null,description:"",name:"initialExistingRegistrantId",required:!0,type:{name:"string | null"}},onCreate:{defaultValue:null,description:"",name:"onCreate",required:!0,type:{name:"(newPersonId: string) => void"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/Schedule/Components/CreatePersonModal.tsx#CreatePersonModal"]={docgenInfo:CreatePersonModal.__docgenInfo,name:"CreatePersonModal",path:"src/aspects/Conference/Manage/Schedule/Components/CreatePersonModal.tsx#CreatePersonModal"})}catch(__react_docgen_typescript_loader_error){}function PeoplePanel_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function PeoplePanel_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){PeoplePanel_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){PeoplePanel_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=PeoplePanel_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function PeoplePanel_slicedToArray(arr,i){return function PeoplePanel_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function PeoplePanel_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||PeoplePanel_unsupportedIterableToArray(arr,i)||function PeoplePanel_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function PeoplePanel_toConsumableArray(arr){return function PeoplePanel_arrayWithoutHoles(arr){if(Array.isArray(arr))return PeoplePanel_arrayLikeToArray(arr)}(arr)||function PeoplePanel_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||PeoplePanel_unsupportedIterableToArray(arr)||function PeoplePanel_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function PeoplePanel_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return PeoplePanel_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?PeoplePanel_arrayLikeToArray(o,minLen):void 0}}function PeoplePanel_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function mapItemPersonRoleToEventPersonRole(roleName){if(roleName)switch(roleName){case"PRESENTER":case"AUTHOR":case"DISCUSSANT":return graphql.hQl.Presenter;case"CHAIR":case"SESSION ORGANIZER":return graphql.hQl.Chair;case"REVIEWER":return}}function eventPersonRoleToLabel(role){switch(role){case graphql.hQl.Chair:return"Chair";case graphql.hQl.Presenter:return"Presenter";case graphql.hQl.Participant:return"Participant";default:return"None"}}function PeoplePanel(props){var speakerRoleOptions=(0,react.useMemo)((function(){return[{label:"Presenter",value:"PRESENTER"},{label:"Author",value:"AUTHOR"},{label:"Discussant",value:"DISCUSSANT"}]}),[]),moderatorRoleOptions=(0,react.useMemo)((function(){return[{label:"Chair",value:"CHAIR"},{label:"Session Organizer",value:"SESSION ORGANIZER"}]}),[]),reviewerRoleOptions=(0,react.useMemo)((function(){return[{label:"Reviewer",value:"REVIEWER"}]}),[]);return(0,react.useEffect)((function(){props.onValid()}),[]),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{spacing:8,children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{spacing:4,alignItems:"flex-start",children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.X6,{as:"h2",textAlign:"left",fontSize:"lg",children:"Speakers"}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:"Speakers have permission to present during the session and may be listed on the public schedule. They have upload permissions for any content associated with this event."}),"sessionEventId"in props.record&&props.record.sessionEventId?void 0:(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:"Speakers of any presentations in this session are also given permissions and are listed on the public schedule. They only have upload permissions for the content of their respective presentations."}),(0,jsx_runtime.jsx)(PeopleEditor,Object.assign({roleOptions:speakerRoleOptions,defaultRole:"PRESENTER"},props))]}),"sessionEventId"in props.record&&props.record.sessionEventId?void 0:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{spacing:4,alignItems:"flex-start",children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.X6,{as:"h2",textAlign:"left",fontSize:"lg",children:"Moderators / chairs"}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:"Moderators have permission to administer the session, and may be listed on the public schedule."}),(0,jsx_runtime.jsx)(PeopleEditor,Object.assign({roleOptions:moderatorRoleOptions,defaultRole:"CHAIR"},props))]}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{spacing:4,alignItems:"flex-start",children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.X6,{as:"h2",textAlign:"left",fontSize:"lg",children:"Reviewers"}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:"Reviwers have permission to review uploaded content for the session, and are not listed on the public schedule."}),(0,jsx_runtime.jsx)(PeopleEditor,Object.assign({roleOptions:reviewerRoleOptions,defaultRole:"REVIEWER",hideRole:!0},props))]})]})}function PeopleEditor(_ref){var _record$item2,_peopleResponse$data11,record=_ref.record,updateRecord=_ref.updateRecord,roleOptions=_ref.roleOptions,defaultRole=_ref.defaultRole,_ref$hideRole=_ref.hideRole,hideRole=void 0!==_ref$hideRole&&_ref$hideRole,onAnyChange=_ref.onAnyChange,eventPersonRoles=(0,react.useMemo)((function(){return es.jj$(roleOptions.map((function(x){return mapItemPersonRoleToEventPersonRole(x.value)})))}),[roleOptions]),itemPersonRoles=(0,react.useMemo)((function(){return es.jj$(roleOptions.map((function(x){return x.value})))}),[roleOptions]),eventPeople=(0,react.useMemo)((function(){var _record$eventPeople$f,_record$eventPeople;return null!==(_record$eventPeople$f=null===(_record$eventPeople=record.eventPeople)||void 0===_record$eventPeople?void 0:_record$eventPeople.filter((function(x){return x.roleName&&eventPersonRoles.includes(x.roleName)})))&&void 0!==_record$eventPeople$f?_record$eventPeople$f:[]}),[eventPersonRoles,record.eventPeople]),itemPeople=(0,react.useMemo)((function(){var _record$item$itemPeop,_record$item,_record$item$itemPeop2;return null!==(_record$item$itemPeop=null===(_record$item=record.item)||void 0===_record$item||null===(_record$item$itemPeop2=_record$item.itemPeople)||void 0===_record$item$itemPeop2?void 0:_record$item$itemPeop2.filter((function(x){return x.roleName&&itemPersonRoles.includes(x.roleName)})))&&void 0!==_record$item$itemPeop?_record$item$itemPeop:[]}),[itemPersonRoles,null===(_record$item2=record.item)||void 0===_record$item2?void 0:_record$item2.itemPeople]),uniquePersonIds=(0,react.useMemo)((function(){return es.jj$([].concat(PeoplePanel_toConsumableArray(eventPeople.map((function(x){return x.personId})).filter((function(x){return!!x}))),PeoplePanel_toConsumableArray(itemPeople.map((function(x){return x.personId})).filter((function(x){return!!x})))))}),[eventPeople,itemPeople]),conference=(0,useConference.fk)(),subconferenceId=(0,AuthParameters.h)().subconferenceId,context=(0,react.useMemo)((function(){var _makeContext;return(0,make_context.f)(((_makeContext={})[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext))}),[subconferenceId]),_useManageSchedule_Ge2=PeoplePanel_slicedToArray((0,graphql.U5E)({variables:{ids:uniquePersonIds},context,requestPolicy:"cache-and-network"}),2),peopleResponse=_useManageSchedule_Ge2[0],refetchPeople=_useManageSchedule_Ge2[1],mergedPeople=(0,react.useMemo)((function(){var _step,result=[],foundItemPersonIds=new Set,_loop=function _loop(eventPerson){var itemPerson=itemPeople.find((function(x){return x.personId===eventPerson.personId&&eventPerson.roleName===mapItemPersonRoleToEventPersonRole(x.roleName)}));null!=itemPerson&&itemPerson.personId&&foundItemPersonIds.add(itemPerson.personId),result.push({eventPerson,itemPerson})},_iterator=_createForOfIteratorHelper(eventPeople);try{for(_iterator.s();!(_step=_iterator.n()).done;){_loop(_step.value)}}catch(err){_iterator.e(err)}finally{_iterator.f()}var _step2,_iterator2=_createForOfIteratorHelper(itemPeople);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var itemPerson=_step2.value;itemPerson.personId&&(foundItemPersonIds.has(itemPerson.personId)||result.push({itemPerson,eventPerson:void 0}))}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return es.HCG([function(a,b){var _a$itemPerson,_b$itemPerson;return(0,maybeCompare.D)(null===(_a$itemPerson=a.itemPerson)||void 0===_a$itemPerson?void 0:_a$itemPerson.priority,null===(_b$itemPerson=b.itemPerson)||void 0===_b$itemPerson?void 0:_b$itemPerson.priority,(function(x,y){return x-y}))},function(a,b){var _a$itemPerson2,_peopleResponse$data,_peopleResponse$data$,_peopleResponse$data$2,_b$itemPerson2,_peopleResponse$data2,_peopleResponse$data3,_peopleResponse$data4;return(0,maybeCompare.D)(null!==(_a$itemPerson2=a.itemPerson)&&void 0!==_a$itemPerson2&&_a$itemPerson2.personId?null===(_peopleResponse$data=peopleResponse.data)||void 0===_peopleResponse$data||null===(_peopleResponse$data$=_peopleResponse$data.collection_ProgramPerson)||void 0===_peopleResponse$data$||null===(_peopleResponse$data$2=_peopleResponse$data$.find((function(x){var _a$itemPerson3;return x.id===(null===(_a$itemPerson3=a.itemPerson)||void 0===_a$itemPerson3?void 0:_a$itemPerson3.personId)})))||void 0===_peopleResponse$data$2?void 0:_peopleResponse$data$2.name:void 0,null!==(_b$itemPerson2=b.itemPerson)&&void 0!==_b$itemPerson2&&_b$itemPerson2.personId?null===(_peopleResponse$data2=peopleResponse.data)||void 0===_peopleResponse$data2||null===(_peopleResponse$data3=_peopleResponse$data2.collection_ProgramPerson)||void 0===_peopleResponse$data3||null===(_peopleResponse$data4=_peopleResponse$data3.find((function(x){var _b$itemPerson3;return x.id===(null===(_b$itemPerson3=b.itemPerson)||void 0===_b$itemPerson3?void 0:_b$itemPerson3.personId)})))||void 0===_peopleResponse$data4?void 0:_peopleResponse$data4.name:void 0,(function(x,y){return x.localeCompare(y)}))},function(a,b){var _a$eventPerson,_peopleResponse$data5,_peopleResponse$data6,_peopleResponse$data7,_b$eventPerson,_peopleResponse$data8,_peopleResponse$data9,_peopleResponse$data10;return(0,maybeCompare.D)(null!==(_a$eventPerson=a.eventPerson)&&void 0!==_a$eventPerson&&_a$eventPerson.personId?null===(_peopleResponse$data5=peopleResponse.data)||void 0===_peopleResponse$data5||null===(_peopleResponse$data6=_peopleResponse$data5.collection_ProgramPerson)||void 0===_peopleResponse$data6||null===(_peopleResponse$data7=_peopleResponse$data6.find((function(x){var _a$eventPerson2;return x.id===(null===(_a$eventPerson2=a.eventPerson)||void 0===_a$eventPerson2?void 0:_a$eventPerson2.personId)})))||void 0===_peopleResponse$data7?void 0:_peopleResponse$data7.name:void 0,null!==(_b$eventPerson=b.eventPerson)&&void 0!==_b$eventPerson&&_b$eventPerson.personId?null===(_peopleResponse$data8=peopleResponse.data)||void 0===_peopleResponse$data8||null===(_peopleResponse$data9=_peopleResponse$data8.collection_ProgramPerson)||void 0===_peopleResponse$data9||null===(_peopleResponse$data10=_peopleResponse$data9.find((function(x){var _b$eventPerson2;return x.id===(null===(_b$eventPerson2=b.eventPerson)||void 0===_b$eventPerson2?void 0:_b$eventPerson2.personId)})))||void 0===_peopleResponse$data10?void 0:_peopleResponse$data10.name:void 0,(function(x,y){return x.localeCompare(y)}))}],result)}),[eventPeople,itemPeople,null===(_peopleResponse$data11=peopleResponse.data)||void 0===_peopleResponse$data11?void 0:_peopleResponse$data11.collection_ProgramPerson]),client=(0,urql_es.m8)(),_useState2=PeoplePanel_slicedToArray((0,react.useState)(""),2),searchTerm=_useState2[0],setSearchTerm=_useState2[1],_useState4=PeoplePanel_slicedToArray((0,react.useState)({registrants:[],people:[]}),2),searchResults=_useState4[0],setSearchResults=_useState4[1],_useState6=PeoplePanel_slicedToArray((0,react.useState)(!1),2),isSearching=_useState6[0],setIsSearching=_useState6[1];(0,react.useEffect)((function(){var tId=setTimeout(PeoplePanel_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var result;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!(searchTerm.length>=3)){_context.next=10;break}return setIsSearching(!0),_context.prev=2,_context.next=5,client.query(graphql.uOI,{conferenceId:conference.id,subconferenceId,search:searchTerm},Object.assign({},context,{requestPolicy:"cache-and-network"})).toPromise();case 5:(result=_context.sent).data&&setSearchResults({registrants:result.data.registrant_searchRegistrants.filter((function(x){var _result$data;return!(null!==(_result$data=result.data)&&void 0!==_result$data&&_result$data.collection_searchProgramPerson.some((function(y){return y.registrantId===x.id})))})),people:result.data.collection_searchProgramPerson});case 7:return _context.prev=7,setIsSearching(!1),_context.finish(7);case 10:case"end":return _context.stop()}}),_callee,null,[[2,,7,10]])}))),500);return function(){clearTimeout(tId)}}),[client,conference.id,context,searchTerm,subconferenceId]);var searchedOptions=(0,react.useMemo)((function(){return searchTerm.length>=3?[].concat(PeoplePanel_toConsumableArray(searchResults.people.map((function(x){var _x$email;return{label:x.name+(x.email||x.affiliation?" ("+(null!==(_x$email=x.email)&&void 0!==_x$email?_x$email:x.affiliation)+")":""),value:"person"+x.id}}))),PeoplePanel_toConsumableArray(searchResults.registrants.map((function(x){var _x$invitation,_x$invitation2;return{label:"+ "+x.displayName+(null!==(_x$invitation=x.invitation)&&void 0!==_x$invitation&&_x$invitation.invitedEmailAddress.length?" ("+(null===(_x$invitation2=x.invitation)||void 0===_x$invitation2?void 0:_x$invitation2.invitedEmailAddress)+")":""),value:"registrant"+x.id}}))),[{label:"Add a person",value:"create"}]):[{label:"Add a person",value:"create"}]}),[searchResults.people,searchResults.registrants,searchTerm.length]),updateMergedPeople=(0,react.useCallback)((function(newPeople){onAnyChange(),updateRecord((function(old){var _old$eventPeople$filt,_old$eventPeople,_old$item$itemPeople$,_old$item$itemPeople;return Object.assign({},old,{eventPeople:[].concat(PeoplePanel_toConsumableArray(null!==(_old$eventPeople$filt=null===(_old$eventPeople=old.eventPeople)||void 0===_old$eventPeople?void 0:_old$eventPeople.filter((function(x){return!x.roleName||!eventPersonRoles.includes(x.roleName)})))&&void 0!==_old$eventPeople$filt?_old$eventPeople$filt:[]),PeoplePanel_toConsumableArray(newPeople.filter((function(x){var _mapItemPersonRoleToE;return x.eventPerson||(null!==(_mapItemPersonRoleToE=mapItemPersonRoleToEventPersonRole(x.itemPerson.roleName))&&void 0!==_mapItemPersonRoleToE?_mapItemPersonRoleToE:mapItemPersonRoleToEventPersonRole(defaultRole))})).map((function(x){var _x$eventPerson,_ref3,_mapItemPersonRoleToE2;return null!==(_x$eventPerson=x.eventPerson)&&void 0!==_x$eventPerson?_x$eventPerson:{personId:x.itemPerson.id,roleName:null!==(_ref3=null!==(_mapItemPersonRoleToE2=mapItemPersonRoleToEventPersonRole(x.itemPerson.roleName))&&void 0!==_mapItemPersonRoleToE2?_mapItemPersonRoleToE2:mapItemPersonRoleToEventPersonRole(defaultRole))&&void 0!==_ref3?_ref3:graphql.hQl.Presenter}})))),item:old.item?Object.assign({},old.item,{itemPeople:[].concat(PeoplePanel_toConsumableArray(null!==(_old$item$itemPeople$=null===(_old$item$itemPeople=old.item.itemPeople)||void 0===_old$item$itemPeople?void 0:_old$item$itemPeople.filter((function(x){return!x.roleName||!itemPersonRoles.includes(x.roleName)})))&&void 0!==_old$item$itemPeople$?_old$item$itemPeople$:[]),PeoplePanel_toConsumableArray(newPeople.filter((function(x){return x.itemPerson})).map((function(x){return x.itemPerson}))))}):{itemPeople:newPeople.filter((function(x){return x.itemPerson})).map((function(x){return x.itemPerson}))}})}))}),[defaultRole,eventPersonRoles,itemPersonRoles]),_useState8=PeoplePanel_slicedToArray((0,react.useState)(""),2),createPersonName=_useState8[0],setCreatePersonName=_useState8[1],_useState10=PeoplePanel_slicedToArray((0,react.useState)(null),2),createPersonRegistrantId=_useState10[0],setCreatePersonRegistrantId=_useState10[1],createPersonDisclosure=(0,chakra_ui_hooks_esm.qY)(),onCreatePerson=(0,react.useCallback)((function(personId){refetchPeople(),onAnyChange(),updateMergedPeople([].concat(PeoplePanel_toConsumableArray(mergedPeople),[{eventPerson:mapItemPersonRoleToEventPersonRole(defaultRole)?{personId,roleName:mapItemPersonRoleToEventPersonRole(defaultRole)}:void 0,itemPerson:{personId,priority:es.qr6((function(x){return!(null==x||!x.itemPerson)}),mergedPeople)+1,roleName:defaultRole}}]))}),[defaultRole,mergedPeople,onAnyChange,refetchPeople,updateMergedPeople]);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)(chakra_ui_input_esm.BZ,{w:"100%",children:[(0,jsx_runtime.jsx)(chakra_ui_input_esm.Ui,{children:isSearching?(0,jsx_runtime.jsx)(chakra_ui_spinner_esm.$,{}):(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"search"})}),(0,jsx_runtime.jsx)(MultiSelect.q4,{placeholder:"Start typing to search people",onInputChange:function onInputChange(value){setSearchTerm(value)},value:null,onChange:function onChange(value,action){if(value&&("create-option"===action.action||"select-option"===action.action)){var optionType=value.value.split("")[0],id=value.value.split("")[1];"create"===optionType?(setCreatePersonName(""),setCreatePersonRegistrantId(null),createPersonDisclosure.onOpen()):"registrant"===optionType?(setCreatePersonName(""),setCreatePersonRegistrantId(id),createPersonDisclosure.onOpen()):"person"===optionType&&(itemPeople.some((function(x){return x.personId===id}))||eventPeople.some((function(x){return x.personId===id}))||updateMergedPeople([].concat(PeoplePanel_toConsumableArray(mergedPeople),[{eventPerson:mapItemPersonRoleToEventPersonRole(defaultRole)?{personId:id,roleName:mapItemPersonRoleToEventPersonRole(defaultRole)}:void 0,itemPerson:{personId:id,priority:es.qr6((function(x){return!(null==x||!x.itemPerson)}),mergedPeople)+1,roleName:defaultRole}}])))}},options:searchedOptions,styles:{container:function container(base){return Object.assign({},base,{width:"100%"})}}})]}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.aV,{spacing:2,w:"100%",children:mergedPeople.map((function(person,idx){var _ref4,_person$eventPerson$p,_person$eventPerson,_person$itemPerson,_peopleResponse$data12,_peopleResponse$data$3,_peopleResponse$data$4,_person$itemPerson$ro,_ref5,_person$itemPerson$ro2,_person$itemPerson3,_person$eventPerson3;return(0,jsx_runtime.jsx)(chakra_ui_layout_esm.HC,{children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.kC,{w:"100%",children:[person.itemPerson?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(chakra_ui_button_esm.hU,{"aria-label":"Move person up",icon:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"arrow-circle-up"}),variant:"ghost",size:"sm",isDisabled:0===idx,onClick:function onClick(){for(var newPeople=[],i=0;i<mergedPeople.length;i++){var p=mergedPeople[i];p.itemPerson?i===idx?newPeople.push(Object.assign({},p,{itemPerson:Object.assign({},p.itemPerson,{priority:i-1})})):i===idx-1?newPeople.push(Object.assign({},p,{itemPerson:Object.assign({},p.itemPerson,{priority:i+1})})):newPeople.push(Object.assign({},p,{itemPerson:Object.assign({},p.itemPerson,{priority:i})})):newPeople.push(p)}updateMergedPeople(newPeople)}}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.hU,{"aria-label":"Move person down",icon:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"arrow-circle-down"}),variant:"ghost",size:"sm",isDisabled:idx===es.qr6((function(x){return!(null==x||!x.itemPerson)}),mergedPeople),onClick:function onClick(){for(var newPeople=[],i=0;i<mergedPeople.length;i++){var p=mergedPeople[i];p.itemPerson?i===idx?newPeople.push(Object.assign({},p,{itemPerson:Object.assign({},p.itemPerson,{priority:i+1})})):i===idx+1?newPeople.push(Object.assign({},p,{itemPerson:Object.assign({},p.itemPerson,{priority:i-1})})):newPeople.push(Object.assign({},p,{itemPerson:Object.assign({},p.itemPerson,{priority:i})})):newPeople.push(p)}updateMergedPeople(newPeople)}})]}):void 0,person.eventPerson?(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:person.itemPerson?"Click to hide person from public schedule":"Click to show person in public schedule",children:(0,jsx_runtime.jsx)(chakra_ui_button_esm.hU,{"aria-label":person.itemPerson?"Click to hide person from public schedule":"Click to show person in public schedule",icon:person.itemPerson?(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"eye"}):(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"eye-slash"}),variant:"ghost",size:"sm",onClick:function onClick(){for(var newPeople=[],i=0;i<mergedPeople.length;i++){var p=mergedPeople[i];idx===i?p.eventPerson?newPeople.push({itemPerson:p.itemPerson?void 0:{personId:p.eventPerson.personId,priority:i,roleName:defaultRole},eventPerson:p.eventPerson}):newPeople.push({itemPerson:void 0,eventPerson:{personId:p.itemPerson.personId,roleName:mapItemPersonRoleToEventPersonRole(p.itemPerson.roleName)}}):newPeople.push(p)}updateMergedPeople(newPeople)}})}):void 0,(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.kC,{w:"100%",alignItems:"center",pb:"2px",px:2,children:[(0,jsx_runtime.jsx)(chakra_ui_system_esm.m$.span,{mr:2,children:null!==(_peopleResponse$data12=peopleResponse.data)&&void 0!==_peopleResponse$data12&&_peopleResponse$data12.collection_ProgramPerson?null!==(_peopleResponse$data$3=null===(_peopleResponse$data$4=peopleResponse.data.collection_ProgramPerson.find((function(x){var _person$eventPerson2,_person$itemPerson2;return x.id===(null===(_person$eventPerson2=person.eventPerson)||void 0===_person$eventPerson2?void 0:_person$eventPerson2.personId)||x.id===(null===(_person$itemPerson2=person.itemPerson)||void 0===_person$itemPerson2?void 0:_person$itemPerson2.personId)})))||void 0===_peopleResponse$data$4?void 0:_peopleResponse$data$4.name)&&void 0!==_peopleResponse$data$3?_peopleResponse$data$3:"<Unknown>":"<Loading...>"}),hideRole?void 0:(0,jsx_runtime.jsx)(chakra_ui_tooltip_esm.u,{label:person.itemPerson?"Role name shown to attendees to aid understanding. Does not affect permissions.":"",children:person.itemPerson&&roleOptions.length<=1?(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{ml:"auto",fontSize:"sm",children:null!==(_person$itemPerson$ro=person.itemPerson.roleName)&&void 0!==_person$itemPerson$ro?_person$itemPerson$ro:"<Role unknown>"}):!person.itemPerson&&eventPersonRoles.length<=1?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{}):(0,jsx_runtime.jsx)(chakra_ui_select_esm.Ph,{w:"max-content",minW:0,size:"sm",ml:"auto",value:null!==(_ref5=null!==(_person$itemPerson$ro2=null===(_person$itemPerson3=person.itemPerson)||void 0===_person$itemPerson3?void 0:_person$itemPerson3.roleName)&&void 0!==_person$itemPerson$ro2?_person$itemPerson$ro2:null===(_person$eventPerson3=person.eventPerson)||void 0===_person$eventPerson3?void 0:_person$eventPerson3.roleName)&&void 0!==_ref5?_ref5:"",onChange:function onChange(ev){updateMergedPeople(mergedPeople.map((function(x,i){var _ref6,_mapItemPersonRoleToE3;return i===idx?x.eventPerson?{itemPerson:x.itemPerson?Object.assign({},x.itemPerson,{roleName:ev.target.value}):void 0,eventPerson:Object.assign({},x.eventPerson,{roleName:person.itemPerson?null!==(_ref6=null!==(_mapItemPersonRoleToE3=mapItemPersonRoleToEventPersonRole(ev.target.value))&&void 0!==_mapItemPersonRoleToE3?_mapItemPersonRoleToE3:mapItemPersonRoleToEventPersonRole(defaultRole))&&void 0!==_ref6?_ref6:graphql.hQl.Presenter:ev.target.value})}:{itemPerson:Object.assign({},x.itemPerson,{roleName:ev.target.value}),eventPerson:void 0}:x})))},children:person.itemPerson?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:roleOptions.map((function(opt){return(0,jsx_runtime.jsx)("option",{value:opt.value,children:opt.label},opt.value)}))}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:eventPersonRoles.map((function(opt){return(0,jsx_runtime.jsx)("option",{value:opt,children:eventPersonRoleToLabel(opt)},opt)}))})})})]}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.hU,{"aria-label":"Remove person",icon:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"times"}),variant:"ghost",size:"sm",onClick:function onClick(){updateMergedPeople(mergedPeople.filter((function(_,i){return i!==idx})))}})]})},"person-"+idx+"-"+(null!==(_ref4=null!==(_person$eventPerson$p=null===(_person$eventPerson=person.eventPerson)||void 0===_person$eventPerson?void 0:_person$eventPerson.personId)&&void 0!==_person$eventPerson$p?_person$eventPerson$p:null===(_person$itemPerson=person.itemPerson)||void 0===_person$itemPerson?void 0:_person$itemPerson.id)&&void 0!==_ref4?_ref4:"unknown"))}))}),(0,jsx_runtime.jsx)(CreatePersonModal,{initialName:createPersonName,initialExistingRegistrantId:createPersonRegistrantId,isOpen:createPersonDisclosure.isOpen,onClose:createPersonDisclosure.onClose,onCreate:onCreatePerson})]})}(0,urql_core.Ps)(PeoplePanel_templateObject||(PeoplePanel_templateObject=function PeoplePanel_taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(["\n    fragment ManageSchedule_Person on collection_ProgramPerson {\n        id\n        name\n        affiliation\n        email\n        registrantId\n    }\n\n    fragment ManageSchedule_Registrant on registrant_Registrant {\n        id\n        displayName\n        invitation {\n            invitedEmailAddress\n        }\n    }\n\n    query ManageSchedule_SearchPeople($conferenceId: uuid!, $subconferenceId: uuid, $search: String!) {\n        registrant_searchRegistrants(args: { conferenceid: $conferenceId, search: $search }, limit: 10) {\n            ...ManageSchedule_Registrant\n        }\n        collection_searchProgramPerson(\n            args: { conferenceid: $conferenceId, subconferenceid: $subconferenceId, search: $search }\n            limit: 10\n        ) {\n            ...ManageSchedule_Person\n        }\n    }\n\n    query ManageSchedule_GetPeople($ids: [uuid!]!) {\n        collection_ProgramPerson(where: { id: { _in: $ids } }) {\n            ...ManageSchedule_Person\n        }\n    }\n"]))),PeoplePanel.displayName="PeoplePanel";try{mapItemPersonRoleToEventPersonRole.displayName="mapItemPersonRoleToEventPersonRole",mapItemPersonRoleToEventPersonRole.__docgenInfo={description:"",displayName:"mapItemPersonRoleToEventPersonRole",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/Schedule/Components/PeoplePanel.tsx#mapItemPersonRoleToEventPersonRole"]={docgenInfo:mapItemPersonRoleToEventPersonRole.__docgenInfo,name:"mapItemPersonRoleToEventPersonRole",path:"src/aspects/Conference/Manage/Schedule/Components/PeoplePanel.tsx#mapItemPersonRoleToEventPersonRole"})}catch(__react_docgen_typescript_loader_error){}try{PeoplePanel.displayName="PeoplePanel",PeoplePanel.__docgenInfo={description:"",displayName:"PeoplePanel",props:{isCreate:{defaultValue:null,description:"",name:"isCreate",required:!0,type:{name:"boolean"}},isDisabled:{defaultValue:null,description:"",name:"isDisabled",required:!0,type:{name:"boolean"}},firstInputRef:{defaultValue:null,description:"",name:"firstInputRef",required:!0,type:{name:"MutableRefObject<HTMLButtonElement | HTMLInputElement | HTMLSelectElement | null>"}},clearState:{defaultValue:null,description:"",name:"clearState",required:!0,type:{name:"MutableRefObject<(() => void) | null>"}},record:{defaultValue:null,description:"",name:"record",required:!0,type:{name:"DeepPartial<ScheduleEditorRecord>"}},updateRecord:{defaultValue:null,description:"",name:"updateRecord",required:!0,type:{name:"(record: DeepPartial<ScheduleEditorRecord> | ((old: DeepPartial<ScheduleEditorRecord>) => DeepPartial<ScheduleEditorRecord>)) => void"}},onValid:{defaultValue:null,description:"",name:"onValid",required:!0,type:{name:"() => void"}},onInvalid:{defaultValue:null,description:"",name:"onInvalid",required:!0,type:{name:"(error: ValidationError) => void"}},onAnyChange:{defaultValue:null,description:"",name:"onAnyChange",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/Schedule/Components/PeoplePanel.tsx#PeoplePanel"]={docgenInfo:PeoplePanel.__docgenInfo,name:"PeoplePanel",path:"src/aspects/Conference/Manage/Schedule/Components/PeoplePanel.tsx#PeoplePanel"})}catch(__react_docgen_typescript_loader_error){}__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.number.to-fixed.js");var PresentationsList_templateObject,chakra_ui_tag_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+tag@1.2.5_d5de66fc214059f645050e36d066c00a/node_modules/@chakra-ui/tag/dist/chakra-ui-tag.esm.js"),Card=__webpack_require__("./src/aspects/Card/index.tsx"),LinkButton=__webpack_require__("./src/aspects/Chakra/LinkButton.tsx"),useSelectorColors=__webpack_require__("./src/aspects/Card/useSelectorColors.ts");function Tags(_ref){var tags=_ref.tags,itemTags=_ref.itemTags,onEdit=_ref.onEdit,matchedTags=(0,react.useMemo)((function(){return es.HCG([function(a,b){var _a$tag,_b$tag;return(0,maybeCompare.D)(null===(_a$tag=a.tag)||void 0===_a$tag?void 0:_a$tag.priority,null===(_b$tag=b.tag)||void 0===_b$tag?void 0:_b$tag.priority,(function(x,y){return x-y}))},function(a,b){var _a$tag2,_b$tag2;return(0,maybeCompare.D)(null===(_a$tag2=a.tag)||void 0===_a$tag2?void 0:_a$tag2.name,null===(_b$tag2=b.tag)||void 0===_b$tag2?void 0:_b$tag2.name,(function(x,y){return x.localeCompare(y)}))}],itemTags.map((function(itemTag){return{itemTag,tag:tags.find((function(x){return x.id===itemTag.tagId}))}}))).slice(0,3)}),[itemTags,tags]);return(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Eq,{children:[matchedTags.map((function(tag,idx){var _tag$tag$name,_tag$tag;return(0,jsx_runtime.jsx)(chakra_ui_layout_esm.Uc,{children:(0,jsx_runtime.jsx)(chakra_ui_tag_esm.Vp,{borderRadius:"full",colorScheme:"gray",onClick:function onClick(ev){onEdit(),ev.stopPropagation()},_hover:{bgColor:"gray.400"},children:null!==(_tag$tag$name=null===(_tag$tag=tag.tag)||void 0===_tag$tag?void 0:_tag$tag.name)&&void 0!==_tag$tag$name?_tag$tag$name:"<unknown>"})},idx)})),matchedTags.length<itemTags.length?(0,jsx_runtime.jsx)(chakra_ui_layout_esm.Uc,{children:(0,jsx_runtime.jsxs)(chakra_ui_tag_esm.Vp,{borderRadius:"full",colorScheme:"gray",onClick:function onClick(ev){onEdit(),ev.stopPropagation()},_hover:{bgColor:"gray.400"},children:[itemTags.length-matchedTags.length," more"]})}):void 0,0===itemTags.length?(0,jsx_runtime.jsx)(chakra_ui_layout_esm.Uc,{children:(0,jsx_runtime.jsx)(chakra_ui_tag_esm.Vp,{borderRadius:"full",colorScheme:"gray",onClick:function onClick(ev){onEdit(),ev.stopPropagation()},_hover:{bgColor:"gray.400"},children:"+ Add tag"})}):void 0]})}Tags.displayName="Tags";try{Tags.displayName="Tags",Tags.__docgenInfo={description:"",displayName:"Tags",props:{tags:{defaultValue:null,description:"",name:"tags",required:!0,type:{name:"readonly ManageSchedule_TagFragment[]"}},itemTags:{defaultValue:null,description:"",name:"itemTags",required:!0,type:{name:"readonly ManageSchedule_ItemTagFragment[]"}},onEdit:{defaultValue:null,description:"",name:"onEdit",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/Schedule/Components/Tags.tsx#Tags"]={docgenInfo:Tags.__docgenInfo,name:"Tags",path:"src/aspects/Conference/Manage/Schedule/Components/Tags.tsx#Tags"})}catch(__react_docgen_typescript_loader_error){}function PresentationCard_toConsumableArray(arr){return function PresentationCard_arrayWithoutHoles(arr){if(Array.isArray(arr))return PresentationCard_arrayLikeToArray(arr)}(arr)||function PresentationCard_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function PresentationCard_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return PresentationCard_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return PresentationCard_arrayLikeToArray(o,minLen)}(arr)||function PresentationCard_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function PresentationCard_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function PresentationCard(_ref){var _presentation$item2,_presentation$item4,_presentation$item$el,_presentation$item5,_presentation$item5$e,_presentation$item$ti,_presentation$item6,_presentation$item$it2,_presentation$item7,presentation=_ref.presentation,tags=_ref.tags,_onEdit=_ref.onEdit,onDelete=_ref.onDelete,conferencePath=(0,AuthParameters.h)().conferencePath,ref=(0,react.useRef)(null),start=(0,react.useMemo)((function(){return presentation.scheduledStartTime?new Date(presentation.scheduledStartTime):null}),[presentation.scheduledStartTime]),end=(0,react.useMemo)((function(){return presentation.scheduledEndTime?new Date(presentation.scheduledEndTime):null}),[presentation.scheduledEndTime]),duration=(0,react.useMemo)((function(){return start&&end?Math.round((end.getTime()-start.getTime())/6e4):null}),[end,start]),now=(0,useRealTime.$)(6e4),isLive=Boolean(start&&end&&now>=start.getTime()&&now<=end.getTime()),abstractData=(0,react.useMemo)((function(){var _presentation$item,_presentation$item$ab,_presentation$item$ab2,_presentation$item$ab3,_presentation$item$ab4;return null===(_presentation$item=presentation.item)||void 0===_presentation$item||null===(_presentation$item$ab=_presentation$item.abstract)||void 0===_presentation$item$ab||null===(_presentation$item$ab2=_presentation$item$ab[0])||void 0===_presentation$item$ab2||null===(_presentation$item$ab3=_presentation$item$ab2.data)||void 0===_presentation$item$ab3||null===(_presentation$item$ab4=_presentation$item$ab3[0])||void 0===_presentation$item$ab4?void 0:_presentation$item$ab4.data}),[null===(_presentation$item2=presentation.item)||void 0===_presentation$item2?void 0:_presentation$item2.abstract]),peopleCount=(0,react.useMemo)((function(){var _presentation$item$it,_presentation$item3;return es.jj$([].concat(PresentationCard_toConsumableArray(presentation.eventPeople.map((function(x){return x.personId}))),PresentationCard_toConsumableArray(null!==(_presentation$item$it=null===(_presentation$item3=presentation.item)||void 0===_presentation$item3?void 0:_presentation$item3.itemPeople.map((function(x){return x.personId})))&&void 0!==_presentation$item$it?_presentation$item$it:[]))).length}),[presentation.eventPeople,null===(_presentation$item4=presentation.item)||void 0===_presentation$item4?void 0:_presentation$item4.itemPeople]),elementCount=null!==(_presentation$item$el=null===(_presentation$item5=presentation.item)||void 0===_presentation$item5||null===(_presentation$item5$e=_presentation$item5.elements_aggregate.aggregate)||void 0===_presentation$item5$e?void 0:_presentation$item5$e.count)&&void 0!==_presentation$item$el?_presentation$item$el:0;return(0,jsx_runtime.jsx)(chakra_ui_layout_esm.gC,{minW:"400px",w:"100%",alignItems:"flex-start",children:(0,jsx_runtime.jsxs)(Card.Z,{ref,subHeading:start&&end&&duration?start.toLocaleString(void 0,{hour:"numeric",minute:"numeric"})+" - "+end.toLocaleString(void 0,{hour:"numeric",minute:"numeric"})+" ("+(duration>=60?Math.floor(duration/60).toFixed(0)+" hr"+(duration>=120?"s":"")+(duration%60!=0?" ":""):"")+(duration%60!=0?duration%60+" mins":"")+")":void 0,heading:null!==(_presentation$item$ti=null===(_presentation$item6=presentation.item)||void 0===_presentation$item6?void 0:_presentation$item6.title)&&void 0!==_presentation$item$ti?_presentation$item$ti:presentation.name,w:"100%",editControls:[].concat(PresentationCard_toConsumableArray(isLive?[(0,jsx_runtime.jsx)(LinkButton.Qj,{colorScheme:"LiveActionButton",to:conferencePath+"/room/"+presentation.roomId,variant:"solid",size:"md",linkProps:{target:"_blank",borderRadius:"full",overflow:"hidden",minH:0,minW:0,h:"auto",p:0,m:0,lineHeight:"1em"},onClick:function onClick(ev){ev.stopPropagation()},p:1,minW:0,h:"auto",minH:0,lineHeight:"1em",m:0,children:"LIVE"},"live-button")]:[]),PresentationCard_toConsumableArray(presentation.itemId?[(0,jsx_runtime.jsx)(LinkButton.Qj,{colorScheme:"PrimaryActionButton",to:conferencePath+"/item/"+presentation.itemId,"aria-label":"View session",variant:"ghost",size:"md",linkProps:{target:"_blank",borderRadius:"full",overflow:"hidden",minH:0,minW:0,h:"auto",p:0,m:0,lineHeight:"1em"},onClick:function onClick(ev){ev.stopPropagation()},p:1,minW:0,h:"auto",minH:0,lineHeight:"1em",m:0,children:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"link"})},"link-button")]:[]),[(0,jsx_runtime.jsx)(chakra_ui_button_esm.hU,{colorScheme:"PrimaryActionButton","aria-label":"Edit presentation",icon:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"edit"}),size:"md",variant:"ghost",p:1,minW:0,h:"auto",minH:0,m:0,lineHeight:"1em",borderRadius:"full",onClick:function onClick(ev){_onEdit(),ev.stopPropagation()}},"edit-button"),(0,jsx_runtime.jsxs)(chakra_ui_menu_esm.v2,{placement:"bottom-end",children:[(0,jsx_runtime.jsx)(chakra_ui_menu_esm.j2,{"aria-label":"More options",as:chakra_ui_button_esm.hU,icon:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"ellipsis-v",mx:1}),colorScheme:"PrimaryActionButton",size:"md",variant:"ghost",p:1,minW:0,h:"auto",minH:0,m:0,lineHeight:"1em",borderRadius:"full",onClick:function onClick(ev){ev.stopPropagation()}}),(0,jsx_runtime.jsx)(chakra_ui_menu_esm.qy,{minW:"max-content",textAlign:"right",children:(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{color:"DestructiveActionButton.400",onClick:function onClick(ev){onDelete(),ev.stopPropagation()},children:"Delete"})})]},"more-options-menu")]),children:[abstractData?(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{noOfLines:3,children:abstractData.text}):void 0,(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{w:"100%",alignItems:"flex-start",children:[(0,jsx_runtime.jsx)(Tags,{tags,itemTags:null!==(_presentation$item$it2=null===(_presentation$item7=presentation.item)||void 0===_presentation$item7?void 0:_presentation$item7.itemTags)&&void 0!==_presentation$item$it2?_presentation$item$it2:[],onEdit:function onEdit(){_onEdit(0)}}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.LZ,{}),(0,jsx_runtime.jsx)(chakra_ui_tag_esm.Vp,{colorScheme:"blue",variant:"subtle",borderRadius:"full",minW:"max-content",whiteSpace:"nowrap",overflow:"hidden",onClick:function onClick(ev){_onEdit(1),ev.stopPropagation()},_hover:{bgColor:"blue.400"},children:peopleCount>0?peopleCount+" "+(1===peopleCount?"person":"people"):"+ Add people"}),(0,jsx_runtime.jsx)(chakra_ui_tag_esm.Vp,{colorScheme:"yellow",variant:"subtle",borderRadius:"full",minW:"max-content",whiteSpace:"nowrap",overflow:"hidden",onClick:function onClick(ev){_onEdit(2),ev.stopPropagation()},_hover:{bgColor:"yellow.400"},children:elementCount>0?"Content: "+elementCount:"+ Add content"})]})]})})}PresentationCard.displayName="PresentationCard";try{PresentationCard.displayName="PresentationCard",PresentationCard.__docgenInfo={description:"",displayName:"PresentationCard",props:{presentation:{defaultValue:null,description:"",name:"presentation",required:!0,type:{name:"ManageSchedule_PresentationFragment"}},tags:{defaultValue:null,description:"",name:"tags",required:!0,type:{name:"readonly ManageSchedule_TagFragment[]"}},onEdit:{defaultValue:null,description:"",name:"onEdit",required:!0,type:{name:"(initialStepIdx?: number | undefined) => void"}},onDelete:{defaultValue:null,description:"",name:"onDelete",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/Schedule/Components/PresentationCard.tsx#PresentationCard"]={docgenInfo:PresentationCard.__docgenInfo,name:"PresentationCard",path:"src/aspects/Conference/Manage/Schedule/Components/PresentationCard.tsx#PresentationCard"})}catch(__react_docgen_typescript_loader_error){}function PresentationsList_slicedToArray(arr,i){return function PresentationsList_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function PresentationsList_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function PresentationsList_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return PresentationsList_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return PresentationsList_arrayLikeToArray(o,minLen)}(arr,i)||function PresentationsList_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function PresentationsList_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function PresentationsList(_ref){var _presentationsRespons,_presentationsRespons2,sessionId=_ref.sessionId,tags=_ref.tags,onCreate=_ref.onCreate,onCreateForExistingContent=_ref.onCreateForExistingContent,_onEdit=_ref.onEdit,_onDelete=_ref.onDelete,refetchPresentations=_ref.refetchPresentations,subconferenceId=(0,AuthParameters.h)().subconferenceId,context=(0,react.useMemo)((function(){var _makeContext;return(0,make_context.f)(((_makeContext={})[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext))}),[subconferenceId]),_useManageSchedule_Ge2=PresentationsList_slicedToArray((0,graphql.jxf)({variables:{sessionId},context,requestPolicy:"cache-and-network"}),2),presentationsResponse=_useManageSchedule_Ge2[0],refetch=_useManageSchedule_Ge2[1],presentations=null!==(_presentationsRespons=null===(_presentationsRespons2=presentationsResponse.data)||void 0===_presentationsRespons2?void 0:_presentationsRespons2.schedule_Event)&&void 0!==_presentationsRespons?_presentationsRespons:[];(0,react.useEffect)((function(){refetchPresentations&&(refetchPresentations.current=function(){refetch({requestPolicy:"cache-and-network"})})}),[refetch,refetchPresentations]);var outlineColor=(0,useSelectorColors.Z)().outlineColor;return(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{pt:4,pl:24,alignItems:"flex-start",w:"100%",zIndex:1,spacing:4,children:[presentationsResponse.fetching?(0,jsx_runtime.jsx)(chakra_ui_spinner_esm.$,{}):void 0,0===presentations.length?void 0:presentations.map((function(presentation,idx){return(0,jsx_runtime.jsx)(PresentationCard,{presentation,tags,onEdit:function onEdit(idx){return _onEdit(presentation,idx)},onDelete:function onDelete(){return _onDelete(presentation.id)}},idx)})),(0,jsx_runtime.jsxs)(Card.Z,{variant:"outline",isSelectable:!0,hideSelectButton:!0,w:"100%",borderStyle:"dashed",borderWidth:3,borderColor:"gray.400",onClick:onCreate,pos:"relative",children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xv,{w:"100%",textAlign:"center",_groupHover:{color:outlineColor},_groupActive:{color:outlineColor},_groupFocus:{color:outlineColor},children:[(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"plus",verticalAlign:"middle"})," ",(0,jsx_runtime.jsx)(chakra_ui_system_esm.m$.span,{fontWeight:"bold",verticalAlign:"middle",children:"Add presentation"})]}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{h:4}),(0,jsx_runtime.jsxs)(chakra_ui_menu_esm.v2,{placement:"bottom-end",children:[(0,jsx_runtime.jsx)(chakra_ui_menu_esm.j2,{as:chakra_ui_button_esm.zx,pos:"absolute",top:-2,right:0,onClick:function onClick(ev){ev.stopPropagation()},minW:0,minH:0,p:0,m:0,w:"3ex",h:"3ex",variant:"outline",colorScheme:"blue",borderTopRightRadius:"xl",children:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.ChevronDownIcon,{fontSize:"xl"})}),(0,jsx_runtime.jsx)(chakra_ui_menu_esm.qy,{children:(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{onClick:function onClick(ev){ev.stopPropagation(),onCreateForExistingContent("Existing content",[graphql.gqi.Demonstration,graphql.gqi.Keynote,graphql.gqi.Other,graphql.gqi.Paper,graphql.gqi.Poster,graphql.gqi.Presentation,graphql.gqi.SessionQAndA])},children:"Add for existing content"})})]})]}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xu,{h:4,children:""})]})}(0,urql_core.Ps)(PresentationsList_templateObject||(PresentationsList_templateObject=function PresentationsList_taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(["\n    fragment ManageSchedule_Presentation on schedule_Event {\n        id\n        conferenceId\n        subconferenceId\n        sessionEventId\n\n        scheduledStartTime\n        scheduledEndTime\n\n        name\n        itemId\n\n        roomId\n\n        item {\n            ...ManageSchedule_EventContent\n        }\n\n        eventPeople {\n            ...ManageSchedule_EventPerson\n        }\n    }\n\n    query ManageSchedule_GetPresentations($sessionId: uuid!) {\n        schedule_Event(\n            where: { sessionEventId: { _eq: $sessionId } }\n            order_by: [{ scheduledStartTime: asc_nulls_last }]\n        ) {\n            ...ManageSchedule_Presentation\n        }\n    }\n"]))),PresentationsList.displayName="PresentationsList";try{PresentationsList.displayName="PresentationsList",PresentationsList.__docgenInfo={description:"",displayName:"PresentationsList",props:{sessionId:{defaultValue:null,description:"",name:"sessionId",required:!0,type:{name:"string"}},tags:{defaultValue:null,description:"",name:"tags",required:!0,type:{name:"readonly ManageSchedule_TagFragment[]"}},onCreate:{defaultValue:null,description:"",name:"onCreate",required:!0,type:{name:"() => void"}},onCreateForExistingContent:{defaultValue:null,description:"",name:"onCreateForExistingContent",required:!0,type:{name:"(typeDisplayName: string, typeNames: Content_ItemType_Enum[]) => void"}},onEdit:{defaultValue:null,description:"",name:"onEdit",required:!0,type:{name:"(presentation: ManageSchedule_PresentationFragment, initialStepIdx?: number | undefined) => void"}},onDelete:{defaultValue:null,description:"",name:"onDelete",required:!0,type:{name:"(presentationId: string) => void"}},refetchPresentations:{defaultValue:null,description:"",name:"refetchPresentations",required:!1,type:{name:"MutableRefObject<(() => void) | null>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/Schedule/Components/PresentationsList.tsx#PresentationsList"]={docgenInfo:PresentationsList.__docgenInfo,name:"PresentationsList",path:"src/aspects/Conference/Manage/Schedule/Components/PresentationsList.tsx#PresentationsList"})}catch(__react_docgen_typescript_loader_error){}function SessionCard_toConsumableArray(arr){return function SessionCard_arrayWithoutHoles(arr){if(Array.isArray(arr))return SessionCard_arrayLikeToArray(arr)}(arr)||function SessionCard_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function SessionCard_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return SessionCard_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return SessionCard_arrayLikeToArray(o,minLen)}(arr)||function SessionCard_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function SessionCard_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function SessionCard(_ref){var _session$item2,_session$item4,_session$item$element,_session$item5,_session$item5$elemen,_session$item$title,_session$item6,_session$presentation,_session$presentation2,_session$presentation3,_session$item$itemTag,_session$item7,session=_ref.session,tags=_ref.tags,anySelected=_ref.anySelected,isSelected=_ref.isSelected,isDisabled=_ref.isDisabled,_onSelectToggle=_ref.onSelectToggle,_onEdit=_ref.onEdit,onDelete=_ref.onDelete,onExport=_ref.onExport,onCreatePresentation=_ref.onCreatePresentation,onCreatePresentationForExistingContent=_ref.onCreatePresentationForExistingContent,onEditPresentation=_ref.onEditPresentation,onDeletePresentation=_ref.onDeletePresentation,refetchPresentations=_ref.refetchPresentations,conferencePath=(0,AuthParameters.h)().conferencePath,ref=(0,react.useRef)(null),start=(0,react.useMemo)((function(){return new Date(session.scheduledStartTime)}),[session.scheduledStartTime]),end=(0,react.useMemo)((function(){return new Date(session.scheduledEndTime)}),[session.scheduledEndTime]),duration=(0,react.useMemo)((function(){return Math.round((end.getTime()-start.getTime())/6e4)}),[end,start]),now=(0,useRealTime.$)(6e4),isLive=now>=start.getTime()&&now<=end.getTime(),presentationsDisclosure=(0,chakra_ui_hooks_esm.qY)(),abstractData=(0,react.useMemo)((function(){var _session$item,_session$item$abstrac,_session$item$abstrac2,_session$item$abstrac3,_session$item$abstrac4;return null===(_session$item=session.item)||void 0===_session$item||null===(_session$item$abstrac=_session$item.abstract)||void 0===_session$item$abstrac||null===(_session$item$abstrac2=_session$item$abstrac[0])||void 0===_session$item$abstrac2||null===(_session$item$abstrac3=_session$item$abstrac2.data)||void 0===_session$item$abstrac3||null===(_session$item$abstrac4=_session$item$abstrac3[0])||void 0===_session$item$abstrac4?void 0:_session$item$abstrac4.data}),[null===(_session$item2=session.item)||void 0===_session$item2?void 0:_session$item2.abstract]),peopleCount=(0,react.useMemo)((function(){var _session$item$itemPeo,_session$item3;return es.jj$([].concat(SessionCard_toConsumableArray(session.eventPeople.map((function(x){return x.personId}))),SessionCard_toConsumableArray(null!==(_session$item$itemPeo=null===(_session$item3=session.item)||void 0===_session$item3?void 0:_session$item3.itemPeople.map((function(x){return x.personId})))&&void 0!==_session$item$itemPeo?_session$item$itemPeo:[]))).length}),[session.eventPeople,null===(_session$item4=session.item)||void 0===_session$item4?void 0:_session$item4.itemPeople]),elementCount=null!==(_session$item$element=null===(_session$item5=session.item)||void 0===_session$item5||null===(_session$item5$elemen=_session$item5.elements_aggregate.aggregate)||void 0===_session$item5$elemen?void 0:_session$item5$elemen.count)&&void 0!==_session$item$element?_session$item$element:0;return(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{minW:"400px",w:"100%",alignItems:"flex-start",children:[(0,jsx_runtime.jsxs)(Card.Z,{ref,isSelectable:!0,isSelected,isDisabled,onSelectToggle:function onSelectToggle(){_onSelectToggle()},subHeading:start.toLocaleString(void 0,{hour:"numeric",minute:"numeric"})+" - "+end.toLocaleString(void 0,{hour:"numeric",minute:"numeric"})+" ("+(duration>=60?Math.floor(duration/60).toFixed(0)+" hr"+(duration>=120?"s":"")+(duration%60!=0?" ":""):"")+(duration%60!=0?duration%60+" mins":"")+")",heading:null!==(_session$item$title=null===(_session$item6=session.item)||void 0===_session$item6?void 0:_session$item6.title)&&void 0!==_session$item$title?_session$item$title:session.name,w:"100%",bottomButton:!session.modeName||(session.exhibitionId||session.shufflePeriodId)&&!Boolean(null===(_session$presentation=session.presentations_aggregate.aggregate)||void 0===_session$presentation?void 0:_session$presentation.count)||session.modeName!==graphql.kdg.VideoChat&&session.modeName!==graphql.kdg.Livestream&&session.modeName!==graphql.kdg.External?void 0:{label:null!==(_session$presentation2=session.presentations_aggregate.aggregate)&&void 0!==_session$presentation2&&_session$presentation2.count?"Presentations":presentationsDisclosure.isOpen?"Cancel":"Add presentation",colorScheme:"blue",icon:null!==(_session$presentation3=session.presentations_aggregate.aggregate)&&void 0!==_session$presentation3&&_session$presentation3.count?presentationsDisclosure.isOpen?"chevron-up":"chevron-down":presentationsDisclosure.isOpen?"times":"plus",iconStyle:"s",onClick:function onClick(){isDisabled||presentationsDisclosure.onToggle()},variant:"ghost",showLabel:!0},editControls:anySelected?[]:[].concat(SessionCard_toConsumableArray(isLive?[(0,jsx_runtime.jsx)(LinkButton.Qj,{colorScheme:"LiveActionButton",to:conferencePath+"/room/"+session.roomId,variant:"solid",size:"md",linkProps:{target:"_blank",borderRadius:"full",overflow:"hidden",minH:0,minW:0,h:"auto",p:0,m:0,lineHeight:"1em"},onClick:function onClick(ev){ev.stopPropagation()},p:1,minW:0,h:"auto",minH:0,lineHeight:"1em",m:0,children:"LIVE"},"live-button")]:[]),SessionCard_toConsumableArray(session.itemId?[(0,jsx_runtime.jsx)(LinkButton.Qj,{colorScheme:"PrimaryActionButton",to:conferencePath+"/item/"+session.itemId,"aria-label":"View session",variant:"ghost",size:"md",linkProps:{target:"_blank",borderRadius:"full",overflow:"hidden",minH:0,minW:0,h:"auto",p:0,m:0,lineHeight:"1em"},onClick:function onClick(ev){ev.stopPropagation()},p:1,minW:0,h:"auto",minH:0,lineHeight:"1em",m:0,children:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"link"})},"link-button")]:[]),[(0,jsx_runtime.jsx)(chakra_ui_button_esm.hU,{colorScheme:"PrimaryActionButton","aria-label":"Edit session",icon:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"edit"}),size:"md",variant:"ghost",p:1,minW:0,h:"auto",minH:0,m:0,lineHeight:"1em",borderRadius:"full",onClick:function onClick(ev){_onEdit(),ev.stopPropagation()}},"edit-button"),(0,jsx_runtime.jsxs)(chakra_ui_menu_esm.v2,{placement:"bottom-end",children:[(0,jsx_runtime.jsx)(chakra_ui_menu_esm.j2,{"aria-label":"More options",as:chakra_ui_button_esm.hU,icon:(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"ellipsis-v",mx:1}),colorScheme:"PrimaryActionButton",size:"md",variant:"ghost",p:1,minW:0,h:"auto",minH:0,m:0,lineHeight:"1em",borderRadius:"full",onClick:function onClick(ev){ev.stopPropagation()}}),(0,jsx_runtime.jsxs)(chakra_ui_menu_esm.qy,{minW:"max-content",textAlign:"right",children:[(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{onClick:function onClick(ev){onExport(),ev.stopPropagation()},children:"Export"}),(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{color:"DestructiveActionButton.400",onClick:function onClick(ev){onDelete(),ev.stopPropagation()},children:"Delete"})]})]},"more-options-menu")]),children:[abstractData?(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{noOfLines:3,children:abstractData.text}):void 0,(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{w:"100%",alignItems:"flex-start",children:[(0,jsx_runtime.jsx)(Tags,{tags,itemTags:null!==(_session$item$itemTag=null===(_session$item7=session.item)||void 0===_session$item7?void 0:_session$item7.itemTags)&&void 0!==_session$item$itemTag?_session$item$itemTag:[],onEdit:function onEdit(){_onEdit(0)}}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.LZ,{}),session.modeName&&session.modeName!==graphql.kdg.VideoChat?(0,jsx_runtime.jsx)(chakra_ui_tag_esm.Vp,{borderRadius:"full",colorScheme:"purple",minW:"max-content",whiteSpace:"nowrap",overflow:"hidden",onClick:function onClick(ev){_onEdit(3),ev.stopPropagation()},_hover:{bgColor:"purple.400"},children:session.modeName}):void 0,(0,jsx_runtime.jsx)(chakra_ui_tag_esm.Vp,{colorScheme:"blue",variant:"subtle",borderRadius:"full",minW:"max-content",whiteSpace:"nowrap",overflow:"hidden",onClick:function onClick(ev){_onEdit(1),ev.stopPropagation()},_hover:{bgColor:"blue.400"},children:peopleCount>0?peopleCount+" "+(1===peopleCount?"person":"people"):"+ Add people"}),(0,jsx_runtime.jsx)(chakra_ui_tag_esm.Vp,{colorScheme:"yellow",variant:"subtle",borderRadius:"full",minW:"max-content",whiteSpace:"nowrap",overflow:"hidden",onClick:function onClick(ev){_onEdit(2),ev.stopPropagation()},_hover:{bgColor:"yellow.400"},children:elementCount>0?"Content: "+elementCount:"+ Add content"})]})]}),presentationsDisclosure.isOpen?(0,jsx_runtime.jsx)(PresentationsList,{sessionId:session.id,tags,onCreate:onCreatePresentation,onCreateForExistingContent:onCreatePresentationForExistingContent,onEdit:onEditPresentation,onDelete:onDeletePresentation,refetchPresentations}):void 0]})}SessionCard.displayName="SessionCard";try{SessionCard.displayName="SessionCard",SessionCard.__docgenInfo={description:"",displayName:"SessionCard",props:{session:{defaultValue:null,description:"",name:"session",required:!0,type:{name:"ManageSchedule_SessionFragment"}},tags:{defaultValue:null,description:"",name:"tags",required:!0,type:{name:"readonly ManageSchedule_TagFragment[]"}},anySelected:{defaultValue:null,description:"",name:"anySelected",required:!0,type:{name:"boolean"}},isSelected:{defaultValue:null,description:"",name:"isSelected",required:!0,type:{name:"boolean"}},isDisabled:{defaultValue:null,description:"",name:"isDisabled",required:!1,type:{name:"boolean"}},onSelectToggle:{defaultValue:null,description:"",name:"onSelectToggle",required:!0,type:{name:"() => void"}},onEdit:{defaultValue:null,description:"",name:"onEdit",required:!0,type:{name:"(initialStepIdx?: number | undefined) => void"}},onDelete:{defaultValue:null,description:"",name:"onDelete",required:!0,type:{name:"() => void"}},onExport:{defaultValue:null,description:"",name:"onExport",required:!0,type:{name:"() => void"}},onCreatePresentation:{defaultValue:null,description:"",name:"onCreatePresentation",required:!0,type:{name:"() => void"}},onCreatePresentationForExistingContent:{defaultValue:null,description:"",name:"onCreatePresentationForExistingContent",required:!0,type:{name:"(typeDisplayName: string, typeNames: Content_ItemType_Enum[]) => void"}},onEditPresentation:{defaultValue:null,description:"",name:"onEditPresentation",required:!0,type:{name:"(presentation: ManageSchedule_PresentationFragment, initialStepIdx?: number | undefined) => void"}},onDeletePresentation:{defaultValue:null,description:"",name:"onDeletePresentation",required:!0,type:{name:"(presentationId: string) => void"}},refetchPresentations:{defaultValue:null,description:"",name:"refetchPresentations",required:!1,type:{name:"MutableRefObject<(() => void) | null>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/Schedule/Components/SessionCard.tsx#SessionCard"]={docgenInfo:SessionCard.__docgenInfo,name:"SessionCard",path:"src/aspects/Conference/Manage/Schedule/Components/SessionCard.tsx#SessionCard"})}catch(__react_docgen_typescript_loader_error){}var chakra_ui_checkbox_esm=__webpack_require__("../node_modules/.pnpm/@chakra-ui+checkbox@1.6.5_381b254eb05ba0b21fa13fc526cde82c/node_modules/@chakra-ui/checkbox/dist/chakra-ui-checkbox.esm.js"),SettingsPanel_excluded=["record"];function SettingsPanel_toConsumableArray(arr){return function SettingsPanel_arrayWithoutHoles(arr){if(Array.isArray(arr))return SettingsPanel_arrayLikeToArray(arr)}(arr)||function SettingsPanel_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||SettingsPanel_unsupportedIterableToArray(arr)||function SettingsPanel_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function SettingsPanel_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function SettingsPanel_slicedToArray(arr,i){return function SettingsPanel_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function SettingsPanel_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||SettingsPanel_unsupportedIterableToArray(arr,i)||function SettingsPanel_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function SettingsPanel_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return SettingsPanel_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?SettingsPanel_arrayLikeToArray(o,minLen):void 0}}function SettingsPanel_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function SettingsPanel_objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function SettingsPanel_objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function modeToLabel(mode){switch(mode){case graphql.kdg.Exhibition:return"Breakout video-chat (exhibition)";case graphql.kdg.External:return"External (e.g. Zoom, MS Teams or other platforms)";case graphql.kdg.Livestream:return"Live-stream";case graphql.kdg.None:return"No interaction";case graphql.kdg.Shuffle:return"Networking";case graphql.kdg.VideoChat:return"Video-chat";case graphql.kdg.VideoPlayer:return"Video player (unmonitored session mirroring)"}}function SettingsPanel(_ref){var record=_ref.record,props=SettingsPanel_objectWithoutProperties(_ref,SettingsPanel_excluded);return"sessionEventId"in record&&record.sessionEventId?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"No settings to configure."}):(0,jsx_runtime.jsx)(SessionSettingsPanel,Object.assign({record},props))}function SessionSettingsPanel(_ref2){_ref2.isCreate,_ref2.isDisabled,_ref2.clearState,_ref2.firstInputRef;var _record$id,_ref4,_record$itemId,_record$item,_record$itemId2,_record$item2,_autoPlayEventRespons,_autoPlayEventRespons2,_autoPlayEvent$exhibi3,_record$modeName2,_record$roomId2,_suitableRoomsRespons,_suitableRoomsRespons2,_record$autoPlayEleme,_record$item$external,_record$item3,_record$item3$externa,_record$item3$externa2,_record$item3$externa3,_record$item3$externa4,_record$item$external2,_record$item4,_record$item4$externa,_record$item4$externa2,_record$streamTextEve,record=_ref2.record,updateRecord=_ref2.updateRecord,onValid=_ref2.onValid,onInvalid=_ref2.onInvalid,onAnyChange=_ref2.onAnyChange,selectableModes=(0,react.useMemo)((function(){return[graphql.kdg.VideoChat,graphql.kdg.Livestream,graphql.kdg.External,graphql.kdg.VideoPlayer,graphql.kdg.None]}),[]);(0,react.useEffect)((function(){record.modeName&&void 0!==record.enableRecording&&void 0!==record.automaticParticipationSurvey||(onAnyChange(),updateRecord((function(old){var _record$modeName,_record$enableRecordi,_record$automaticPart;return Object.assign({},old,{modeName:null!==(_record$modeName=record.modeName)&&void 0!==_record$modeName?_record$modeName:graphql.kdg.VideoChat,enableRecording:null===(_record$enableRecordi=record.enableRecording)||void 0===_record$enableRecordi||_record$enableRecordi,automaticParticipationSurvey:null===(_record$automaticPart=record.automaticParticipationSurvey)||void 0===_record$automaticPart||_record$automaticPart})})))}),[record.automaticParticipationSurvey,record.enableRecording,record.modeName]),(0,react.useEffect)((function(){record.roomId?onValid():onInvalid({error:"No remaining program room quotas available."})}),[record.roomId]);var client=(0,urql_es.m8)(),conference=(0,useConference.fk)(),subconferenceId=(0,AuthParameters.h)().subconferenceId,context=(0,react.useMemo)((function(){var _makeContext;return(0,make_context.f)(((_makeContext={})[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext))}),[subconferenceId]),_useManageSchedule_Li2=SettingsPanel_slicedToArray((0,graphql.f9H)({variables:{conferenceId:conference.id,subconferenceCond:subconferenceId?{_eq:subconferenceId}:{_is_null:!0},modes:record.modeName===graphql.kdg.Livestream?[graphql.kdg.Livestream]:[graphql.kdg.Exhibition,graphql.kdg.External,graphql.kdg.None,graphql.kdg.Shuffle,graphql.kdg.VideoChat,graphql.kdg.VideoPlayer],namePattern:record.modeName===graphql.kdg.Livestream?"Live-stream Track %":"Track %"},context,requestPolicy:"cache-and-network"}),2),suitableRoomsResponse=_useManageSchedule_Li2[0],refetchSuitableRooms=_useManageSchedule_Li2[1],computingSuitableRoomRef=(0,react.useRef)(!1),_useState2=SettingsPanel_slicedToArray((0,react.useState)(!1),2),roomWasAutoSet=_useState2[0],setRoomWasAutoSet=_useState2[1];(0,react.useEffect)((function(){computingSuitableRoomRef.current||(computingSuitableRoomRef.current=!0,function SettingsPanel_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){SettingsPanel_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){SettingsPanel_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var _record$roomId,_response$data,_response$data2,response,roomId,quota,_response$data3,_roomId,_response2$data,response2,_extractActualError,_response2$data2,_roomId2,_response$data4,_roomId3,_response$data5,_response,_extractActualError2,_response$data6,_roomId4,_extractActualError3;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(_context.prev=0,null!==(_record$roomId=record.roomId)&&void 0!==_record$roomId&&_record$roomId.length&&!roomWasAutoSet||!record.modeName||!record.scheduledStartTime||!record.scheduledEndTime){_context.next=47;break}return setRoomWasAutoSet(!0),_context.next=5,client.query(graphql.O$T,{conferenceId:conference.id,subconferenceCond:subconferenceId?{_eq:subconferenceId}:{_is_null:!0},startBefore:record.scheduledEndTime,endAfter:record.scheduledStartTime,modes:record.modeName===graphql.kdg.Livestream?[graphql.kdg.Livestream]:[graphql.kdg.Exhibition,graphql.kdg.External,graphql.kdg.None,graphql.kdg.Shuffle,graphql.kdg.VideoChat,graphql.kdg.VideoPlayer],namePattern:record.modeName===graphql.kdg.Livestream?"Live-stream Track %":"Track %"},Object.assign({},context,{requestPolicy:"network-only"})).toPromise();case 5:if(response=_context.sent,null===(_response$data=response.data)||void 0===_response$data||!_response$data.programRooms.length){_context.next=11;break}roomId=response.data.programRooms[0].id,updateRecord((function(old){return Object.assign({},old,{roomId})})),_context.next=45;break;case 11:if(null===(_response$data2=response.data)||void 0===_response$data2||!_response$data2.conference_RemainingQuota){_context.next=44;break}if(quota=response.data.conference_RemainingQuota[0],record.modeName!==graphql.kdg.Livestream){_context.next=29;break}if(!quota.remainingStreamingProgramRooms){_context.next=26;break}if(null===(_response$data3=response.data)||void 0===_response$data3||!_response$data3.nonProgramRooms.length){_context.next=20;break}_roomId=response.data.nonProgramRooms[0].id,updateRecord((function(old){return Object.assign({},old,{roomId:_roomId})})),_context.next=24;break;case 20:return _context.next=22,client.mutation(graphql.LDP,{object:{conferenceId:conference.id,managementModeName:graphql.ZvF.Public,name:"Live-stream Track "+Math.round(1e7*Math.random()),priority:8,subconferenceId}},context).toPromise();case 22:(response2=_context.sent).error?onInvalid({error:null!==(_extractActualError=(0,ExtractActualError.Z)(response2.error))&&void 0!==_extractActualError?_extractActualError:"Unknown error creating a room for the session."}):null!==(_response2$data=response2.data)&&void 0!==_response2$data&&_response2$data.insert_room_Room_one&&(_roomId2=null===(_response2$data2=response2.data)||void 0===_response2$data2?void 0:_response2$data2.insert_room_Room_one.id,updateRecord((function(old){return Object.assign({},old,{roomId:_roomId2})})));case 24:_context.next=27;break;case 26:onInvalid({error:"No remaining quota for streaming rooms."});case 27:_context.next=42;break;case 29:if(!quota.remainingNonStreamingProgramRooms){_context.next=41;break}if(null===(_response$data4=response.data)||void 0===_response$data4||!_response$data4.nonProgramRooms.length){_context.next=35;break}_roomId3=response.data.nonProgramRooms[0].id,updateRecord((function(old){return Object.assign({},old,{roomId:_roomId3})})),_context.next=39;break;case 35:return _context.next=37,client.mutation(graphql.LDP,{object:{conferenceId:conference.id,managementModeName:graphql.ZvF.Public,name:"Track "+Math.round(1e7*Math.random()),priority:9,subconferenceId}},context).toPromise();case 37:(_response=_context.sent).error?onInvalid({error:null!==(_extractActualError2=(0,ExtractActualError.Z)(_response.error))&&void 0!==_extractActualError2?_extractActualError2:"Unknown error creating a room for the session."}):null!==(_response$data5=_response.data)&&void 0!==_response$data5&&_response$data5.insert_room_Room_one&&(_roomId4=null===(_response$data6=_response.data)||void 0===_response$data6?void 0:_response$data6.insert_room_Room_one.id,updateRecord((function(old){return Object.assign({},old,{roomId:_roomId4})})));case 39:_context.next=42;break;case 41:onInvalid({error:"No remaining quota for non-streaming rooms."});case 42:_context.next=45;break;case 44:response.error&&onInvalid({error:null!==(_extractActualError3=(0,ExtractActualError.Z)(response.error))&&void 0!==_extractActualError3?_extractActualError3:"Unknown error choosing a room for the session."});case 45:onAnyChange(),refetchSuitableRooms();case 47:return _context.prev=47,computingSuitableRoomRef.current=!1,_context.finish(47);case 50:case"end":return _context.stop()}}),_callee,null,[[0,,47,50]])})))())}),[client,conference.id,context,record.roomId,record.modeName,record.scheduledEndTime,record.scheduledStartTime,refetchSuitableRooms,subconferenceId]);var _useManageSchedule_Ge2=SettingsPanel_slicedToArray((0,graphql.Vk$)({variables:{sessionId:null!==(_record$id=record.id)&&void 0!==_record$id?_record$id:"00000000-0000-0000-0000-000000000000",sessionExists:Boolean(record.id),sessionItemId:null!==(_ref4=null!==(_record$itemId=record.itemId)&&void 0!==_record$itemId?_record$itemId:null===(_record$item=record.item)||void 0===_record$item?void 0:_record$item.id)&&void 0!==_ref4?_ref4:"00000000-0000-0000-0000-000000000000",sessionItemIdExists:Boolean(null!==(_record$itemId2=record.itemId)&&void 0!==_record$itemId2?_record$itemId2:null===(_record$item2=record.item)||void 0===_record$item2?void 0:_record$item2.id)},context,pause:!record.id||record.modeName!==graphql.kdg.Livestream,requestPolicy:"cache-and-network"}),2),autoPlayEventResponse=_useManageSchedule_Ge2[0],refetchAutoPlayEvents=_useManageSchedule_Ge2[1],autoPlayEvent=null===(_autoPlayEventRespons=autoPlayEventResponse.data)||void 0===_autoPlayEventRespons?void 0:_autoPlayEventRespons.schedule_Event_by_pk,autoPlayContent=null===(_autoPlayEventRespons2=autoPlayEventResponse.data)||void 0===_autoPlayEventRespons2?void 0:_autoPlayEventRespons2.content_Item_by_pk,autoPlayElementOptions=(0,react.useMemo)((function(){var _autoPlayEvent$presen,_autoPlayEvent$exhibi,_autoPlayEvent$exhibi2;return[].concat(SettingsPanel_toConsumableArray(autoPlayContent?autoPlayContent.elements.map((function(x){return{label:(null==autoPlayContent?void 0:autoPlayContent.title)+" - "+x.name,value:x.id}})):[]),SettingsPanel_toConsumableArray(null!==(_autoPlayEvent$presen=null==autoPlayEvent?void 0:autoPlayEvent.presentations.flatMap((function(pres){var _pres$item$elements$m,_pres$item;return null!==(_pres$item$elements$m=null===(_pres$item=pres.item)||void 0===_pres$item?void 0:_pres$item.elements.map((function(x){var _pres$item2;return{label:(null===(_pres$item2=pres.item)||void 0===_pres$item2?void 0:_pres$item2.title)+" - "+x.name,value:x.id}})))&&void 0!==_pres$item$elements$m?_pres$item$elements$m:[]})))&&void 0!==_autoPlayEvent$presen?_autoPlayEvent$presen:[]),SettingsPanel_toConsumableArray(null!==(_autoPlayEvent$exhibi=null==autoPlayEvent||null===(_autoPlayEvent$exhibi2=autoPlayEvent.exhibition)||void 0===_autoPlayEvent$exhibi2?void 0:_autoPlayEvent$exhibi2.items.flatMap((function(item){return item.item.elements.map((function(x){return{label:item.item.title+" - "+x.name,value:x.id}}))})))&&void 0!==_autoPlayEvent$exhibi?_autoPlayEvent$exhibi:[]))}),[autoPlayContent,null==autoPlayEvent||null===(_autoPlayEvent$exhibi3=autoPlayEvent.exhibition)||void 0===_autoPlayEvent$exhibi3?void 0:_autoPlayEvent$exhibi3.items,null==autoPlayEvent?void 0:autoPlayEvent.presentations]);return(0,react.useEffect)((function(){record.modeName===graphql.kdg.Livestream&&refetchAutoPlayEvents({requestPolicy:"network-only"})}),[record.modeName]),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{spacing:8,p:0,children:[!record.modeName||selectableModes.includes(record.modeName)?(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{id:"editor-session-mode",children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Interaction mode"}),(0,jsx_runtime.jsx)(chakra_ui_select_esm.Ph,{value:null!==(_record$modeName2=record.modeName)&&void 0!==_record$modeName2?_record$modeName2:graphql.kdg.VideoChat,onChange:function onChange(ev){onAnyChange(),updateRecord((function(old){return Object.assign({},old,{modeName:ev.target.value,roomId:void 0})}))},children:selectableModes.map((function(mode){return(0,jsx_runtime.jsx)("option",{value:mode,children:modeToLabel(mode)},mode)}))}),(0,jsx_runtime.jsx)(Explanation,{children:"Determines the way attendees and speakers will interact during this event."})]}):void 0,(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{id:"editor-session-room",children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Room"}),(0,jsx_runtime.jsxs)(chakra_ui_select_esm.Ph,{value:null!==(_record$roomId2=record.roomId)&&void 0!==_record$roomId2?_record$roomId2:"",onChange:function onChange(ev){onAnyChange(),updateRecord((function(old){return Object.assign({},old,{roomId:""===ev.target.value?void 0:ev.target.value})})),setRoomWasAutoSet(""===ev.target.value)},children:[(0,jsx_runtime.jsx)("option",{value:"",children:"Select a room"}),(0,jsx_runtime.jsx)("optgroup",{label:"Suggested rooms",children:null===(_suitableRoomsRespons=suitableRoomsResponse.data)||void 0===_suitableRoomsRespons?void 0:_suitableRoomsRespons.suggestedRooms.map((function(room){return(0,jsx_runtime.jsx)("option",{value:room.id,children:room.name},room.id)}))}),(0,jsx_runtime.jsx)("optgroup",{label:"Other rooms",children:null===(_suitableRoomsRespons2=suitableRoomsResponse.data)||void 0===_suitableRoomsRespons2?void 0:_suitableRoomsRespons2.otherRooms.filter((function(x){var _suitableRoomsRespons3;return!(null!==(_suitableRoomsRespons3=suitableRoomsResponse.data)&&void 0!==_suitableRoomsRespons3&&_suitableRoomsRespons3.suggestedRooms.some((function(y){return y.id===x.id})))})).map((function(room){return(0,jsx_runtime.jsx)("option",{value:room.id,children:room.name},room.id)}))})]}),(0,jsx_runtime.jsxs)(Explanation,{children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:"Sessions are scheduled in rooms, much like they would be in a physical venue. Rooms are flexible spaces with persistent chats. The session defines the mode of interaction within the room during the session."}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:"There is a conference-wide limit on the number of rooms with events scheduled in them (similar to the fact that a conference venue only has a finite number of rooms). Rooms should be re-used, for example by assigning all events for a single track to the same room."}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:"Midspace will attempt to automatically select a room for you but you may need to set this manually for complex schedules or special events (e.g. sessions in sponsors booths)."})]})]}),record.modeName===graphql.kdg.Livestream?(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{id:"editor-session-auto-play-video",children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Auto-play video"}),(0,jsx_runtime.jsxs)(chakra_ui_select_esm.Ph,{value:null!==(_record$autoPlayEleme=record.autoPlayElementId)&&void 0!==_record$autoPlayEleme?_record$autoPlayEleme:"",onChange:function onChange(ev){onAnyChange();var value=ev.target.value;updateRecord((function(old){return Object.assign({},old,{autoPlayElementId:value.length?value:void 0})}))},children:[(0,jsx_runtime.jsx)("option",{value:"",children:"No auto-play"}),autoPlayElementOptions.map((function(x){return(0,jsx_runtime.jsx)("option",{value:x.value,children:x.label},x.value)}))]}),(0,jsx_runtime.jsx)(Explanation,{children:"Start the session by automatically playing out the selected video."})]}):record.modeName===graphql.kdg.External?(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{spacing:2,w:"100%",alignItems:"flex-start",children:[(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{id:"editor-session-external-event-link",children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"External event link"}),(0,jsx_runtime.jsx)(chakra_ui_input_esm.II,{type:"text",value:null!==(_record$item$external=null===(_record$item3=record.item)||void 0===_record$item3||null===(_record$item3$externa=_record$item3.externalEventLink)||void 0===_record$item3$externa||null===(_record$item3$externa2=_record$item3$externa[0])||void 0===_record$item3$externa2||null===(_record$item3$externa3=_record$item3$externa2.data)||void 0===_record$item3$externa3||null===(_record$item3$externa4=_record$item3$externa3[record.item.externalEventLink[0].data.length-1])||void 0===_record$item3$externa4?void 0:_record$item3$externa4.data.url)&&void 0!==_record$item$external?_record$item$external:"",onChange:function onChange(ev){onAnyChange();var value=ev.target.value;updateRecord((function(old){var _old$item$externalEve,_old$item$externalEve2;return Object.assign({},old,{item:old.item?Object.assign({},old.item,{externalEventLink:value.length?null!==(_old$item$externalEve=old.item.externalEventLink)&&void 0!==_old$item$externalEve&&_old$item$externalEve.length?[Object.assign({},old.item.externalEventLink[0],{isHidden:!0,typeName:graphql.bK7.ExternalEventLink,uploadsRemaining:0,data:null!==(_old$item$externalEve2=old.item.externalEventLink[0].data)&&void 0!==_old$item$externalEve2&&_old$item$externalEve2.length?[Object.assign({},old.item.externalEventLink[0].data[0],{data:{baseType:content.bN.URL,type:graphql.bK7.ExternalEventLink,url:value}})]:[{createdAt:Date.now(),createdBy:"user",data:{baseType:content.bN.URL,type:graphql.bK7.ExternalEventLink,url:value}}]})]:[{name:"Zoom",isHidden:!0,typeName:graphql.bK7.ExternalEventLink,uploadsRemaining:0,data:[{createdAt:Date.now(),createdBy:"user",data:{baseType:content.bN.URL,type:graphql.bK7.ExternalEventLink,url:value}}]}]:void 0}):value.length?{externalEventLink:[{name:"Zoom",isHidden:!0,typeName:graphql.bK7.ExternalEventLink,uploadsRemaining:0,data:[{createdAt:Date.now(),createdBy:"user",data:{baseType:content.bN.URL,type:graphql.bK7.ExternalEventLink,url:value}}]}]}:void 0})}))}}),(0,jsx_runtime.jsx)(Explanation,{children:"Link for attendees to join the external event. This should include any password fields or similar (e.g. when using Zoom, include the full link provided by Zoom)."})]}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{id:"editor-session-external-event-service-name",children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"External event service name"}),(0,jsx_runtime.jsx)(chakra_ui_input_esm.II,{type:"text",value:null!==(_record$item$external2=null===(_record$item4=record.item)||void 0===_record$item4||null===(_record$item4$externa=_record$item4.externalEventLink)||void 0===_record$item4$externa||null===(_record$item4$externa2=_record$item4$externa[0])||void 0===_record$item4$externa2?void 0:_record$item4$externa2.name)&&void 0!==_record$item$external2?_record$item$external2:"Zoom",onChange:function onChange(ev){onAnyChange();var value=ev.target.value;updateRecord((function(old){var _old$item$externalEve3;return Object.assign({},old,{item:old.item?Object.assign({},old.item,{externalEventLink:value.length?null!==(_old$item$externalEve3=old.item.externalEventLink)&&void 0!==_old$item$externalEve3&&_old$item$externalEve3.length?[Object.assign({},old.item.externalEventLink[0],{name:value,isHidden:!0,typeName:graphql.bK7.ExternalEventLink,uploadsRemaining:0})]:[{name:value,data:[],isHidden:!0,typeName:graphql.bK7.ExternalEventLink,uploadsRemaining:0}]:void 0}):value.length?{externalEventLink:[{name:value,data:[],isHidden:!0,typeName:graphql.bK7.ExternalEventLink,uploadsRemaining:0}]}:void 0})}))}}),(0,jsx_runtime.jsx)(Explanation,{children:"Name of the external service, displayed as part of the button shown to attendees. E.g. Join in Zoom, where Zoom is the external service name."})]})]}):void 0,record.modeName===graphql.kdg.Livestream||record.modeName===graphql.kdg.VideoChat?(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{id:"editor-session-recording",children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Automatic recording?"}),(0,jsx_runtime.jsx)(chakra_ui_checkbox_esm.XZ,{isChecked:record.enableRecording,onChange:function onChange(ev){onAnyChange(),updateRecord((function(old){return Object.assign({},old,{enableRecording:ev.target.checked})}))}}),(0,jsx_runtime.jsxs)(Explanation,{children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:"Tick the box to enable automatic recording for this session."}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.QI,{spacing:1,children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.HC,{fontWeight:record.modeName===graphql.kdg.VideoChat?"bold":void 0,children:"For video-chat events, recording can also be started/stopped manually during the session."}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.HC,{fontWeight:record.modeName===graphql.kdg.Livestream?"bold":void 0,children:"For live-stream events, recording cannot be manually controlled - this option is the only way to enable recording."})]})]})]}):void 0,(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{id:"editor-session-participation-survey",children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Automatic participation survey?"}),(0,jsx_runtime.jsx)(chakra_ui_checkbox_esm.XZ,{isChecked:record.automaticParticipationSurvey,onChange:function onChange(ev){onAnyChange(),updateRecord((function(old){return Object.assign({},old,{automaticParticipationSurvey:ev.target.checked})}))}}),(0,jsx_runtime.jsxs)(Explanation,{children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:"Tick the box to automatically post a participation survey in the chat at the end of the session."}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:"The survey remains open for 5 minutes and allows attendees to log their attendance, provide a rating on a 5-point scale, and leave a private comment."})]})]}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"StreamText Event Id"}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{spacing:2,alignItems:"flex-start",w:"100%",children:[(0,jsx_runtime.jsx)(chakra_ui_input_esm.II,{type:"text",value:null!==(_record$streamTextEve=record.streamTextEventId)&&void 0!==_record$streamTextEve?_record$streamTextEve:"",onChange:function onChange(ev){onAnyChange(),updateRecord((function(old){return Object.assign({},old,{streamTextEventId:ev.target.value.length?ev.target.value:null})}))}}),(0,jsx_runtime.jsxs)(Explanation,{children:[(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:"The event id obtained from StreamText. This is just the id, not the full URL. Leave blank to remove the integration."}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:"StreamText is a 3rd party service for delivering real-time live captions. If you have a StreamText account you can configure an event and input your event id below. This will embed the StreamText feed within Midspace during this event."}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.xv,{children:["Learn more at"," ",(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.rU,{href:"https://streamtext.net",isExternal:!0,children:["StreamText.Net",(0,jsx_runtime.jsx)("sup",{children:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.ExternalLinkIcon,{})})]}),"."]}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children:"The Midspace platform and software are not affiliated with StreamText.Net in any way. We cannot provide support with your StreamText feed. We are not responsible for any issue caused by StreamText software embedded within this site."})]})]})]})]})}function Explanation(_ref5){var children=_ref5.children,_useState4=SettingsPanel_slicedToArray((0,react.useState)(!1),2),expanded=_useState4[0],setExpanded=_useState4[1];return(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.Q6,{children:expanded?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{spacing:1,alignItems:"flex-start",w:"100%",children:["string"==typeof children?(0,jsx_runtime.jsx)(chakra_ui_layout_esm.xv,{children}):children,(0,jsx_runtime.jsx)(chakra_ui_layout_esm.rU,{pt:1,href:"#",onClick:function onClick(ev){ev.preventDefault(),ev.stopPropagation(),setExpanded(!1)},children:"Hide"})]})}):(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.rU,{href:"#",onClick:function onClick(ev){ev.preventDefault(),ev.stopPropagation(),setExpanded(!0)},textDecoration:"none",children:[(0,jsx_runtime.jsx)(FAIcon.Z,{iconStyle:"s",icon:"info-circle",mr:1,verticalAlign:"middle"}),(0,jsx_runtime.jsx)(chakra_ui_system_esm.m$.span,{verticalAlign:"middle",children:"What is this?"})]})})}SettingsPanel.displayName="SettingsPanel",SessionSettingsPanel.displayName="SessionSettingsPanel",Explanation.displayName="Explanation";try{SettingsPanel.displayName="SettingsPanel",SettingsPanel.__docgenInfo={description:"",displayName:"SettingsPanel",props:{isCreate:{defaultValue:null,description:"",name:"isCreate",required:!0,type:{name:"boolean"}},isDisabled:{defaultValue:null,description:"",name:"isDisabled",required:!0,type:{name:"boolean"}},firstInputRef:{defaultValue:null,description:"",name:"firstInputRef",required:!0,type:{name:"MutableRefObject<HTMLButtonElement | HTMLInputElement | HTMLSelectElement | null>"}},clearState:{defaultValue:null,description:"",name:"clearState",required:!0,type:{name:"MutableRefObject<(() => void) | null>"}},record:{defaultValue:null,description:"",name:"record",required:!0,type:{name:"DeepPartial<ScheduleEditorRecord>"}},updateRecord:{defaultValue:null,description:"",name:"updateRecord",required:!0,type:{name:"(record: DeepPartial<ScheduleEditorRecord> | ((old: DeepPartial<ScheduleEditorRecord>) => DeepPartial<ScheduleEditorRecord>)) => void"}},onValid:{defaultValue:null,description:"",name:"onValid",required:!0,type:{name:"() => void"}},onInvalid:{defaultValue:null,description:"",name:"onInvalid",required:!0,type:{name:"(error: ValidationError) => void"}},onAnyChange:{defaultValue:null,description:"",name:"onAnyChange",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/Schedule/Components/SettingsPanel.tsx#SettingsPanel"]={docgenInfo:SettingsPanel.__docgenInfo,name:"SettingsPanel",path:"src/aspects/Conference/Manage/Schedule/Components/SettingsPanel.tsx#SettingsPanel"})}catch(__react_docgen_typescript_loader_error){}var ShiftTimesModal_templateObject,ManageScheduleV2_templateObject;__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.string.replace.js");function ShiftTimesModal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function ShiftTimesModal_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){ShiftTimesModal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){ShiftTimesModal_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function ShiftTimesModal_slicedToArray(arr,i){return function ShiftTimesModal_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ShiftTimesModal_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function ShiftTimesModal_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ShiftTimesModal_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ShiftTimesModal_arrayLikeToArray(o,minLen)}(arr,i)||function ShiftTimesModal_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ShiftTimesModal_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ShiftTimesModal(props){return props.isOpen?(0,jsx_runtime.jsx)(ShiftTimesModalInner,Object.assign({},props)):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{})}function ShiftTimesModalInner(_ref){var isOpen=_ref.isOpen,_onClose=_ref.onClose,eventIds=_ref.eventIds,subconferenceId=(0,AuthParameters.h)().subconferenceId,context=(0,react.useMemo)((function(){var _makeContext;return(0,make_context.f)(((_makeContext={})[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext))}),[subconferenceId]),_useManageSchedule_Sh2=ShiftTimesModal_slicedToArray((0,graphql.XOr)(),2),shiftTimesResponse=_useManageSchedule_Sh2[0],shiftTimes=_useManageSchedule_Sh2[1],_useState2=ShiftTimesModal_slicedToArray((0,react.useState)(60),2),minutes=_useState2[0],setMinutes=_useState2[1],_useState4=ShiftTimesModal_slicedToArray((0,react.useState)("60"),2),minutesStr=_useState4[0],setMinutesStr=_useState4[1];return(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.u_,{size:"2xl",isOpen,onClose:function onClose(){return _onClose(!1)},children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.ZA,{}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.hz,{children:[(0,jsx_runtime.jsx)(chakra_ui_modal_esm.ol,{}),(0,jsx_runtime.jsxs)(chakra_ui_modal_esm.xB,{children:["Shift times of ",eventIds.length," session",1===eventIds.length?"":"s"]}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.fe,{children:(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{id:"shift-minutes-distance",children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{children:"Distance (minutes)"}),(0,jsx_runtime.jsx)(chakra_ui_input_esm.II,{type:"number",value:minutesStr,onChange:function onChange(ev){setMinutes(ev.target.valueAsNumber),setMinutesStr(ev.target.value)}}),(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.Q6,{children:"The number of minutes you would like to shift the events. Use negative numbers to move events earlier in time (a shift from 11am to 10am is -60 minutes)."})]})}),(0,jsx_runtime.jsx)(chakra_ui_modal_esm.mz,{children:(0,jsx_runtime.jsxs)(chakra_ui_button_esm.hE,{children:[(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{variant:"outline",colorScheme:"blue",onClick:function onClick(){return _onClose(!1)},isDisabled:shiftTimesResponse.fetching,children:"Cancel"}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{variant:"solid",colorScheme:"PrimaryActionButton",onClick:ShiftTimesModal_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,shiftTimes({minutes,ids:"{"+eventIds.reduce((function(acc,x){return acc+',"'+x.replace(/"/g,'\\"')+'"'}),"").substring(1)+"}"},context);case 2:_onClose(!0);case 3:case"end":return _context.stop()}}),_callee)}))),isLoading:shiftTimesResponse.fetching,isDisabled:parseInt(minutesStr)!==minutes,children:"Shift times"})]})})]})]})}(0,urql_core.Ps)(ShiftTimesModal_templateObject||(ShiftTimesModal_templateObject=function ShiftTimesModal_taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(["\n    # query ManageSchedule_GetEarliestEventTime($ids: [uuid!]!) {\n    #     schedule_Event(where: { id: { _in: $ids } }, order_by: [{ scheduledStartTime: asc }], limit: 1) {\n    #         id\n    #         scheduledStartTime\n    #         name\n    #         item {\n    #             id\n    #             title\n    #         }\n    #     }\n    # }\n\n    mutation ManageSchedule_ShiftTimes($ids: _uuid, $minutes: Int!) {\n        schedule_shiftTimes(args: { eventIds: $ids, minutes: $minutes }) {\n            id\n        }\n    }\n"]))),ShiftTimesModalInner.displayName="ShiftTimesModalInner";try{ShiftTimesModal.displayName="ShiftTimesModal",ShiftTimesModal.__docgenInfo={description:"",displayName:"ShiftTimesModal",props:{isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"(didShift: boolean) => void"}},eventIds:{defaultValue:null,description:"",name:"eventIds",required:!0,type:{name:"string[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/aspects/Conference/Manage/Schedule/Components/ShiftTimesModal.tsx#ShiftTimesModal"]={docgenInfo:ShiftTimesModal.__docgenInfo,name:"ShiftTimesModal",path:"src/aspects/Conference/Manage/Schedule/Components/ShiftTimesModal.tsx#ShiftTimesModal"})}catch(__react_docgen_typescript_loader_error){}function ManageScheduleV2_toConsumableArray(arr){return function ManageScheduleV2_arrayWithoutHoles(arr){if(Array.isArray(arr))return ManageScheduleV2_arrayLikeToArray(arr)}(arr)||function ManageScheduleV2_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||ManageScheduleV2_unsupportedIterableToArray(arr)||function ManageScheduleV2_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ManageScheduleV2_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function ManageScheduleV2_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){ManageScheduleV2_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){ManageScheduleV2_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function ManageScheduleV2_slicedToArray(arr,i){return function ManageScheduleV2_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ManageScheduleV2_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||ManageScheduleV2_unsupportedIterableToArray(arr,i)||function ManageScheduleV2_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ManageScheduleV2_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return ManageScheduleV2_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ManageScheduleV2_arrayLikeToArray(o,minLen):void 0}}function ManageScheduleV2_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ManageScheduleV2(){var _tagsResponse$data2,_sessionsResponse$dat,_sessionsResponse$dat2,_sessionsResponse$dat5,_sessionsResponse$dat8,editorDisclosure=(0,chakra_ui_hooks_esm.qY)(),_useState2=ManageScheduleV2_slicedToArray((0,react.useState)(!1),2),editorIsCreate=_useState2[0],setEditorIsCreate=_useState2[1],deleteEventsDisclosure=(0,chakra_ui_hooks_esm.qY)(),shiftEventsDisclosure=(0,chakra_ui_hooks_esm.qY)(),addSessionForContentDisclosure=(0,chakra_ui_hooks_esm.qY)(),_useState4=ManageScheduleV2_slicedToArray((0,react.useState)([]),2),deleteEventIds=_useState4[0],setDeleteEventIds=_useState4[1],_useState6=ManageScheduleV2_slicedToArray((0,react.useState)("session"),2),deleteEventType=_useState6[0],setDeleteEventType=_useState6[1],_useState8=ManageScheduleV2_slicedToArray((0,react.useState)([]),2),shiftEventIds=_useState8[0],setShiftEventIds=_useState8[1],_useState10=ManageScheduleV2_slicedToArray((0,react.useState)(""),2),addSessionForContentTypeDisplayName=_useState10[0],setAddSessionForContentTypeDisplayName=_useState10[1],_useState12=ManageScheduleV2_slicedToArray((0,react.useState)([]),2),addSessionForContentTypeNames=_useState12[0],setAddSessionForContentTypeNames=_useState12[1],_useState14=ManageScheduleV2_slicedToArray((0,react.useState)("session"),2),addSessionOrPresentation=_useState14[0],setAddSessionOrPresentation=_useState14[1],_useState16=ManageScheduleV2_slicedToArray((0,react.useState)(null),2),addForExistingContentSession=_useState16[0],setAddForExistingContentSession=_useState16[1],_useState18=ManageScheduleV2_slicedToArray((0,react.useState)(0),2),initialStepIdx=_useState18[0],setInitialStepIdx=_useState18[1],_useState20=ManageScheduleV2_slicedToArray((0,react.useState)({}),2),currentRecord=_useState20[0],setCurrentRecord=_useState20[1],conference=(0,useConference.fk)(),subconferenceId=(0,AuthParameters.h)().subconferenceId,context=(0,react.useMemo)((function(){var _makeContext;return(0,make_context.f)(((_makeContext={})[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext))}),[subconferenceId]),client=(0,urql_es.m8)(),onCreateSession=(0,react.useCallback)((function(initial){setCurrentRecord(null!=initial?initial:{}),setInitialStepIdx(0),setEditorIsCreate(!0),setTimeout((function(){editorDisclosure.onOpen()}),50)}),[editorDisclosure]),onBeginCreateSessionForExistingContent=(0,react.useCallback)((function(typeDisplayName,typeNames){setAddSessionForContentTypeDisplayName(typeDisplayName),setAddSessionForContentTypeNames(typeNames),setAddSessionOrPresentation("session"),setAddForExistingContentSession(null),addSessionForContentDisclosure.onOpen()}),[addSessionForContentDisclosure]),onBeginCreatePresentationForExistingContent=(0,react.useCallback)((function(session,typeDisplayName,typeNames){setAddSessionForContentTypeDisplayName(typeDisplayName),setAddSessionForContentTypeNames(typeNames),setAddSessionOrPresentation("presentation"),setAddForExistingContentSession(session),addSessionForContentDisclosure.onOpen()}),[addSessionForContentDisclosure]),onDoCreateSessionForExistingContent=(0,react.useCallback)(function(){var _ref=ManageScheduleV2_asyncToGenerator(regeneratorRuntime.mark((function _callee(itemId,session){var _itemResponse$data,_session$roomId,_item$room,itemResponse,item;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,client.query(graphql.HG1,{id:itemId},context).toPromise();case 2:itemResponse=_context.sent,item=null===(_itemResponse$data=itemResponse.data)||void 0===_itemResponse$data?void 0:_itemResponse$data.content_Item_by_pk,setCurrentRecord({name:null==item?void 0:item.title,item,sessionEventId:null==session?void 0:session.id,roomId:null!==(_session$roomId=null==session?void 0:session.roomId)&&void 0!==_session$roomId?_session$roomId:(null==item?void 0:item.typeName)===graphql.gqi.Sponsor?null===(_item$room=item.room)||void 0===_item$room?void 0:_item$room.id:void 0,eventPeople:item?item.itemPeople.map((function(x){return{personId:x.personId,roleName:mapItemPersonRoleToEventPersonRole(x.roleName)}})):[]}),setInitialStepIdx(0),setEditorIsCreate(!0),setTimeout((function(){editorDisclosure.onOpen()}),50);case 8:case"end":return _context.stop()}}),_callee)})));return function(_x,_x2){return _ref.apply(this,arguments)}}(),[client,context,editorDisclosure]),onEditSession=(0,react.useCallback)((function(session){var initialStepIdx=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;setCurrentRecord(session),setInitialStepIdx(initialStepIdx),setEditorIsCreate(!1),setTimeout((function(){editorDisclosure.onOpen()}),50)}),[editorDisclosure]),onDeleteSessions=(0,react.useCallback)((function(ids){setDeleteEventType("session"),setDeleteEventIds(ids),deleteEventsDisclosure.onOpen()}),[deleteEventsDisclosure]),onShiftSessions=(0,react.useCallback)((function(ids){setShiftEventIds(ids),shiftEventsDisclosure.onOpen()}),[shiftEventsDisclosure]),onExportSessions=(0,react.useCallback)((function(_ids){}),[]),headerControls=function HeaderControls(onCreateSession,onCreateSessionForExistingContent){var history=(0,react_router.k6)(),conferencePath=(0,AuthParameters.h)().conferencePath;return[(0,jsx_runtime.jsxs)(chakra_ui_button_esm.hE,{isAttached:!0,children:[(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"SecondaryActionButton",borderRadius:"xl",borderRightRadius:0,onClick:function onClick(){return onCreateSession()},children:"Add a session"}),(0,jsx_runtime.jsxs)(chakra_ui_menu_esm.v2,{placement:"bottom-end",children:[(0,jsx_runtime.jsx)(chakra_ui_menu_esm.j2,{as:chakra_ui_button_esm.hU,ml:"1px",borderRadius:"xl",borderLeftRadius:0,colorScheme:"SecondaryActionButton","aria-label":"More",icon:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.ChevronDownIcon,{fontSize:"130%",fontWeight:"900"})}),(0,jsx_runtime.jsxs)(chakra_ui_menu_esm.qy,{minWidth:"auto",children:[(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{onClick:function onClick(){onCreateSession({modeName:graphql.kdg.External,item:{externalEventLink:[{name:"Zoom",isHidden:!0,typeName:graphql.bK7.ExternalEventLink,uploadsRemaining:0,data:[]}]}})},children:"Add externally-hosted session (e.g. Zoom)"}),(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{onClick:function onClick(){onCreateSessionForExistingContent("Sponsor",[graphql.gqi.Sponsor])},children:"Add session for a sponsor"}),(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{onClick:function onClick(){onCreateSessionForExistingContent("Existing content",[graphql.gqi.Session,graphql.gqi.Social,graphql.gqi.Symposium,graphql.gqi.Tutorial,graphql.gqi.Workshop])},children:"Add session for existing content"}),(0,jsx_runtime.jsx)(chakra_ui_menu_esm.sN,{onClick:function onClick(){history.push(conferencePath+"/manage/import/program")},children:"Import"})]})]})]},"add")]}(onCreateSession,onBeginCreateSessionForExistingContent),_onCreatePresentation=(0,react.useCallback)((function(session){setCurrentRecord({sessionEventId:session.id,roomId:session.roomId,session}),setInitialStepIdx(0),setEditorIsCreate(!0),setTimeout((function(){editorDisclosure.onOpen()}),50)}),[editorDisclosure]),_onEditPresentation=(0,react.useCallback)((function(session,presentation){var initialStepIdx=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;setCurrentRecord(Object.assign({},presentation,{session})),setInitialStepIdx(initialStepIdx),setEditorIsCreate(!1),setTimeout((function(){editorDisclosure.onOpen()}),50)}),[editorDisclosure]),onDeletePresentations=(0,react.useCallback)((function(ids){setDeleteEventType("presentation"),setDeleteEventIds(ids),deleteEventsDisclosure.onOpen()}),[deleteEventsDisclosure]),_useState22=ManageScheduleV2_slicedToArray((0,react.useState)(!1),2),isSaving=_useState22[0],setIsSaving=_useState22[1],_useState24=ManageScheduleV2_slicedToArray((0,react.useState)(""),2),searchName=_useState24[0],setSearchName=_useState24[1],_useState26=ManageScheduleV2_slicedToArray((0,react.useState)(void 0),2),startAfter=_useState26[0],setStartAfter=_useState26[1],_useRestorableState2=ManageScheduleV2_slicedToArray((0,useRestorableState.aX)(conference.id+"-ManageScheduleV2-ItemsPerPage",10,(function(x){return x.toString()}),(function(x){return parseInt(x,10)})),2),limit=_useRestorableState2[0],setLimit=_useRestorableState2[1],_useState28=ManageScheduleV2_slicedToArray((0,react.useState)(0),2),offset=_useState28[0],setOffset=_useState28[1],_useState30=ManageScheduleV2_slicedToArray((0,react.useState)("0"),2),offsetStr=_useState30[0],setOffsetStr=_useState30[1];(0,react.useEffect)((function(){setOffsetStr(Math.ceil(1+offset/limit).toString())}),[limit,offset]);var _useState32=ManageScheduleV2_slicedToArray((0,react.useState)({}),2),filter=_useState32[0],setFilter=_useState32[1];(0,react.useEffect)((function(){var tId=setTimeout((function(){return setFilter(Object.assign({},searchName.length>=3?{_or:[{name:{_ilike:"%"+searchName+"%"}},{item:{title:{_ilike:"%"+searchName+"%"}}}]}:{},startAfter?{scheduledStartTime:{_gte:startAfter.toISOString()}}:{}))}),500);return function(){clearTimeout(tId)}}),[searchName,startAfter]);var _useManageSchedule_Ge2=ManageScheduleV2_slicedToArray((0,graphql.j0F)({variables:{conferenceId:conference.id,subconferenceCond:subconferenceId?{_eq:subconferenceId}:{_is_null:!0},limit,offset,filter},context,requestPolicy:"cache-and-network"}),2),sessionsResponse=_useManageSchedule_Ge2[0],refetchSessions=_useManageSchedule_Ge2[1],tagsResponse=ManageScheduleV2_slicedToArray((0,graphql.PSE)({variables:{conferenceId:conference.id,subconferenceCond:subconferenceId?{_eq:subconferenceId}:{_is_null:!0}},context,requestPolicy:"cache-and-network"}),1)[0],tags=(0,react.useMemo)((function(){var _tagsResponse$data$co,_tagsResponse$data;return null!==(_tagsResponse$data$co=null===(_tagsResponse$data=tagsResponse.data)||void 0===_tagsResponse$data?void 0:_tagsResponse$data.collection_Tag)&&void 0!==_tagsResponse$data$co?_tagsResponse$data$co:[]}),[null===(_tagsResponse$data2=tagsResponse.data)||void 0===_tagsResponse$data2?void 0:_tagsResponse$data2.collection_Tag]),actualError=(0,react.useMemo)((function(){return(0,ExtractActualError.Z)(sessionsResponse.error)}),[sessionsResponse.error]),_useState34=ManageScheduleV2_slicedToArray((0,react.useState)(new Set),2),selectedSessions=_useState34[0],setSelectedSessions=_useState34[1],sessionCount=null!==(_sessionsResponse$dat=null===(_sessionsResponse$dat2=sessionsResponse.data)||void 0===_sessionsResponse$dat2?void 0:_sessionsResponse$dat2.schedule_Event.length)&&void 0!==_sessionsResponse$dat?_sessionsResponse$dat:0,pageBgColour=(0,chakra_ui_color_mode_esm.ff)("AppPage.pageBackground-light","AppPage.pageBackground-dark"),inputBgColour=(0,chakra_ui_color_mode_esm.ff)("white","#111"),bulkButtonBgColour=(0,chakra_ui_color_mode_esm.ff)("white","#111"),refetchPresentations=(0,react.useMemo)((function(){var _sessionsResponse$dat3,_sessionsResponse$dat4;return new Map(null!==(_sessionsResponse$dat3=null===(_sessionsResponse$dat4=sessionsResponse.data)||void 0===_sessionsResponse$dat4?void 0:_sessionsResponse$dat4.schedule_Event.map((function(x){return[x.id,react.createRef()]})))&&void 0!==_sessionsResponse$dat3?_sessionsResponse$dat3:[])}),[null===(_sessionsResponse$dat5=sessionsResponse.data)||void 0===_sessionsResponse$dat5?void 0:_sessionsResponse$dat5.schedule_Event]);return(0,jsx_runtime.jsxs)(DashboardPage.Y,{title:"Schedule",controls:headerControls,autoOverflow:!1,stickyHeader:0===selectedSessions.size,children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{spacing:0,justifyContent:"flex-start",alignItems:"flex-start",maxW:"800px",children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{spacing:4,w:"100%",maxW:"100%",justifyContent:"flex-start",alignItems:"flex-end",minH:"5em",pos:selectedSessions.size>0?"sticky":void 0,top:0,bgColor:pageBgColour,zIndex:1e4,pb:4,children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{spacing:2,pr:2,children:[(0,jsx_runtime.jsx)(SelectButton.Z,{"aria-label":selectedSessions.size===sessionCount?selectedSessions.size+" out of "+sessionCount+" selected. Deselect all":selectedSessions.size+" out of "+sessionCount+" selected. Select all",isSelected:selectedSessions.size===sessionCount,isIndeterminate:selectedSessions.size>0&&selectedSessions.size!==sessionCount,onToggle:function onToggle(){var _sessionsResponse$dat6,_sessionsResponse$dat7;selectedSessions.size===sessionCount?setSelectedSessions(new Set):setSelectedSessions(new Set(null!==(_sessionsResponse$dat6=null===(_sessionsResponse$dat7=sessionsResponse.data)||void 0===_sessionsResponse$dat7?void 0:_sessionsResponse$dat7.schedule_Event.map((function(x){return x.id})))&&void 0!==_sessionsResponse$dat6?_sessionsResponse$dat6:[]))},colorScheme:"blue",m:"3px",bgColor:inputBgColour}),selectedSessions.size>0?(0,jsx_runtime.jsxs)(chakra_ui_system_esm.m$.span,{flex:"0 0 max-content",whiteSpace:"nowrap",fontSize:"lg",fontWeight:"bold",children:[selectedSessions.size," / ",sessionCount]}):void 0]}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.LZ,{}),0===selectedSessions.size?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{id:"search-title",maxW:"600px",children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{color:"gray.500",mb:0,children:"Search events"}),(0,jsx_runtime.jsx)(chakra_ui_input_esm.II,{type:"text",placeholder:"Start typing",bgColor:inputBgColour,value:searchName,onChange:function onChange(ev){setSearchName(ev.target.value)}})]}),(0,jsx_runtime.jsxs)(chakra_ui_form_control_esm.NI,{id:"search-time",flex:"0 0 max-content",children:[(0,jsx_runtime.jsx)(chakra_ui_form_control_esm.lX,{color:"gray.500",mb:0,children:"Start after"}),(0,jsx_runtime.jsx)(DateTimePicker.x,{allowUndefined:!0,bgColor:inputBgColour,value:startAfter,onChange:setStartAfter})]})]}):(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{justifyContent:"flex-end",spacing:2,children:[(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"blue",variant:"outline",onClick:function onClick(){onShiftSessions(ManageScheduleV2_toConsumableArray(selectedSessions))},borderRadius:"xl",bgColor:bulkButtonBgColour,fontWeight:"400",children:"Shift times"}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.zx,{colorScheme:"DestructiveActionButton",variant:"outline",onClick:function onClick(){onDeleteSessions(ManageScheduleV2_toConsumableArray(selectedSessions))},borderRadius:"xl",bgColor:bulkButtonBgColour,fontWeight:"400",children:"Delete"})]})]}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{spacing:4,justifyContent:"flex-start",alignItems:"flex-start",w:"100%",children:[actualError?(0,jsx_runtime.jsxs)(chakra_ui_alert_esm.bZ,{status:"error",children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{children:[(0,jsx_runtime.jsx)(chakra_ui_alert_esm.zM,{}),(0,jsx_runtime.jsx)(chakra_ui_alert_esm.Cd,{children:"Error loading sessions"})]}),(0,jsx_runtime.jsx)(chakra_ui_alert_esm.X,{children:actualError})]}):void 0,sessionsResponse.fetching?(0,jsx_runtime.jsx)(chakra_ui_spinner_esm.$,{size:"lg"}):null===(_sessionsResponse$dat8=sessionsResponse.data)||void 0===_sessionsResponse$dat8?void 0:_sessionsResponse$dat8.schedule_Event.map((function(session,idx){var _sessionsResponse$dat9,previous=null===(_sessionsResponse$dat9=sessionsResponse.data)||void 0===_sessionsResponse$dat9?void 0:_sessionsResponse$dat9.schedule_Event[idx-1],previousStart=null!=previous&&previous.scheduledStartTime?new Date(previous.scheduledStartTime):void 0,thisStart=session.scheduledStartTime?new Date(session.scheduledStartTime):void 0,dateChanged=0===idx||previousStart&&thisStart&&(previousStart.getDate()!==thisStart.getDate()||previousStart.getMonth()!==thisStart.getMonth()||previousStart.getFullYear()!==thisStart.getFullYear()),card=(0,jsx_runtime.jsx)(SessionCard,{session,anySelected:selectedSessions.size>0,isSelected:selectedSessions.has(session.id),onSelectToggle:function onSelectToggle(){setSelectedSessions((function(old){var newSet=new Set(old);return old.has(session.id)?newSet.delete(session.id):newSet.add(session.id),newSet}))},onEdit:function onEdit(idx){return onEditSession(session,idx)},onDelete:function onDelete(){return onDeleteSessions([session.id])},onExport:function onExport(){return onExportSessions([session.id])},tags,onCreatePresentation:function onCreatePresentation(){return _onCreatePresentation(session)},onCreatePresentationForExistingContent:function onCreatePresentationForExistingContent(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return onBeginCreatePresentationForExistingContent.apply(void 0,[session].concat(args))},onEditPresentation:function onEditPresentation(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return _onEditPresentation.apply(void 0,[session].concat(args))},onDeletePresentation:function onDeletePresentation(id){return onDeletePresentations([id])},refetchPresentations:refetchPresentations.get(session.id)},session.id);return dateChanged?(0,jsx_runtime.jsxs)(react.Fragment,{children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.X6,{as:"h2",fontSize:"md",children:[null==thisStart?void 0:thisStart.toLocaleDateString(void 0,{day:"numeric",month:"short"}),thisStart&&(previousStart&&thisStart.getFullYear()!==previousStart.getFullYear()||0===idx&&thisStart.getFullYear()!==(new Date).getFullYear())?" "+thisStart.getFullYear():void 0]}),card]},session.id):card}))]})]}),0===selectedSessions.size?(0,jsx_runtime.jsx)(PaginationControls,{setOffset,setLimit,limit,setSelectedSessions,offset,offsetStr,setOffsetStr,sessionsResponse}):void 0,(0,jsx_runtime.jsx)(Editor,{isOpen:editorDisclosure.isOpen,onClose:editorDisclosure.onClose,isCreate:editorIsCreate,recordTypeName:currentRecord&&"sessionEventId"in currentRecord&&currentRecord.sessionEventId?"Presentation":"Session",steps:[{name:"Details",panel:DetailsPanel},{name:"People",panel:PeoplePanel},{name:"Content",panel:ContentPanel},{name:"Settings",panel:SettingsPanel}],initialStepIdx,initialRecord:currentRecord,isSaving,onSave:function(){var _ref2=ManageScheduleV2_asyncToGenerator(regeneratorRuntime.mark((function _callee3(record){var _record$id,_makeContext2,_overlapsResponse$dat,_overlapsResponse$dat2,overlapsResponse,_extractActualError,itemId,_record$elements$filt,_record$elements,_record$elements$filt2,_record$elements2,_itemRecord$abstract,_itemRecord$externalE,itemRecord,newElements,updatedElements,deletedElementIds,abstractRecord,externalEventLinkRecord,_itemRecord$itemPeopl,_itemRecord$itemPeopl2,_ref3,_itemRecord$itemPeopl3,_itemRecord$itemTags$,_itemRecord$itemTags,_ref4,_itemRecord$itemTags2,_makeContext3,_result$data,_result$data$update_c,result,_extractActualError2,elementStates,_record$item$typeName,_makeContext5,_result$data3,_result$data3$insert_,_result,_extractActualError4,_record$eventPeople$m,_record$eventPeople,_record$eventPeople$f,_record$eventPeople2,_makeContext6,_result2$data,shiftPresentationsByMinutes,_sessionsResponse$dat10,originalEvent,_result2,_extractActualError5,_refetchPresentations,_refetchPresentations2,_makeContext7,_result3$data,_result3,_extractActualError6,_refetchPresentations3,_refetchPresentations4,_makeContext8,ordering,_extractActualError7,newId,index;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(setIsSaving(!0),_context3.prev=1,!record.scheduledStartTime&&!record.scheduledEndTime){_context3.next=10;break}return _context3.next=5,client.query(graphql.gvR,{roomId:record.roomId,sessionCond:"sessionEventId"in record&&record.sessionEventId?{_eq:record.sessionEventId}:{_is_null:!0},startBefore:record.scheduledEndTime,endAfter:record.scheduledStartTime,excludeId:null!==(_record$id=record.id)&&void 0!==_record$id?_record$id:"00000000-0000-0000-0000-000000000000"},Object.assign({},(0,make_context.f)((_makeContext2={},_makeContext2[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext2)),{requestPolicy:"network-only"})).toPromise();case 5:if(!(overlapsResponse=_context3.sent).error){_context3.next=8;break}return _context3.abrupt("return",{error:null!==(_extractActualError=(0,ExtractActualError.Z)(overlapsResponse.error))&&void 0!==_extractActualError?_extractActualError:"Unknown error while checking for overlapping events."});case 8:if(null===(_overlapsResponse$dat=overlapsResponse.data)||void 0===_overlapsResponse$dat||null===(_overlapsResponse$dat2=_overlapsResponse$dat.schedule_Event_aggregate.aggregate)||void 0===_overlapsResponse$dat2||!_overlapsResponse$dat2.count){_context3.next=10;break}return _context3.abrupt("return",{error:"sessionEventId"in record&&record.sessionEventId?"Presentations within a session cannot overlap. Consider using unscheduled presentations.":"Sessions in a room cannot overlap."});case 10:if(itemId=record.itemId,!record.item){_context3.next=43;break}if(itemRecord=record.item,newElements=null!==(_record$elements$filt=null===(_record$elements=record.elements)||void 0===_record$elements?void 0:_record$elements.filter((function(x){return!x.id})))&&void 0!==_record$elements$filt?_record$elements$filt:[],updatedElements=null!==(_record$elements$filt2=null===(_record$elements2=record.elements)||void 0===_record$elements2?void 0:_record$elements2.filter((function(x){return x.id})))&&void 0!==_record$elements$filt2?_record$elements$filt2:[],deletedElementIds=record.deletedElementIds?ManageScheduleV2_toConsumableArray(record.deletedElementIds):[],null!==(_itemRecord$abstract=itemRecord.abstract)&&void 0!==_itemRecord$abstract&&_itemRecord$abstract.length&&((abstractRecord=Object.assign({},itemRecord.abstract[0],{isHidden:!1,typeName:graphql.bK7.Abstract,name:"Abstract",uploadsRemaining:0})).id?updatedElements.push(abstractRecord):newElements.push(abstractRecord)),null!==(_itemRecord$externalE=itemRecord.externalEventLink)&&void 0!==_itemRecord$externalE&&_itemRecord$externalE.length&&((externalEventLinkRecord=Object.assign({},itemRecord.externalEventLink[0],{isHidden:!0,typeName:graphql.bK7.ExternalEventLink,uploadsRemaining:0})).id?updatedElements.push(externalEventLinkRecord):newElements.push(externalEventLinkRecord)),!itemRecord.id){_context3.next=35;break}return itemId=itemRecord.id,_context3.next=22,client.mutation(graphql.AUB,{id:itemRecord.id,item:{title:itemRecord.title,typeName:itemRecord.typeName},itemPeople:null!==(_itemRecord$itemPeopl=null===(_itemRecord$itemPeopl2=itemRecord.itemPeople)||void 0===_itemRecord$itemPeopl2?void 0:_itemRecord$itemPeopl2.map((function(x){return{itemId:itemRecord.id,personId:x.personId,priority:x.priority,roleName:x.roleName}})))&&void 0!==_itemRecord$itemPeopl?_itemRecord$itemPeopl:[],itemPersonIds:null!==(_ref3=null===(_itemRecord$itemPeopl3=itemRecord.itemPeople)||void 0===_itemRecord$itemPeopl3?void 0:_itemRecord$itemPeopl3.filter((function(x){return Boolean(x.personId)})).map((function(x){return x.personId})))&&void 0!==_ref3?_ref3:[],itemTags:null!==(_itemRecord$itemTags$=null===(_itemRecord$itemTags=itemRecord.itemTags)||void 0===_itemRecord$itemTags?void 0:_itemRecord$itemTags.map((function(x){return{itemId:itemRecord.id,tagId:x.tagId}})))&&void 0!==_itemRecord$itemTags$?_itemRecord$itemTags$:[],itemTagIds:null!==(_ref4=null===(_itemRecord$itemTags2=itemRecord.itemTags)||void 0===_itemRecord$itemTags2?void 0:_itemRecord$itemTags2.filter((function(x){return Boolean(x.tagId)})).map((function(x){return x.tagId})))&&void 0!==_ref4?_ref4:[],newElements:newElements.map((function(x){var _x$isHidden,_x$uploadsRemaining;return{itemId:itemRecord.id,conferenceId:conference.id,subconferenceId,data:x.data,layoutData:x.layoutData,isHidden:null!==(_x$isHidden=x.isHidden)&&void 0!==_x$isHidden&&_x$isHidden,name:x.name,typeName:x.typeName,uploadsRemaining:null!==(_x$uploadsRemaining=x.uploadsRemaining)&&void 0!==_x$uploadsRemaining?_x$uploadsRemaining:0}})),deletedElementIds},(0,make_context.f)((_makeContext3={},_makeContext3[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext3))).toPromise();case 22:if(!(result=_context3.sent).error){_context3.next=25;break}return _context3.abrupt("return",{error:null!==(_extractActualError2=(0,ExtractActualError.Z)(result.error))&&void 0!==_extractActualError2?_extractActualError2:"Unknown error while updating the event content."});case 25:if(null!==(_result$data=result.data)&&void 0!==_result$data&&null!==(_result$data$update_c=_result$data.update_content_Item_by_pk)&&void 0!==_result$data$update_c&&_result$data$update_c.id){_context3.next=27;break}return _context3.abrupt("return",{error:"Event content not updated for unknown reason."});case 27:return _context3.next=29,Promise.all(updatedElements.map(function(){var _ref5=ManageScheduleV2_asyncToGenerator(regeneratorRuntime.mark((function _callee2(elementRecord){var _makeContext4,_result$data2,_result$data2$update_,result,_extractActualError3;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,client.mutation(graphql._l9,{id:elementRecord.id,element:{data:elementRecord.data,isHidden:elementRecord.isHidden,layoutData:elementRecord.layoutData,name:elementRecord.name,typeName:elementRecord.typeName,uploadsRemaining:elementRecord.uploadsRemaining}},(0,make_context.f)((_makeContext4={},_makeContext4[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext4))).toPromise();case 2:if(!(result=_context2.sent).error){_context2.next=5;break}return _context2.abrupt("return",{error:null!==(_extractActualError3=(0,ExtractActualError.Z)(result.error))&&void 0!==_extractActualError3?_extractActualError3:"Unknown error while updating the event content element."});case 5:if(null!==(_result$data2=result.data)&&void 0!==_result$data2&&null!==(_result$data2$update_=_result$data2.update_content_Element_by_pk)&&void 0!==_result$data2$update_&&_result$data2$update_.id){_context2.next=7;break}return _context2.abrupt("return",{error:"Event content element not updated for unknown reason."});case 7:return _context2.abrupt("return","no error");case 8:case"end":return _context2.stop()}}),_callee2)})));return function(_x4){return _ref5.apply(this,arguments)}}()));case 29:if(elementStates=_context3.sent,!elementStates.some((function(x){return"no error"!==x}))){_context3.next=33;break}return _context3.abrupt("return",{error:"One or more elements failed to update:\n"+elementStates.map((function(st,idx){return"["+idx+"] "+("no error"===st?"No error":st.error)}))+"\n"});case 33:_context3.next=43;break;case 35:return _context3.next=37,client.mutation(graphql.suG,{object:{conferenceId:conference.id,subconferenceId,title:itemRecord.title,typeName:null!==(_record$item$typeName=record.item.typeName)&&void 0!==_record$item$typeName?_record$item$typeName:"sessionEventId"in record&&record.sessionEventId?graphql.gqi.Presentation:graphql.gqi.Session,itemTags:record.item.itemTags?{data:record.item.itemTags.map((function(x){return{tagId:x.tagId}}))}:void 0,itemPeople:record.item.itemPeople?{data:record.item.itemPeople.map((function(x){return{personId:x.personId,priority:x.priority,roleName:x.roleName}}))}:void 0,elements:{data:[].concat(ManageScheduleV2_toConsumableArray(newElements),ManageScheduleV2_toConsumableArray(updatedElements)).map((function(elementRecord){return{conferenceId:conference.id,subconferenceId,data:elementRecord.data,isHidden:elementRecord.isHidden,layoutData:elementRecord.layoutData,name:elementRecord.name,typeName:elementRecord.typeName,uploadsRemaining:elementRecord.uploadsRemaining}}))}}},(0,make_context.f)((_makeContext5={},_makeContext5[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext5))).toPromise();case 37:if(!(_result=_context3.sent).error){_context3.next=40;break}return _context3.abrupt("return",{error:null!==(_extractActualError4=(0,ExtractActualError.Z)(_result.error))&&void 0!==_extractActualError4?_extractActualError4:"Unknown error while updating the event content."});case 40:if(null!==(_result$data3=_result.data)&&void 0!==_result$data3&&null!==(_result$data3$insert_=_result$data3.insert_content_Item_one)&&void 0!==_result$data3$insert_&&_result$data3$insert_.id){_context3.next=42;break}return _context3.abrupt("return",{error:"Event content not inserted for unknown reason."});case 42:itemId=_result.data.insert_content_Item_one.id;case 43:if(!record.id){_context3.next=60;break}if(shiftPresentationsByMinutes=0,"sessionEventId"in record&&record.sessionEventId){_context3.next=50;break}if(originalEvent=null===(_sessionsResponse$dat10=sessionsResponse.data)||void 0===_sessionsResponse$dat10?void 0:_sessionsResponse$dat10.schedule_Event.find((function(x){return x.id===record.id}))){_context3.next=49;break}return _context3.abrupt("return",{error:"Could not find original session to check time shift."});case 49:record.scheduledStartTime&&originalEvent.scheduledStartTime&&(shiftPresentationsByMinutes=Math.round((Date.parse(record.scheduledStartTime)-Date.parse(originalEvent.scheduledStartTime))/6e4));case 50:return _context3.next=52,client.mutation(graphql.hrI,{id:record.id,roomId:record.roomId,event:{name:record.name,scheduledStartTime:record.scheduledStartTime,scheduledEndTime:record.scheduledEndTime,modeName:"modeName"in record?record.modeName:void 0,roomId:record.roomId,itemId,exhibitionId:"exhibitionId"in record?record.exhibitionId:void 0,shufflePeriodId:"shufflePeriodId"in record?record.shufflePeriodId:void 0,enableRecording:"enableRecording"in record?record.enableRecording:void 0,autoPlayElementId:"autoPlayElementId"in record?record.autoPlayElementId:void 0,streamTextEventId:"streamTextEventId"in record?record.streamTextEventId:void 0,automaticParticipationSurvey:"automaticParticipationSurvey"in record?record.automaticParticipationSurvey:void 0},eventPeople:null!==(_record$eventPeople$m=null===(_record$eventPeople=record.eventPeople)||void 0===_record$eventPeople?void 0:_record$eventPeople.map((function(x){return{eventId:record.id,roleName:x.roleName,personId:x.personId}})))&&void 0!==_record$eventPeople$m?_record$eventPeople$m:[],eventPersonIds:null!==(_record$eventPeople$f=null===(_record$eventPeople2=record.eventPeople)||void 0===_record$eventPeople2?void 0:_record$eventPeople2.filter((function(x){return x.personId})).map((function(x){return x.personId})))&&void 0!==_record$eventPeople$f?_record$eventPeople$f:[],shiftPresentationsByMinutes},(0,make_context.f)((_makeContext6={},_makeContext6[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext6))).toPromise();case 52:if(!(_result2=_context3.sent).error){_context3.next=55;break}return _context3.abrupt("return",{error:null!==(_extractActualError5=(0,ExtractActualError.Z)(_result2.error))&&void 0!==_extractActualError5?_extractActualError5:"Unknown error while inserting the event."});case 55:if(null!==(_result2$data=_result2.data)&&void 0!==_result2$data&&_result2$data.update_schedule_Event_by_pk){_context3.next=57;break}return _context3.abrupt("return",{error:"Event not updated for unknown reason."});case 57:"sessionEventId"in record&&record.sessionEventId?null===(_refetchPresentations=refetchPresentations.get(record.sessionEventId))||void 0===_refetchPresentations||null===(_refetchPresentations2=_refetchPresentations.current)||void 0===_refetchPresentations2||_refetchPresentations2.call(_refetchPresentations):refetchSessions(),_context3.next=82;break;case 60:return _context3.next=62,client.mutation(graphql.IgG,{object:{id:record.id,conferenceId:conference.id,subconferenceId,sessionEventId:"sessionEventId"in record?record.sessionEventId:void 0,name:record.name,scheduledStartTime:record.scheduledStartTime,scheduledEndTime:record.scheduledEndTime,modeName:"modeName"in record?record.modeName:void 0,roomId:record.roomId,itemId,exhibitionId:"exhibitionId"in record?record.exhibitionId:void 0,shufflePeriodId:"shufflePeriodId"in record?record.shufflePeriodId:void 0,enableRecording:"enableRecording"in record?record.enableRecording:void 0,autoPlayElementId:"autoPlayElementId"in record?record.autoPlayElementId:void 0,streamTextEventId:"streamTextEventId"in record?record.streamTextEventId:void 0,automaticParticipationSurvey:"automaticParticipationSurvey"in record?record.automaticParticipationSurvey:void 0,eventPeople:record.eventPeople?{data:record.eventPeople.map((function(x){return{id:x.id,roleName:x.roleName,personId:x.personId}}))}:void 0}},(0,make_context.f)((_makeContext7={},_makeContext7[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext7))).toPromise();case 62:if(!(_result3=_context3.sent).error){_context3.next=65;break}return _context3.abrupt("return",{error:null!==(_extractActualError6=(0,ExtractActualError.Z)(_result3.error))&&void 0!==_extractActualError6?_extractActualError6:"Unknown error while inserting the event."});case 65:if(null!==(_result3$data=_result3.data)&&void 0!==_result3$data&&_result3$data.insert_schedule_Event_one){_context3.next=67;break}return _context3.abrupt("return",{error:"Event not inserted for unknown reason."});case 67:if(!("sessionEventId"in record)||!record.sessionEventId){_context3.next=71;break}null===(_refetchPresentations3=refetchPresentations.get(record.sessionEventId))||void 0===_refetchPresentations3||null===(_refetchPresentations4=_refetchPresentations3.current)||void 0===_refetchPresentations4||_refetchPresentations4.call(_refetchPresentations3),_context3.next=82;break;case 71:return _context3.next=73,client.query(graphql.q5l,{conferenceId:conference.id,subconferenceCond:subconferenceId?{_eq:subconferenceId}:{_is_null:!0},filter},(0,make_context.f)((_makeContext8={},_makeContext8[auth.k.Role]=subconferenceId?auth.Z.SubconferenceOrganizer:auth.Z.ConferenceOrganizer,_makeContext8))).toPromise();case 73:if(!(ordering=_context3.sent).error){_context3.next=76;break}return _context3.abrupt("return",{error:null!==(_extractActualError7=(0,ExtractActualError.Z)(ordering.error))&&void 0!==_extractActualError7?_extractActualError7:"Unknown error retrieving ordering of sessions."});case 76:if(ordering.data){_context3.next=78;break}return _context3.abrupt("return",{error:"Unable to retrieve ordering of sessions."});case 78:refetchSessions(),newId=_result3.data.insert_schedule_Event_one.id,index=ordering.data.schedule_Event.findIndex((function(x){return x.id===newId})),setOffset(Math.max(0,limit*Math.floor(index/limit)));case 82:_context3.next=87;break;case 84:return _context3.prev=84,_context3.t0=_context3.catch(1),_context3.abrupt("return",{error:"Unhandled error: "+_context3.t0.toString()});case 87:return _context3.prev=87,setIsSaving(!1),_context3.finish(87);case 90:return _context3.abrupt("return","no error");case 91:case"end":return _context3.stop()}}),_callee3,null,[[1,84,87,90]])})));return function(_x3){return _ref2.apply(this,arguments)}}()}),(0,jsx_runtime.jsx)(DeleteModal,{isOpen:deleteEventsDisclosure.isOpen,onClose:function onClose(didDelete){deleteEventsDisclosure.onClose(),didDelete&&(deleteEventIds.forEach((function(x){var _refetchPresentations5,_refetchPresentations6;return null===(_refetchPresentations5=refetchPresentations.get(x))||void 0===_refetchPresentations5||null===(_refetchPresentations6=_refetchPresentations5.current)||void 0===_refetchPresentations6?void 0:_refetchPresentations6.call(_refetchPresentations5)})),refetchSessions(),setSelectedSessions(new Set))},deleteEventIds,deleteEventType}),(0,jsx_runtime.jsx)(ShiftTimesModal,{isOpen:shiftEventsDisclosure.isOpen,onClose:function onClose(didShift){shiftEventsDisclosure.onClose(),didShift&&(shiftEventIds.forEach((function(x){var _refetchPresentations7,_refetchPresentations8;return null===(_refetchPresentations7=refetchPresentations.get(x))||void 0===_refetchPresentations7||null===(_refetchPresentations8=_refetchPresentations7.current)||void 0===_refetchPresentations8?void 0:_refetchPresentations8.call(_refetchPresentations7)})),refetchSessions())},eventIds:shiftEventIds}),(0,jsx_runtime.jsx)(FindExistingContentModal,{isOpen:addSessionForContentDisclosure.isOpen,onClose:function onClose(id){id&&onDoCreateSessionForExistingContent(id,addForExistingContentSession),addSessionForContentDisclosure.onClose()},sessionOrPresentation:addSessionOrPresentation,typeDisplayName:addSessionForContentTypeDisplayName,typeNames:addSessionForContentTypeNames})]})}function PaginationControls(_ref6){var _sessionsResponse$dat11,_sessionsResponse$dat12,_sessionsResponse$dat13,_sessionsResponse$dat14,_sessionsResponse$dat15,_sessionsResponse$dat16,_sessionsResponse$dat17,_sessionsResponse$dat18,_sessionsResponse$dat20,setOffset=_ref6.setOffset,limit=_ref6.limit,setLimit=_ref6.setLimit,setSelectedSessions=_ref6.setSelectedSessions,offset=_ref6.offset,offsetStr=_ref6.offsetStr,setOffsetStr=_ref6.setOffsetStr,sessionsResponse=_ref6.sessionsResponse;return(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.gC,{py:4,spacing:4,w:"100%",justifyContent:"center",maxW:"800px",children:[(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{spacing:4,py:4,w:"100%",justifyContent:"center",children:[(0,jsx_runtime.jsx)(chakra_ui_button_esm.hU,{"aria-label":"Previous page",icon:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.ChevronLeftIcon,{}),onClick:function onClick(){setOffset((function(old){return Math.max(0,old-limit)})),setSelectedSessions(new Set)},isDisabled:0===offset}),(0,jsx_runtime.jsxs)(chakra_ui_layout_esm.Ug,{spacing:1,children:[(0,jsx_runtime.jsx)(chakra_ui_input_esm.II,{type:"number",size:"sm",value:offsetStr,onChange:function onChange(ev){setOffsetStr(ev.target.value)},min:1,max:Math.ceil((null!==(_sessionsResponse$dat11=null===(_sessionsResponse$dat12=sessionsResponse.data)||void 0===_sessionsResponse$dat12||null===(_sessionsResponse$dat13=_sessionsResponse$dat12.schedule_Event_aggregate)||void 0===_sessionsResponse$dat13||null===(_sessionsResponse$dat14=_sessionsResponse$dat13.aggregate)||void 0===_sessionsResponse$dat14?void 0:_sessionsResponse$dat14.count)&&void 0!==_sessionsResponse$dat11?_sessionsResponse$dat11:0)/limit),onBlur:function onBlur(ev){ev.target.checkValidity()&&setOffset((ev.target.valueAsNumber-1)*limit)},onKeyUp:function onKeyUp(ev){"Enter"===ev.key&&ev.target.checkValidity()&&setOffset((ev.target.valueAsNumber-1)*limit)},isDisabled:!(null!==(_sessionsResponse$dat15=sessionsResponse.data)&&void 0!==_sessionsResponse$dat15&&null!==(_sessionsResponse$dat16=_sessionsResponse$dat15.schedule_Event_aggregate)&&void 0!==_sessionsResponse$dat16&&null!==(_sessionsResponse$dat17=_sessionsResponse$dat16.aggregate)&&void 0!==_sessionsResponse$dat17&&_sessionsResponse$dat17.count),minW:0,w:"3em"}),(0,jsx_runtime.jsx)(chakra_ui_system_esm.m$.span,{children:"of"}),(0,jsx_runtime.jsx)(chakra_ui_system_esm.m$.span,{children:null!==(_sessionsResponse$dat18=sessionsResponse.data)&&void 0!==_sessionsResponse$dat18&&_sessionsResponse$dat18.schedule_Event_aggregate.aggregate?Math.ceil(sessionsResponse.data.schedule_Event_aggregate.aggregate.count/limit):"0"})]}),(0,jsx_runtime.jsx)(chakra_ui_button_esm.hU,{"aria-label":"Next page",icon:(0,jsx_runtime.jsx)(chakra_ui_icons_esm.ChevronRightIcon,{}),onClick:function onClick(){setOffset((function(old){var _sessionsResponse$dat19;return null!==(_sessionsResponse$dat19=sessionsResponse.data)&&void 0!==_sessionsResponse$dat19&&_sessionsResponse$dat19.schedule_Event_aggregate.aggregate?Math.min(sessionsResponse.data.schedule_Event_aggregate.aggregate.count-sessionsResponse.data.schedule_Event_aggregate.aggregate.count%limit,old+limit):0})),setSelectedSessions(new Set)},isDisabled:null===(_sessionsResponse$dat20=sessionsResponse.data)||void 0===_sessionsResponse$dat20||!_sessionsResponse$dat20.schedule_Event_aggregate.aggregate||offset>=sessionsResponse.data.schedule_Event_aggregate.aggregate.count-limit})]}),(0,jsx_runtime.jsx)(chakra_ui_layout_esm.Ug,{spacing:4,py:4,w:"100%",justifyContent:"center",children:(0,jsx_runtime.jsxs)(chakra_ui_select_esm.Ph,{value:limit,onChange:function onChange(ev){setLimit(parseInt(ev.target.value,10)),setSelectedSessions(new Set)},size:"sm",w:"max-content",children:[(0,jsx_runtime.jsx)("option",{value:"10",children:"10 per page"}),(0,jsx_runtime.jsx)("option",{value:"20",children:"20 per page"}),(0,jsx_runtime.jsx)("option",{value:"30",children:"30 per page"}),(0,jsx_runtime.jsx)("option",{value:"50",children:"50 per page"}),(0,jsx_runtime.jsx)("option",{value:"100",children:"100 per page"})]})})]})}(0,urql_core.Ps)(ManageScheduleV2_templateObject||(ManageScheduleV2_templateObject=function ManageScheduleV2_taggedTemplateLiteralLoose(strings,raw){return raw||(raw=strings.slice(0)),strings.raw=raw,strings}(['\n    fragment ManageSchedule_ItemTag on content_ItemTag {\n        id\n        tagId\n    }\n\n    fragment ManageSchedule_ItemPerson on content_ItemProgramPerson {\n        id\n        personId\n        roleName\n        priority\n    }\n\n    fragment ManageSchedule_EventPerson on schedule_EventProgramPerson {\n        id\n        personId\n        roleName\n    }\n\n    fragment ManageSchedule_EventContent on content_Item {\n        id\n        title\n        typeName\n        itemTags {\n            ...ManageSchedule_ItemTag\n        }\n        itemPeople {\n            ...ManageSchedule_ItemPerson\n        }\n        abstract: elements(where: { typeName: { _eq: ABSTRACT } }, limit: 1) {\n            ...ManageSchedule_Element\n        }\n        externalEventLink: elements(where: { typeName: { _eq: EXTERNAL_EVENT_LINK } }, limit: 1) {\n            ...ManageSchedule_Element\n        }\n        elements_aggregate {\n            aggregate {\n                count\n            }\n        }\n    }\n\n    fragment ManageSchedule_Session on schedule_Event {\n        id\n        conferenceId\n        subconferenceId\n\n        name\n        scheduledStartTime\n        scheduledEndTime\n        modeName\n        roomId\n        itemId\n        exhibitionId\n        shufflePeriodId\n\n        enableRecording\n        autoPlayElementId\n        streamTextEventId\n        automaticParticipationSurvey\n\n        presentations_aggregate {\n            aggregate {\n                count\n            }\n        }\n\n        item {\n            ...ManageSchedule_EventContent\n        }\n\n        eventPeople {\n            ...ManageSchedule_EventPerson\n        }\n    }\n\n    fragment ManageSchedule_Tag on collection_Tag {\n        id\n        name\n        priority\n        colour\n    }\n\n    query ManageSchedule_GetTags($conferenceId: uuid!, $subconferenceCond: uuid_comparison_exp!) {\n        collection_Tag(\n            where: { conferenceId: { _eq: $conferenceId }, subconferenceId: $subconferenceCond }\n            order_by: [{ priority: asc }, { name: asc }]\n        ) {\n            ...ManageSchedule_Tag\n        }\n    }\n\n    query ManageSchedule_GetSessionsPage(\n        $conferenceId: uuid!\n        $subconferenceCond: uuid_comparison_exp!\n        $limit: Int!\n        $offset: Int!\n        $filter: schedule_Event_bool_exp!\n    ) {\n        schedule_Event_aggregate(\n            where: {\n                _and: [\n                    { conferenceId: { _eq: $conferenceId } }\n                    { subconferenceId: $subconferenceCond }\n                    { sessionEventId: { _is_null: true } }\n                    $filter\n                ]\n            }\n        ) {\n            aggregate {\n                count\n            }\n        }\n\n        schedule_Event(\n            where: {\n                _and: [\n                    { conferenceId: { _eq: $conferenceId } }\n                    { subconferenceId: $subconferenceCond }\n                    { sessionEventId: { _is_null: true } }\n                    $filter\n                ]\n            }\n            limit: $limit\n            offset: $offset\n            order_by: [{ scheduledStartTime: asc }, { scheduledEndTime: asc }, { room: { name: asc } }]\n        ) {\n            ...ManageSchedule_Session\n        }\n    }\n\n    query ManageSchedule_GetAllSessionIds(\n        $conferenceId: uuid!\n        $subconferenceCond: uuid_comparison_exp!\n        $filter: schedule_Event_bool_exp!\n    ) {\n        schedule_Event(\n            where: {\n                _and: [\n                    { conferenceId: { _eq: $conferenceId } }\n                    { subconferenceId: $subconferenceCond }\n                    { sessionEventId: { _is_null: true } }\n                    $filter\n                ]\n            }\n            order_by: [{ scheduledStartTime: asc }, { scheduledEndTime: asc }, { room: { name: asc } }]\n        ) {\n            id\n        }\n    }\n\n    mutation ManageSchedule_InsertEvent($object: schedule_Event_insert_input!) {\n        insert_schedule_Event_one(object: $object) {\n            id\n        }\n    }\n\n    mutation ManageSchedule_UpdateEvent(\n        $id: uuid!\n        $event: schedule_Event_set_input!\n        $eventPeople: [schedule_EventProgramPerson_insert_input!]!\n        $eventPersonIds: [uuid!]!\n        $shiftPresentationsByMinutes: Int!\n        $roomId: uuid!\n    ) {\n        update_schedule_Event_by_pk(pk_columns: { id: $id }, _set: $event) {\n            id\n        }\n        updatedPresentations: update_schedule_Event(\n            where: { sessionEventId: { _eq: $id } }\n            _set: { roomId: $roomId }\n        ) {\n            affected_rows\n        }\n        delete_schedule_EventProgramPerson(where: { eventId: { _eq: $id }, id: { _nin: $eventPersonIds } }) {\n            affected_rows\n        }\n        insert_schedule_EventProgramPerson(\n            objects: $eventPeople\n            on_conflict: { constraint: EventProgramPerson_eventId_personId_roleName_key, update_columns: [roleName] }\n        ) {\n            affected_rows\n        }\n        schedule_shiftPresentationTimes(args: { sessionId: $id, minutes: $shiftPresentationsByMinutes }) {\n            id\n        }\n    }\n\n    mutation ManageSchedule_InsertItem($object: content_Item_insert_input!) {\n        insert_content_Item_one(object: $object) {\n            id\n        }\n    }\n\n    mutation ManageSchedule_UpdateItem(\n        $id: uuid!\n        $item: content_Item_set_input!\n        $itemPeople: [content_ItemProgramPerson_insert_input!]!\n        $itemPersonIds: [uuid!]!\n        $itemTags: [content_ItemTag_insert_input!]!\n        $itemTagIds: [uuid!]!\n        $newElements: [content_Element_insert_input!]!\n        $deletedElementIds: [uuid!]!\n    ) {\n        update_content_Item_by_pk(pk_columns: { id: $id }, _set: $item) {\n            id\n        }\n        delete_content_ItemProgramPerson(where: { itemId: { _eq: $id }, id: { _nin: $itemPersonIds } }) {\n            affected_rows\n        }\n        insert_content_ItemProgramPerson(\n            objects: $itemPeople\n            on_conflict: {\n                constraint: ItemProgramPerson_roleName_personId_itemId_key\n                update_columns: [priority, roleName]\n            }\n        ) {\n            affected_rows\n        }\n        delete_content_ItemTag(where: { itemId: { _eq: $id }, id: { _nin: $itemTagIds } }) {\n            affected_rows\n        }\n        insert_content_ItemTag(\n            objects: $itemTags\n            on_conflict: { constraint: ItemTag_itemId_tagId_key, update_columns: [] }\n        ) {\n            affected_rows\n        }\n        delete_content_Element(where: { itemId: { _eq: $id }, id: { _in: $deletedElementIds } }) {\n            affected_rows\n        }\n        insert_content_Element(objects: $newElements) {\n            affected_rows\n        }\n    }\n\n    mutation ManageSchedule_UpdateElement($id: uuid!, $element: content_Element_set_input!) {\n        update_content_Element_by_pk(pk_columns: { id: $id }, _set: $element) {\n            id\n        }\n    }\n\n    fragment ManageSchedule_ItemForExport on content_Item {\n        id\n        title\n\n        abstract: elements(where: { typeName: { _eq: ABSTRACT } }) {\n            id\n            data\n            uploadsRemaining\n        }\n\n        videos: elements_aggregate(\n            where: { typeName: { _in: [VIDEO_FILE, VIDEO_BROADCAST] }, uploadsRemaining: { _gt: 0 } }\n        ) {\n            aggregate {\n                count\n            }\n        }\n\n        images: elements_aggregate(\n            where: { typeName: { _in: [IMAGE_FILE, POSTER_FILE] }, uploadsRemaining: { _gt: 0 } }\n        ) {\n            aggregate {\n                count\n            }\n        }\n\n        slides: elements_aggregate(where: { typeName: { _in: [PAPER_FILE] }, uploadsRemaining: { _gt: 0 } }) {\n            aggregate {\n                count\n            }\n        }\n\n        links: elements_aggregate(\n            where: { typeName: { _in: [PAPER_URL, LINK, LINK_BUTTON] }, uploadsRemaining: { _gt: 0 } }\n        ) {\n            aggregate {\n                count\n            }\n        }\n\n        itemPeople(where: { roleName: { _in: ["CHAIR", "SESSION ORGANIZER", "AUTHOR", "PRESENTER", "DISCUSSANT"] } }) {\n            id\n            roleName\n            person {\n                id\n                name\n                affiliation\n                email\n            }\n        }\n    }\n\n    fragment ManageSchedule_SessionForExport on schedule_Event {\n        id\n        name\n        scheduledStartTime\n        scheduledEndTime\n        modeName\n        roomId\n        itemId\n\n        item {\n            ...ManageSchedule_ItemForExport\n\n            itemTags {\n                id\n                tagId\n            }\n        }\n\n        presentations {\n            id\n            name\n            scheduledStartTime\n            scheduledEndTime\n\n            item {\n                ...ManageSchedule_ItemForExport\n            }\n        }\n\n        exhibition {\n            name\n            descriptiveItem {\n                ...ManageSchedule_ItemForExport\n            }\n            items {\n                id\n                priority\n                item {\n                    ...ManageSchedule_ItemForExport\n                }\n            }\n        }\n\n        eventPeople(where: { roleName: { _in: [CHAIR, PRESENTER] } }) {\n            id\n            roleName\n            person {\n                id\n                name\n                affiliation\n                email\n            }\n        }\n    }\n\n    query ManageSchedule_GetEventsForExport($ids: [uuid!]!) {\n        schedule_Event(where: { id: { _in: $ids } }) {\n            ...ManageSchedule_SessionForExport\n        }\n    }\n\n    query ManageSchedule_GetPotentiallyOverlappingEvents(\n        $roomId: uuid!\n        $startBefore: timestamptz!\n        $endAfter: timestamptz!\n        $sessionCond: uuid_comparison_exp!\n        $excludeId: uuid!\n    ) {\n        schedule_Event_aggregate(\n            where: {\n                roomId: { _eq: $roomId }\n                scheduledStartTime: { _lt: $startBefore }\n                scheduledEndTime: { _gt: $endAfter }\n                sessionEventId: $sessionCond\n                id: { _neq: $excludeId }\n            }\n        ) {\n            aggregate {\n                count\n            }\n        }\n    }\n\n    query ManageSchedule_GetExistingItem($id: uuid!) {\n        content_Item_by_pk(id: $id) {\n            ...ManageSchedule_EventContent\n            room {\n                id\n            }\n        }\n    }\n']))),ManageScheduleV2.displayName="ManageScheduleV2",PaginationControls.displayName="PaginationControls"},"../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/modules/es.array.every.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var $=__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/internals/export.js"),$every=__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/internals/array-iteration.js").every;$({target:"Array",proto:!0,forced:!__webpack_require__("../node_modules/.pnpm/core-js@3.21.0/node_modules/core-js/internals/array-method-is-strict.js")("every")},{every:function every(callbackfn){return $every(this,callbackfn,arguments.length>1?arguments[1]:void 0)}})},"../node_modules/.pnpm/use-react-router-breadcrumbs@2.0.2_react-router@5.2.1+react@17.0.2/node_modules/use-react-router-breadcrumbs/dist/es/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/.pnpm/@babel+runtime@7.15.4/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),react_router__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/.pnpm/react-router@5.2.1_react@17.0.2/node_modules/react-router/esm/react-router.js");var DEFAULT_MATCH_OPTIONS={exact:!0},humanize=function humanize(str){return str.replace(/^[\s_]+|[\s_]+$/g,"").replace(/[_\s]+/g," ").replace(/^[a-z]/,(function(m){return m.toUpperCase()}))},render=function render(_ref){var Breadcrumb=_ref.breadcrumb,match=_ref.match,location=_ref.location,props=_ref.props,componentProps=Object.assign({match,location,key:match.url},props||{});return Object.assign(Object.assign({},componentProps),{breadcrumb:"string"==typeof Breadcrumb?(0,react__WEBPACK_IMPORTED_MODULE_0__.createElement)("span",{key:componentProps.key},Breadcrumb):react__WEBPACK_IMPORTED_MODULE_0__.createElement(Breadcrumb,Object.assign({},componentProps))})},getBreadcrumbMatch=function getBreadcrumbMatch(_ref3){var breadcrumb,currentSection=_ref3.currentSection,disableDefaults=_ref3.disableDefaults,excludePaths=_ref3.excludePaths,location=_ref3.location,pathSection=_ref3.pathSection,routes=_ref3.routes;return excludePaths&&excludePaths.some((function getIsPathExcluded(path){return null!=(0,react_router__WEBPACK_IMPORTED_MODULE_1__.LX)(pathSection,{path,exact:!0,strict:!1})}))?"NO_BREADCRUMB":(routes.some((function(_a){var userProvidedBreadcrumb=_a.breadcrumb,matchOptions=_a.matchOptions,path=_a.path,rest=function __rest(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t}(_a,["breadcrumb","matchOptions","path"]);if(!path)throw new Error("useBreadcrumbs: `path` must be provided in every route object");var match=(0,react_router__WEBPACK_IMPORTED_MODULE_1__.LX)(pathSection,Object.assign(Object.assign({},matchOptions||DEFAULT_MATCH_OPTIONS),{path}));return match&&null===userProvidedBreadcrumb||!match&&matchOptions?(breadcrumb="NO_BREADCRUMB",!0):!!match&&(!userProvidedBreadcrumb&&disableDefaults?(breadcrumb="NO_BREADCRUMB",!0):(breadcrumb=render(Object.assign({breadcrumb:userProvidedBreadcrumb||humanize(currentSection),match,location},rest)),!0))})),breadcrumb||(disableDefaults?"NO_BREADCRUMB":function getDefaultBreadcrumb(_ref2){var currentSection=_ref2.currentSection,location=_ref2.location,pathSection=_ref2.pathSection,match=(0,react_router__WEBPACK_IMPORTED_MODULE_1__.LX)(pathSection,Object.assign(Object.assign({},DEFAULT_MATCH_OPTIONS),{path:pathSection}))||{url:"not-found"};return render({breadcrumb:humanize(currentSection),match,location})}({pathSection,currentSection:"/"===pathSection?"Home":currentSection,location})))},flattenRoutes=function flattenRoutes(routes){return routes.reduce((function(arr,route){return route.routes?arr.concat([route].concat((0,_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_2__.Z)(flattenRoutes(route.routes)))):arr.concat(route)}),[])};const __WEBPACK_DEFAULT_EXPORT__=function useReactRouterBreadcrumbs(routes,options){return function getBreadcrumbs(_ref4){var routes=_ref4.routes,location=_ref4.location,_ref4$options=_ref4.options,options=void 0===_ref4$options?{}:_ref4$options,matches=[];return location.pathname.split("?")[0].split("/").reduce((function(previousSection,currentSection,index){var pathSection=currentSection?"".concat(previousSection,"/").concat(currentSection):"/";if("/"===pathSection&&0!==index)return"";var breadcrumb=getBreadcrumbMatch(Object.assign({currentSection,location,pathSection,routes},options));return"NO_BREADCRUMB"!==breadcrumb&&matches.push(breadcrumb),"/"===pathSection?"":pathSection}),""),matches}({routes:flattenRoutes(routes||[]),location:(0,react_router__WEBPACK_IMPORTED_MODULE_1__.TH)(),options})}}}]);